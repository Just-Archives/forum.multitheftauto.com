<!DOCTYPE html>
<html lang="en-GB" dir="ltr">
	<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta charset="utf-8">
        
		<title>Handling user credentials (Authentication) - Tutorials - Multi Theft Auto: Forums</title>
		
		
		
		

	<meta name="viewport" content="width=device-width, initial-scale=1">


	
	


	<meta name="twitter:card" content="summary" />


	
		<meta name="twitter:site" content="@mtaqa" />
	


	
		
			
				<meta property="og:title" content="Handling user credentials (Authentication)">
			
		
	

	
		
			
				<meta property="og:type" content="website">
			
		
	

	
		
			
				<meta property="og:url" content="index.html">
			
		
	

	
		
			
				<meta name="description" content="After a worrying discussion on Discord last night regarding password storage and remember me functionality I&#039;ve decided to write a tutorial on how it should be done. This guide assumes you are not using MTA&#039;s built in account system, but a custom one. Any code shown in this tutorial is purely for...">
			
		
	

	
		
			
				<meta property="og:description" content="After a worrying discussion on Discord last night regarding password storage and remember me functionality I&#039;ve decided to write a tutorial on how it should be done. This guide assumes you are not using MTA&#039;s built in account system, but a custom one. Any code shown in this tutorial is purely for...">
			
		
	

	
		
			
				<meta property="og:updated_time" content="2019-11-01T16:11:53Z">
			
		
	

	
		
			
				<meta property="og:site_name" content="Multi Theft Auto: Forums">
			
		
	

	
		
			
				<meta property="og:locale" content="en_GB">
			
		
	


	
		<link rel="canonical" href="index.html" />
	




<link rel="manifest" href="../../manifest.webmanifest/index.html">
<meta name="msapplication-config" content="../../browserconfig.xml/index.html">
<meta name="msapplication-starturl" content="/">
<meta name="application-name" content="Multi Theft Auto: Forums">
<meta name="apple-mobile-web-app-title" content="Multi Theft Auto: Forums">

	<meta name="theme-color" content="#121319">






	

	
		
			<link rel="icon" sizes="36x36" href="../../uploads/monthly_2021_10/android-chrome-36x36.png">
		
	

	
		
			<link rel="icon" sizes="48x48" href="../../uploads/monthly_2021_10/android-chrome-48x48.png">
		
	

	
		
			<link rel="icon" sizes="72x72" href="../../uploads/monthly_2021_10/android-chrome-72x72.png">
		
	

	
		
			<link rel="icon" sizes="96x96" href="../../uploads/monthly_2021_10/android-chrome-96x96.png">
		
	

	
		
			<link rel="icon" sizes="144x144" href="../../uploads/monthly_2021_10/android-chrome-144x144.png">
		
	

	
		
			<link rel="icon" sizes="192x192" href="../../uploads/monthly_2021_10/android-chrome-192x192.png">
		
	

	
		
			<link rel="icon" sizes="256x256" href="../../uploads/monthly_2021_10/android-chrome-256x256.png">
		
	

	
		
			<link rel="icon" sizes="384x384" href="../../uploads/monthly_2021_10/android-chrome-384x384.png">
		
	

	
		
			<link rel="icon" sizes="512x512" href="../../uploads/monthly_2021_10/android-chrome-512x512.png">
		
	

	
		
			<meta name="msapplication-square70x70logo" content="../../uploads/monthly_2021_10/msapplication-square70x70logo.png"/>
		
	

	
		
			<meta name="msapplication-TileImage" content="../../uploads/monthly_2021_10/msapplication-TileImage.png"/>
		
	

	
		
			<meta name="msapplication-square150x150logo" content="../../uploads/monthly_2021_10/msapplication-square150x150logo.png"/>
		
	

	
		
			<meta name="msapplication-wide310x150logo" content="../../uploads/monthly_2021_10/msapplication-wide310x150logo.png"/>
		
	

	
		
			<meta name="msapplication-square310x310logo" content="../../uploads/monthly_2021_10/msapplication-square310x310logo.png"/>
		
	

	
		
			
				<link rel="apple-touch-icon" href="../../uploads/monthly_2021_10/apple-touch-icon-57x57.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="60x60" href="../../uploads/monthly_2021_10/apple-touch-icon-60x60.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="72x72" href="../../uploads/monthly_2021_10/apple-touch-icon-72x72.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="76x76" href="../../uploads/monthly_2021_10/apple-touch-icon-76x76.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="114x114" href="../../uploads/monthly_2021_10/apple-touch-icon-114x114.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="120x120" href="../../uploads/monthly_2021_10/apple-touch-icon-120x120.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="144x144" href="../../uploads/monthly_2021_10/apple-touch-icon-144x144.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="152x152" href="../../uploads/monthly_2021_10/apple-touch-icon-152x152.png">
			
		
	

	
		
			
				<link rel="apple-touch-icon" sizes="180x180" href="../../uploads/monthly_2021_10/apple-touch-icon-180x180.png">
			
		
	





<link rel="preload" href="../../applications/core/interface/font/fontawesome-webfont3e6e.woff2?v=4.7.0" as="font" crossorigin="anonymous">
		


	
		<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,700,700i" rel="stylesheet" referrerpolicy="origin">
	



	<link rel='stylesheet' href='../../uploads/css_built_22/341e4a57816af3ba440d891ca87450ff_frameworka9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/05e81b71abe4f22d6eb8d1a929494829_responsivea9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/20446cf2d164adcc029377cb04d43d17_flagsa9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/90eb5adf50a8c640f633d47fd7eb1778_corea9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/5a0da001ccc2200dc5625c3f3934497d_core_responsivea9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/62e269ced0fdab7e30e026f1d30ae516_forumsa9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/76e62c573090645fb99a15a363d8620e_forums_responsivea9db.css?v=977ee345841657049756' media='all'>

	<link rel='stylesheet' href='../../uploads/css_built_22/ebdea0c6a7dab6d37900b9190d3ac77b_topicsa9db.css?v=977ee345841657049756' media='all'>





<link rel='stylesheet' href='../../uploads/css_built_22/258adbb6e4f3e83cd3b355f84e3fa002_customa9db.css?v=977ee345841657049756' media='all'>




		
		

	
	<link rel='shortcut icon' href='../../uploads/monthly_2016_09/favicon.ico.496d8d1cc696295f808f9f1153f0a1e0.ico' type="image/x-icon">

	</head>
	<body class='ipsApp ipsApp_front ipsJS_none ipsClearfix' data-controller='core.front.core.app' data-message="" data-pageApp='forums' data-pageLocation='front' data-pageModule='forums' data-pageController='topic' data-pageID='112973'  >
		
        

        

		  <a href='#ipsLayout_mainArea' class='ipsHide' title='Go to main content on this page' accesskey='m'>Jump to content</a>
		<div id='ipsLayout_header' class='ipsClearfix'>
			





			<header>
				
<div id="mta_globalTopNavigation">
  <div id="mta_globalTopNavigationLinks" class="ipsLayout_container">
    <a href="https://multitheftauto.com/">Home</a>
    <a href="https://discord.com/invite/mtasa" rel="noopener" target="_blank">Discord</a>
    <a href="https://community.multitheftauto.com/">Community</a>
    <a href="../../index.html">Forum</a>
    <a href="https://wiki.multitheftauto.com/wiki/Main_Page">Wiki</a>
    <a href="https://github.com/multitheftauto/mtasa-blue/issues" rel="noopener" target="_blank">Bugs</a>
    <a href="https://multitheftauto.com/donate/">Heroes</a>
    <a href="https://multitheftauto.com/hosters/">Hosting</a>
    <a href="https://community.multitheftauto.com/index.php?p=servers">Servers</a>
    <a href="https://multitheftauto.myspreadshop.net/all">Merch</a>
    <span id="mta_onlinePlayers"></span>
  </div>
  <script>
    (function () {
      var onlinePlayersEl = document.getElementById('mta_onlinePlayers');

      function updateOnlinePlayers() {
        if (!onlinePlayersEl) return;

        fetch('https://multitheftauto.com/count/')
          .then(function (r) {
            if (!r.ok) throw new Error();
            return r.text();
          })
          .then(function (r) {
            if (!onlinePlayersEl) return;
            if (!r) throw new Error();

            var info = r.split(',', 2);
            if (!info || !info[0] || !info[1]) throw new Error();

            function updateStats() {
              onlinePlayersEl.innerText = new Intl.NumberFormat('en-US').format(info[0]) + ' players online on ' + new Intl.NumberFormat('en-US').format(info[1]) + ' public servers';
              $(onlinePlayersEl).stop(true).fadeIn(500);
            }

            if (!onlinePlayersEl.innerText) {
              $(onlinePlayersEl).hide();
              updateStats();
              return;
            }

            $(onlinePlayersEl).stop(true).fadeOut(500);
            setTimeout(updateStats, 500);
          })
          .catch(function () {
            setTimeout(updateOnlinePlayers, 10000);
          });
      }

      window.addEventListener('load', updateOnlinePlayers);
      setInterval(updateOnlinePlayers, 300000);
    })();
  </script>
</div>

				<div class='ipsLayout_container'>
					


<a href='../../index.html' id='elLogo' accesskey='1'><img src="../../uploads/monthly_2021_09/logo-v2.png.f8c8fa62527075983bc8c7b93a3229aa.png" alt='Multi Theft Auto: Forums'></a>

					
						

	<ul id="elUserNav" class="ipsList_inline cSignedOut ipsResponsive_showDesktop">
		
		<li id="elSignInLink">
			<a href="../../login/index.html" data-ipsmenu-closeonclick="false" data-ipsmenu id="elUserSignIn">
				Existing user? Sign In  <i class="fa fa-caret-down"></i>
			</a>
			
<div id='elUserSignIn_menu' class='ipsMenu ipsMenu_auto ipsHide'>
	<form accept-charset='utf-8' method='post' action='https://forum.multitheftauto.com/login/'>
		<input type="hidden" name="csrfKey" value="714bb4c8fac35f8286ae64e012ef2366">
		<input type="hidden" name="ref" value="aHR0cHM6Ly9mb3J1bS5tdWx0aXRoZWZ0YXV0by5jb20vdG9waWMvMTEyOTczLWhhbmRsaW5nLXVzZXItY3JlZGVudGlhbHMtYXV0aGVudGljYXRpb24v">
		<div data-role="loginForm">
			
			
			
				
<div class="ipsPad ipsForm ipsForm_vertical">
	<h4 class="ipsType_sectionHead">Sign In</h4>
	<br><br>
	<ul class='ipsList_reset'>
		<li class="ipsFieldRow ipsFieldRow_noLabel ipsFieldRow_fullWidth">
			
			
				<input type="text" placeholder="Display Name or Email Address" name="auth" autocomplete="email">
			
		</li>
		<li class="ipsFieldRow ipsFieldRow_noLabel ipsFieldRow_fullWidth">
			<input type="password" placeholder="Password" name="password" autocomplete="current-password">
		</li>
		<li class="ipsFieldRow ipsFieldRow_checkbox ipsClearfix">
			<span class="ipsCustomInput">
				<input type="checkbox" name="remember_me" id="remember_me_checkbox" value="1" checked aria-checked="true">
				<span></span>
			</span>
			<div class="ipsFieldRow_content">
				<label class="ipsFieldRow_label" for="remember_me_checkbox">Remember me</label>
				<span class="ipsFieldRow_desc">Not recommended on shared computers</span>
			</div>
		</li>
		<li class="ipsFieldRow ipsFieldRow_fullWidth">
			<button type="submit" name="_processLogin" value="usernamepassword" class="ipsButton ipsButton_primary ipsButton_small" id="elSignIn_submit">Sign In</button>
			
				<p class="ipsType_right ipsType_small">
					
						<a href='../../lostpassword/index.html' data-ipsDialog data-ipsDialog-title='Forgot your password?'>
					
					Forgot your password?</a>
				</p>
			
		</li>
	</ul>
</div>
			
		</div>
	</form>
</div>
		</li>
		
			<li>
				
					<a href="../../register/index.html" data-ipsdialog data-ipsdialog-size="narrow" data-ipsdialog-title="Sign Up"  id="elRegisterButton" class="ipsButton ipsButton_normal ipsButton_primary">Sign Up</a>
				
			</li>
		
	</ul>

						
<ul class='ipsMobileHamburger ipsList_reset ipsResponsive_hideDesktop'>
	<li data-ipsDrawer data-ipsDrawer-drawerElem='#elMobileDrawer'>
		<a href='#'>
			
			
				
			
			
			
			<i class='fa fa-navicon'></i>
		</a>
	</li>
</ul>
					
				</div>
			</header>
			

	<nav data-controller='core.front.core.navBar' class=' ipsResponsive_showDesktop'>
		<div class='ipsNavBar_primary ipsLayout_container '>
			<ul data-role="primaryNavBar" class='ipsClearfix'>
				


	
		
		
			
		
		<li class='ipsNavBar_active' data-active id='elNavSecondary_1' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="../../index.html"  data-navItem-id="1" data-navDefault>
					Browse<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
				<ul class='ipsNavBar_secondary ' data-role='secondaryNavBar'>
					


	
		
		
			
		
		<li class='ipsNavBar_active' data-active id='elNavSecondary_8' data-role="navBarItem" data-navApp="forums" data-navExt="Forums">
			
			
				<a href="../../index.html"  data-navItem-id="8" data-navDefault>
					Forums<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_12' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="../12275-forum-rules/index.html"  data-navItem-id="12" >
					Forum Rules<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_10' data-role="navBarItem" data-navApp="core" data-navExt="StaffDirectory">
			
			
				<a href="../../staff/index.html"  data-navItem-id="10" >
					Staff<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_11' data-role="navBarItem" data-navApp="core" data-navExt="OnlineUsers">
			
			
				<a href="../../online/index.html"  data-navItem-id="11" >
					Online Users<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_24' data-role="navBarItem" data-navApp="core" data-navExt="Leaderboard">
			
			
				<a href="../../leaderboard/index.html"  data-navItem-id="24" >
					Leaderboard<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

					<li class='ipsHide' id='elNavigationMore_1' data-role='navMore'>
						<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_1' id='elNavigationMore_1_dropdown'>More <i class='fa fa-caret-down'></i></a>
						<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_1_dropdown_menu' data-role='moreDropdown'></ul>
					</li>
				</ul>
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_2' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="../../discover/index.html"  data-navItem-id="2" >
					Activity<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
				<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>
					


	
		
		
		<li  id='elNavSecondary_3' data-role="navBarItem" data-navApp="core" data-navExt="AllActivity">
			
			
				<a href="../../discover/index.html"  data-navItem-id="3" >
					All Activity<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
	

	
	

	
	

	
		
		
		<li  id='elNavSecondary_7' data-role="navBarItem" data-navApp="core" data-navExt="Search">
			
			
				<a href="../../search/index.html"  data-navItem-id="7" >
					Search<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

					<li class='ipsHide' id='elNavigationMore_2' data-role='navMore'>
						<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_2' id='elNavigationMore_2_dropdown'>More <i class='fa fa-caret-down'></i></a>
						<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_2_dropdown_menu' data-role='moreDropdown'></ul>
					</li>
				</ul>
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_37' data-role="navBarItem" data-navApp="core" data-navExt="Menu">
			
			
				<a href="#" id="elNavigation_37" data-ipsMenu data-ipsMenu-appendTo='#elNavSecondary_37' data-ipsMenu-activeClass='ipsNavActive_menu' data-navItem-id="37" >
					MTA Network <i class="fa fa-caret-down"></i><span class='ipsNavBar_active__identifier'></span>
				</a>
				<ul id="elNavigation_37_menu" class="ipsMenu ipsMenu_auto ipsHide">
					

	
		
			<li class='ipsMenu_item' >
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://community.mtasa.com/' target='_blank' rel="noopener">
					Community
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://wiki.multitheftauto.com/wiki/Main_Page' target='_blank' rel="noopener">
					Wiki
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://github.com/multitheftauto/mtasa-blue/issues' target='_blank' rel="noopener">
					Bugs
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://multitheftauto.com/donate/' target='_blank' rel="noopener">
					Heroes
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://multitheftauto.com/hosters/' target='_blank' rel="noopener">
					Hosting
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://multitheftauto.myspreadshop.net/all' target='_blank' rel="noopener">
					Merch Store
				</a>
			</li>
		
	

				</ul>
			
			
				<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>
					


	
		
		
		<li  id='elNavSecondary_46' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://discord.com/invite/mtasa" target='_blank' rel="noopener" data-navItem-id="46" >
					Discord<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_48' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://community.mtasa.com/" target='_blank' rel="noopener" data-navItem-id="48" >
					Community<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_49' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://wiki.multitheftauto.com/wiki/Main_Page" target='_blank' rel="noopener" data-navItem-id="49" >
					Wiki<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_50' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://github.com/multitheftauto/mtasa-blue/issues" target='_blank' rel="noopener" data-navItem-id="50" >
					Bugs<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_51' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://multitheftauto.com/donate/" target='_blank' rel="noopener" data-navItem-id="51" >
					Heroes<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_52' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://multitheftauto.com/hosters/" target='_blank' rel="noopener" data-navItem-id="52" >
					Hosting<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_45' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://multitheftauto.myspreadshop.net/all" target='_blank' rel="noopener" data-navItem-id="45" >
					Merch Store<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

					<li class='ipsHide' id='elNavigationMore_37' data-role='navMore'>
						<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_37' id='elNavigationMore_37_dropdown'>More <i class='fa fa-caret-down'></i></a>
						<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_37_dropdown_menu' data-role='moreDropdown'></ul>
					</li>
				</ul>
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_28' data-role="navBarItem" data-navApp="core" data-navExt="Menu">
			
			
				<a href="#" id="elNavigation_28" data-ipsMenu data-ipsMenu-appendTo='#elNavSecondary_28' data-ipsMenu-activeClass='ipsNavActive_menu' data-navItem-id="28" >
					Social Media <i class="fa fa-caret-down"></i><span class='ipsNavBar_active__identifier'></span>
				</a>
				<ul id="elNavigation_28_menu" class="ipsMenu ipsMenu_auto ipsHide">
					

	
		
			<li class='ipsMenu_item' >
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://www.twitch.tv/mtaqa' target='_blank' rel="noopener">
					Twitch
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://twitter.com/mtaqa' target='_blank' rel="noopener">
					Twitter
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://www.youtube.com/user/MTAQA' target='_blank' rel="noopener">
					YouTube
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://github.com/multitheftauto' target='_blank' rel="noopener">
					GitHub
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://www.facebook.com/multitheftauto' target='_blank' rel="noopener">
					Facebook
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://www.reddit.com/r/MultiTheftAuto/' target='_blank' rel="noopener">
					Reddit
				</a>
			</li>
		
	

	
		
			<li class='ipsMenu_item' >
				<a href='https://www.linkedin.com/company/multitheftauto' target='_blank' rel="noopener">
					LinkedIn
				</a>
			</li>
		
	

				</ul>
			
			
				<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>
					


	
		
		
		<li  id='elNavSecondary_36' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://discord.com/invite/mtasa" target='_blank' rel="noopener" data-navItem-id="36" >
					Discord<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_35' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://www.twitch.tv/mtaqa" target='_blank' rel="noopener" data-navItem-id="35" >
					Twitch<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_30' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://twitter.com/mtaqa" target='_blank' rel="noopener" data-navItem-id="30" >
					Twitter<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_32' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://www.youtube.com/user/MTAQA" target='_blank' rel="noopener" data-navItem-id="32" >
					YouTube<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_31' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://github.com/multitheftauto" target='_blank' rel="noopener" data-navItem-id="31" >
					GitHub<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_29' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://www.facebook.com/multitheftauto" target='_blank' rel="noopener" data-navItem-id="29" >
					Facebook<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_34' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://www.reddit.com/r/MultiTheftAuto/" target='_blank' rel="noopener" data-navItem-id="34" >
					Reddit<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

	
		
		
		<li  id='elNavSecondary_33' data-role="navBarItem" data-navApp="core" data-navExt="CustomItem">
			
			
				<a href="https://www.linkedin.com/company/multitheftauto" target='_blank' rel="noopener" data-navItem-id="33" >
					LinkedIn<span class='ipsNavBar_active__identifier'></span>
				</a>
			
			
		</li>
	
	

					<li class='ipsHide' id='elNavigationMore_28' data-role='navMore'>
						<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_28' id='elNavigationMore_28_dropdown'>More <i class='fa fa-caret-down'></i></a>
						<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_28_dropdown_menu' data-role='moreDropdown'></ul>
					</li>
				</ul>
			
		</li>
	
	

				<li class='ipsHide' id='elNavigationMore' data-role='navMore'>
					<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore' id='elNavigationMore_dropdown'>More</a>
					<ul class='ipsNavBar_secondary ipsHide' data-role='secondaryNavBar'>
						<li class='ipsHide' id='elNavigationMore_more' data-role='navMore'>
							<a href='#' data-ipsMenu data-ipsMenu-appendTo='#elNavigationMore_more' id='elNavigationMore_more_dropdown'>More <i class='fa fa-caret-down'></i></a>
							<ul class='ipsHide ipsMenu ipsMenu_auto' id='elNavigationMore_more_dropdown_menu' data-role='moreDropdown'></ul>
						</li>
					</ul>
				</li>
			</ul>
			

	<div id="elSearchWrapper">
		<div id='elSearch' class='' data-controller='core.front.core.quickSearch'>
			<form accept-charset='utf-8' action='http://forum.multitheftauto.com/search/?do=quicksearch' method='post'>
				<input type='search' id='elSearchField' placeholder='Search...' name='q' autocomplete='off' aria-label='Search'>
				<button class='cSearchSubmit' type="submit" aria-label='Search'><i class="fa fa-search"></i></button>
				<div id="elSearchExpanded">
					<div class="ipsMenu_title">
						Search In
					</div>
					<ul class="ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small" data-ipsSideMenu data-ipsSideMenu-type="radio" data-ipsSideMenu-responsive="false" data-role="searchContexts">
						<li>
							<span class='ipsSideMenu_item ipsSideMenu_itemActive' data-ipsMenuValue='all'>
								<input type="radio" name="type" value="all" checked id="elQuickSearchRadio_type_all">
								<label for='elQuickSearchRadio_type_all' id='elQuickSearchRadio_type_all_label'>Everywhere</label>
							</span>
						</li>
						
						
							<li>
								<span class='ipsSideMenu_item' data-ipsMenuValue='forums_topic'>
									<input type="radio" name="type" value="forums_topic" id="elQuickSearchRadio_type_forums_topic">
									<label for='elQuickSearchRadio_type_forums_topic' id='elQuickSearchRadio_type_forums_topic_label'>Topics</label>
								</span>
							</li>
						
						
							
								<li>
									<span class='ipsSideMenu_item' data-ipsMenuValue='contextual_{&quot;type&quot;:&quot;forums_topic&quot;,&quot;nodes&quot;:123}'>
										<input type="radio" name="type" value='contextual_{&quot;type&quot;:&quot;forums_topic&quot;,&quot;nodes&quot;:123}' id='elQuickSearchRadio_type_contextual_838a63ae987ccff12e9d57d90ead7643'>
										<label for='elQuickSearchRadio_type_contextual_838a63ae987ccff12e9d57d90ead7643' id='elQuickSearchRadio_type_contextual_838a63ae987ccff12e9d57d90ead7643_label'>This Forum</label>
									</span>
								</li>
							
								<li>
									<span class='ipsSideMenu_item' data-ipsMenuValue='contextual_{&quot;type&quot;:&quot;forums_topic&quot;,&quot;item&quot;:112973}'>
										<input type="radio" name="type" value='contextual_{&quot;type&quot;:&quot;forums_topic&quot;,&quot;item&quot;:112973}' id='elQuickSearchRadio_type_contextual_c94e370035449d13ab7e7c22e99f7f3b'>
										<label for='elQuickSearchRadio_type_contextual_c94e370035449d13ab7e7c22e99f7f3b' id='elQuickSearchRadio_type_contextual_c94e370035449d13ab7e7c22e99f7f3b_label'>This Topic</label>
									</span>
								</li>
							
						
						<li data-role="showMoreSearchContexts">
							<span class='ipsSideMenu_item' data-action="showMoreSearchContexts" data-exclude="forums_topic">
								More options...
							</span>
						</li>
					</ul>
					<div class="ipsMenu_title">
						Find results that contain...
					</div>
					<ul class='ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small ipsType_normal' role="radiogroup" data-ipsSideMenu data-ipsSideMenu-type="radio" data-ipsSideMenu-responsive="false" data-filterType='andOr'>
						
							<li>
								<span class='ipsSideMenu_item ipsSideMenu_itemActive' data-ipsMenuValue='or'>
									<input type="radio" name="search_and_or" value="or" checked id="elRadio_andOr_or">
									<label for='elRadio_andOr_or' id='elField_andOr_label_or'><em>Any</em> of my search term words</label>
								</span>
							</li>
						
							<li>
								<span class='ipsSideMenu_item ' data-ipsMenuValue='and'>
									<input type="radio" name="search_and_or" value="and"  id="elRadio_andOr_and">
									<label for='elRadio_andOr_and' id='elField_andOr_label_and'><em>All</em> of my search term words</label>
								</span>
							</li>
						
					</ul>
					<div class="ipsMenu_title">
						Find results in...
					</div>
					<ul class='ipsSideMenu_list ipsSideMenu_withRadios ipsSideMenu_small ipsType_normal' role="radiogroup" data-ipsSideMenu data-ipsSideMenu-type="radio" data-ipsSideMenu-responsive="false" data-filterType='searchIn'>
						<li>
							<span class='ipsSideMenu_item ipsSideMenu_itemActive' data-ipsMenuValue='all'>
								<input type="radio" name="search_in" value="all" checked id="elRadio_searchIn_and">
								<label for='elRadio_searchIn_and' id='elField_searchIn_label_all'>Content titles and body</label>
							</span>
						</li>
						<li>
							<span class='ipsSideMenu_item' data-ipsMenuValue='titles'>
								<input type="radio" name="search_in" value="titles" id="elRadio_searchIn_titles">
								<label for='elRadio_searchIn_titles' id='elField_searchIn_label_titles'>Content titles only</label>
							</span>
						</li>
					</ul>
				</div>
			</form>
		</div>
	</div>

		</div>
	</nav>

			
<ul id='elMobileNav' class='ipsResponsive_hideDesktop' data-controller='core.front.core.mobileNav'>
	
		
			
			
				
				
			
				
				
			
				
					<li id='elMobileBreadcrumb'>
						<a href='../../forum/123-tutorials/index.html'>
							<span>Tutorials</span>
						</a>
					</li>
				
				
			
				
				
			
		
	
	
	
	<li >
		<a data-action="defaultStream" href='../../discover/index.html'><i class="fa fa-newspaper-o" aria-hidden="true"></i></a>
	</li>

	

	
		<li class='ipsJS_show'>
			<a href='../../search/index.html'><i class='fa fa-search'></i></a>
		</li>
	
</ul>
		</div>
		<main id='ipsLayout_body' class='ipsLayout_container'>
			<div id='ipsLayout_contentArea'>
				<div id='ipsLayout_contentWrapper'>
					
<nav class='ipsBreadcrumb ipsBreadcrumb_top ipsFaded_withHover'>
	

	<ul class='ipsList_inline ipsPos_right'>
		
		<li >
			<a data-action="defaultStream" class='ipsType_light '  href='../../discover/index.html'><i class="fa fa-newspaper-o" aria-hidden="true"></i> <span>All Activity</span></a>
		</li>
		
	</ul>

	<ul data-role="breadcrumbList">
		<li>
			<a title="Home" href='../../index.html'>
				<span>Home <i class='fa fa-angle-right'></i></span>
			</a>
		</li>
		
		
			<li>
				
					<a href='../../forum/86-mta-community/index.html'>
						<span>MTA Community <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					<a href='../../forum/71-scripting/index.html'>
						<span>Scripting <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					<a href='../../forum/123-tutorials/index.html'>
						<span>Tutorials <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					Handling user credentials (Authentication)
				
			</li>
		
	</ul>
</nav>
					
					<div id='ipsLayout_mainArea'>
						
						
						
						

	




						



<div class='ipsPageHeader ipsResponsive_pull ipsBox ipsPadding sm:ipsPadding:half ipsMargin_bottom'>
		
	
	<div class='ipsFlex ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:4'>
		<div class='ipsFlex-flex:11'>
			<h1 class='ipsType_pageTitle ipsContained_container'>
				
					
					
						<span><span class="ipsBadge ipsBadge_icon ipsBadge_positive" data-ipsTooltip title='Pinned'><i class='fa fa-thumb-tack'></i></span></span>
					
					
						<span><span class="ipsBadge ipsBadge_icon ipsBadge_positive" data-ipsTooltip title='Featured'><i class='fa fa-star'></i></span></span>
					
				

				
				
					<span class='ipsType_break ipsContained'>
						<span>Handling user credentials (Authentication)</span>
					</span>
				
			</h1>
			
			
		</div>
		
			<div class='ipsFlex-flex:00 ipsType_light'>
				
				
<div  class='ipsClearfix ipsRating  ipsRating_veryLarge'>
	
	<ul class='ipsRating_collective'>
		
			
				<li class='ipsRating_on'>
					<i class='fa fa-star'></i>
				</li>
			
		
			
				<li class='ipsRating_on'>
					<i class='fa fa-star'></i>
				</li>
			
		
			
				<li class='ipsRating_on'>
					<i class='fa fa-star'></i>
				</li>
			
		
			
				<li class='ipsRating_on'>
					<i class='fa fa-star'></i>
				</li>
			
		
			
				<li class='ipsRating_off'>
					<i class='fa fa-star'></i>
				</li>
			
		
	</ul>
</div>
			</div>
		
	</div>
	<hr class='ipsHr'>
	<div class='ipsPageHeader__meta ipsFlex ipsFlex-jc:between ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:3'>
		<div class='ipsFlex-flex:11'>
			<div class='ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone ipsClearfix'>
				


	<a href="../../profile/51280-nanobob/index.html" rel="nofollow" data-ipsHover data-ipsHover-width="370" data-ipsHover-target="https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard" class="ipsUserPhoto ipsUserPhoto_mini" title="Go to NanoBob's profile">
		<img src='../../uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png' alt='NanoBob' loading="lazy">
	</a>

				<div>
					<p class='ipsType_reset ipsType_blendLinks'>
						<span class='ipsType_normal'>
						
							<strong>By 


<a href='../../profile/51280-nanobob/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to NanoBob's profile" class="ipsType_break"><span style='color:#968a5b'>NanoBob</span></a>, </strong><br />
							<span class='ipsType_light'><time datetime='2018-11-28T09:04:24Z' title='28/11/18 09:04 ' data-short='3 yr'>November 28, 2018</time> in <a href="../../forum/123-tutorials/index.html">Tutorials</a></span>
						
						</span>
					</p>
				</div>
			</div>
		</div>
		
			<div class='ipsFlex-flex:01 ipsResponsive_hidePhone'>
				<div class='ipsFlex ipsFlex-ai:center ipsFlex-jc:center ipsGap:3 ipsGap_row:0'>
					
						


					
					



					

<div data-followApp='forums' data-followArea='topic' data-followID='112973' data-controller='core.front.core.followButton'>
	

	<a href='../../login/index.html' rel="nofollow" class="ipsFollow ipsPos_middle ipsButton ipsButton_light ipsButton_verySmall ipsButton_disabled" data-role="followButton" data-ipsTooltip title='Sign in to follow this'>
		<span>Followers</span>
		<span class='ipsCommentCount'>0</span>
	</a>

</div>
				</div>
			</div>
					
	</div>
	
	
</div>






<div class='ipsClearfix'>
	<ul class="ipsToolList ipsToolList_horizontal ipsClearfix ipsSpacer_both ipsResponsive_hidePhone">
		
		
		
	</ul>
</div>

<div id='comments' data-controller='core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments' data-autoPoll data-baseURL='https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/' data-lastPage data-feedID='topic-112973' class='cTopic ipsClear ipsSpacer_top'>
	
			
	

	

<div data-controller='core.front.core.recommendedComments' data-url='https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/?recommended=comments' class='ipsRecommendedComments ipsHide'>
	<div data-role="recommendedComments">
		<h2 class='ipsType_sectionHead ipsType_large ipsType_bold ipsMargin_bottom'>Recommended Posts</h2>
		
	</div>
</div>
	
	<div id="elPostFeed" data-role='commentFeed' data-controller='core.front.core.moderation' >
		<form action="https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/?csrfKey=714bb4c8fac35f8286ae64e012ef2366&amp;do=multimodComment" method="post" data-ipsPageAction data-role='moderationTools'>
			
			
				

					

					
					



<a id='comment-937075'></a>
<article  id='elComment_937075' class='cPost ipsBox ipsResponsive_pull  ipsComment ipsComment_popular ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone    '>
	

	
		<div class='ipsResponsive_showPhone ipsComment_badges'>
			<ul class='ipsList_reset ipsFlex ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1'>
				
				
				
				
					<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>Popular Post</strong></li>
				
			</ul>
		</div>
	

	<div class='cAuthorPane_mobile ipsResponsive_showPhone'>
		<div class='cAuthorPane_photo'>
			<div class='cAuthorPane_photoWrap'>
				


	<a href="../../profile/51280-nanobob/index.html" rel="nofollow" data-ipsHover data-ipsHover-width="370" data-ipsHover-target="https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard" class="ipsUserPhoto ipsUserPhoto_large" title="Go to NanoBob's profile">
		<img src='../../uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png' alt='NanoBob' loading="lazy">
	</a>

				
				
					<a href="../../profile/51280-nanobob/badges/index.html" rel="nofollow">
						
<img src='../../uploads/set_resources_22/84c1e40ea0e759e3f1505eb1788ddf3c_default_rank.png' loading="lazy" alt="Rat" class="cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px" data-ipsTooltip title="Rank: Rat (9/54)">
					</a>
				
			</div>
		</div>
		<div class='cAuthorPane_content'>
			<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_break ipsType_blendLinks ipsFlex ipsFlex-ai:center'>
				


<a href='../../profile/51280-nanobob/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to NanoBob's profile" class="ipsType_break"><span style='color:#968a5b'>NanoBob</span></a>
			</h3>
			<div class='ipsType_light ipsType_reset'>
				<a href='indexa0bf.html?do=findComment&amp;comment=937075' rel="nofollow" class='ipsType_blendLinks'>Posted <time datetime='2018-11-28T09:04:24Z' title='28/11/18 09:04 ' data-short='3 yr'>November 28, 2018</time></a>
				
			</div>
		</div>
	</div>
	<aside class='ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone'>
		<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break'><strong>


<a href='../../profile/51280-nanobob/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to NanoBob's profile" class="ipsType_break">NanoBob</a></strong>
			
		</h3>
		<ul class='cAuthorPane_info ipsList_reset'>
            
                
                    
                        <li data-role='member-title' class='cAuthorPane_title'>
Distinguished Member</li>
                    
                
            
			<li data-role='photo' class='cAuthorPane_photo'>
				<div class='cAuthorPane_photoWrap'>
					


	<a href="../../profile/51280-nanobob/index.html" rel="nofollow" data-ipsHover data-ipsHover-width="370" data-ipsHover-target="https://forum.multitheftauto.com/profile/51280-nanobob/?do=hovercard" class="ipsUserPhoto ipsUserPhoto_large" title="Go to NanoBob's profile">
		<img src='../../uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png' alt='NanoBob' loading="lazy">
	</a>

					
					
						
<img src='../../uploads/set_resources_22/84c1e40ea0e759e3f1505eb1788ddf3c_default_rank.png' loading="lazy" alt="Rat" class="cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px" data-ipsTooltip title="Rank: Rat (9/54)">
					
				</div>
			</li>
			
				<li data-role='group'><span style='color:#968a5b'>Distinguished Members</span></li>
				
			
			
				<li data-role='reputation-badge'>
					

	
		<span title="Member's total reputation" data-ipsTooltip class='ipsRepBadge ipsRepBadge_positive'>
	
			<i class='fa fa-plus-circle'></i> 100
	
		</span>
	

				</li>
				<li data-role='stats'>
					<ul class="ipsList_reset ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:center ipsGap_row:2 cAuthorPane_stats">
						<li>
							<a href="../../profile/51280-nanobob/content/index.html" rel="nofollow" title="49 posts" data-ipsTooltip class="ipsType_blendLinks">
								<i class="fa fa-comment"></i> 49
							</a>
						</li>
						
					</ul>
				</li>
				

	
		
	

			
		</ul>
	</aside>
	<div class='ipsColumn ipsColumn_fluid ipsMargin:none'>
		

<div id="comment-937075_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="937075" data-quotedata="{&quot;userid&quot;:51280,&quot;username&quot;:&quot;NanoBob&quot;,&quot;timestamp&quot;:1543395864,&quot;contentapp&quot;:&quot;forums&quot;,&quot;contenttype&quot;:&quot;forums&quot;,&quot;contentid&quot;:112973,&quot;contentclass&quot;:&quot;forums_Topic&quot;,&quot;contentcommentid&quot;:937075}" class="ipsComment_content ipsType_medium">

	<div class="ipsComment_meta ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:between ipsFlex-fd:row-reverse">
		<div class="ipsType_light ipsType_reset ipsType_blendLinks ipsComment_toolWrap">
			<div class="ipsResponsive_hidePhone ipsComment_badges">
				<ul class="ipsList_reset ipsFlex ipsFlex-jc:end ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1">
					
					
					
					
					
						<li><strong class="ipsBadge ipsBadge_large ipsBadge_popular">Popular Post</strong></li>
					
				</ul>
			</div>
			<ul class="ipsList_reset ipsComment_tools">
				<li>
					<a href="#elControls_937075_menu" class="ipsComment_ellipsis" id="elControls_937075" title="More options..." data-ipsmenu data-ipsmenu-appendto="#comment-937075_wrap"><i class="fa fa-ellipsis-h"></i></a>
					<ul id="elControls_937075_menu" class="ipsMenu ipsMenu_narrow ipsHide">
						
						
							<li class="ipsMenu_item"><a href="index.html" title="Share this post" data-ipsdialog data-ipsdialog-size="narrow" data-ipsdialog-content="#elShareComment_937075_menu" data-ipsdialog-title="Share this post" id="elSharePost_937075" data-role="shareComment">Share</a></li>
						
                        
						
						
						
							
								
							
							
							
							
							
							
						
					</ul>
				</li>
				
			</ul>
		</div>

		<div class="ipsType_reset ipsResponsive_hidePhone">
			<a href="indexa0bf.html?do=findComment&amp;comment=937075" rel="nofollow" class="ipsType_blendLinks">Posted <time datetime='2018-11-28T09:04:24Z' title='28/11/18 09:04 ' data-short='3 yr'>November 28, 2018</time></a>
			
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	

    

	<div class="cPost_contentWrap">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsPadding_bottom ipsContained" data-controller="core.front.core.lightboxedImages">
			<p>
	After a worrying discussion on Discord last night regarding password storage and remember me functionality I've decided to write a tutorial on how it should be done. This guide assumes you are not using MTA's built in account system, but a custom one.  <strong>Any code shown in this tutorial is purely for illustrative purposes, and is not finished code, you should use it as a guideline, not a solution.</strong>
</p>

<p>
	The following topics will be discussed in this tutorial:
</p>

<ul>
	<li>
		How to hash and salt passwords (register)
	</li>
	<li>
		How to validate a hashed password (login)
	</li>
	<li>
		How to add "remember-me" functionality
	</li>
	<li>
		How to offer password recovery
	</li>
	<li>
		How to migrate from an older hashing algorithm, to a newer one
	</li>
	<li>
		Using a password policy
	</li>
	<li>
		(Extra) How to handle database leaks
	</li>
	<li>
		(Extra) What even is hashing and salting?
	</li>
</ul>

<p>
	For the purpose of this tutorial we expect a database structure which is somewhat similar to this:
</p>

<p>
	<img alt="70CN2qS.png" class="ipsImage" height="204" width="471" src="../../applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/70CN2qS.png">
</p>

<p>
	<b>How to hash and salt passwords</b><br>
	When you have a user register on your service, that user expects of you to keep their password safe. Whilst it is generally bad practice to use the same password for multiple services there are many users that still do so. Because of this it's crucial that you save the user's passwords in a way that an attacker will be unable to find out the original password the user typed. This includes if they have full access to your database. In order to do this we do what is called "Password hashing"
</p>

<p>
	When a user registers, your server receives the user's intended username, (email) and password. Before you save that password to the database you have to hash and salt this, luckily MTA has a function that takes care of this. If you wish to know more about what exactly it does, there's more information at the end of this tutorial. 
</p>

<p>
	In order to hash this password you use the passwordHash function. This function is relatively slow (by design), so it is highly recommended you pass a callback to this function, so your entire script doesn't wait for it to complete.
</p>

<p>
	<a href="https://wiki.multitheftauto.com/wiki/PasswordHash" rel="external nofollow">https://wiki.multitheftauto.com/wiki/PasswordHash</a>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> mysqlHandle </span><span class="com">-- we're assuming this value is set somewhere else in code</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> register</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> email</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span> </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/client" rel="external nofollow">client</a></span>

    <span><a href="https://wiki.multitheftauto.com/wiki/passwordHash" rel="external nofollow">passwordHash</a></span></span><span class="pun">(</span><span class="pln">password</span><span class="pun">,</span><span class="pln"> </span><span class="str">"bcrypt"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">hashedPassword</span><span class="pun">)</span><span class="pln">
        </span><span class="com">-- callback function for hashing the password</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> handle </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln"> 
            </span><span class="com">-- callback function for storing the user in the database</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"registrationSuccess"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- inform the user that registration was successful</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln">
                <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"registrationFailed"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pun">,</span><span class="pln">mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"INSERT INTO users (email, username, password) VALUES (?, ?, ?)"</span><span class="pun">,</span><span class="pln"> email</span><span class="pun">,</span><span class="pln"> username</span><span class="pun">,</span><span class="pln"> hashedPassword</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">end</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">end</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEvent" rel="external nofollow">addEvent</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:register"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:register"</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getRootElement" rel="external nofollow">getRootElement</a></span></span><span class="pun">(),</span><span class="pln"> register</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>How to validate a hashed password</strong><br>
	Once you've saved the hashed pasword to your database you need to do a little bit of additional work when authenticating the user. Luckily MTA offers a passwordVerify() function, which is the counterpart of the previously discussed passwordHash(). What this function does it basically hashes the password in the same way, resulting in the same output hash.
</p>

<p>
	<a href="https://wiki.multitheftauto.com/wiki/passwordVerify" rel="external nofollow">https://wiki.multitheftauto.com/wiki/passwordVerify</a>
</p>

<p>
	In order to get the account the user is trying to log in to you have to do a query for an account which has the user submitted username, and of which the password matches through passwordVerify. PasswordVerify is also a relatively slow function, thus you should use a callback.
</p>

<p>
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> login</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span> </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/client" rel="external nofollow">client</a></span>

    <span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln">
        </span><span class="com">-- callback for the query selecting the user by username</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> results </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln">handle</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(#</span><span class="pln">results </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginFailed"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">

        <span><a href="https://wiki.multitheftauto.com/wiki/passwordVerify" rel="external nofollow">passwordVerify</a></span></span><span class="pun">(</span><span class="pln">password</span><span class="pun">,</span><span class="pln"> results</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">password</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">matches</span><span class="pun">)</span><span class="pln">
            </span><span class="com">-- callback function for the password verify</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">matches</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                </span><span class="com">-- Do anything you wish with the database result to log the player in with the rest of your scripts</span><span class="pln">
                <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginSuccess"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln">
                <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginFailed"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM users WHERE username = ?"</span><span class="pun">,</span><span class="pln"> username</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEvent" rel="external nofollow">addEvent</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:login"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:login"</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getRootElement" rel="external nofollow">getRootElement</a></span></span><span class="pun">(),</span><span class="pln"> login</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<b>How to add "remember me" functionality</b><br>
	When users on your server log in, they often do not want to have to enter their username and password every time they want to log in. In order to satisfy this need you can implement a "remember me" function. What I've seen happen in the past, is people would store the user's password (encrypted) on the client. This is <strong>NOT</strong> safe, and should never be done!
</p>

<p>
	In order to properly use remember me functionality what you would do is upon login in, generate a random string. The longer the better. This random string is what we call an access token. You would then allow the user to log in with such an access token, preferably only once generating a new access token each time one is used.
</p>

<p>
	To implement this you would generate that token every time the user logs in, whilst they have "remember me" enabled. You will have to save this token in your database alongside your user.  For extra security you could also store the user's serial alongside the access token, you can then validate that the access token is being used from the same device.
</p>

<p>
	<a href="https://wiki.multitheftauto.com/wiki/Filepath" rel="external nofollow">https://wiki.multitheftauto.com/wiki/Filepath</a>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> login</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">)</span><span class="pln">
    </span><span class="com">-- This code should be put in the callback to the dbQuery function, but to keep the example clean that's not shown here</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rememberMe</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> token </span><span class="pun">=</span><span class="pln"> generateRandomToken</span><span class="pun">()</span><span class="pln">
        <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> 
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginSuccess"</span><span class="pun">,</span><span class="pln"> token</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">end</span><span class="pun">,</span><span class="pln">mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"INSERT INTO access_tokens (user_id, token) VALUES (?, ?)"</span><span class="pun">,</span><span class="pln"> results</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">id</span><span class="pun">,</span><span class="pln"> token</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> rememberMeLogin</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> accessToken</span><span class="pun">)</span><span class="pln">
    </span><span class="com">-- this function handles a user's login attempt </span><span class="pln">
    <span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln">handle</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(#</span><span class="pln">result </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginFailed"</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            </span><span class="com">-- Do anything you wish with the database result to log the player in with the rest of your scripts</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"loginSuccess"</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pun">,</span><span class="pln">mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT users.* FROM access_tokens JOIN users ON users.id = access_tokens.user_id WHERE users.username = ?"</span><span class="pun">,</span><span class="pln"> username</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEvent" rel="external nofollow">addEvent</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:loginRememberMe"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"passwordTutorial:loginRememberMe"</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getRootElement" rel="external nofollow">getRootElement</a></span></span><span class="pun">(),</span><span class="pln"> login</span><span class="pun">)</span></pre>

<p>
	<b>How to offer password recovery</b><br>
	Offering password recovery requires a little bit more than just your MTA server. Generally password recovery is done with emails. So you would need access to an email server / service which you can use to send an email from an HTTP request. (Like you can do with fetchRemote()). 
</p>

<p>
	When a user requests a password reset, have them enter the email you registered with. You then fetch a user from the database with this email address. You would then store a password recovery token for this user. This token, just like the remember me token, is a random string. 
</p>

<p>
	Ideally, you would send the user a link with a password reset form that goes to a webpage where the user can reset their password. You could do this with an external service, like a webserver. Or you could use MTA's Resource web access for it, but if you do make sure you handle permissions properly for anything else that uses this. However another option would be to have the user copy paste the generated token from the email into you server's login window. 
</p>

<p>
	Which of the two solutions you pick is up to you, my personal preference goes to the one with the link in the email. But in either case the server side logic is the same.
</p>

<p>
	When the user attempts to perform password recovery, verify that the token they give you belongs to a user, and then change the password to the newly requested password. Make sure you hash this password the same way you do in your login.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> requestPasswordRecovery</span><span class="pun">(</span><span class="pln">email</span><span class="pun">)</span><span class="pln">
    <span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handle</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln">handle</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(#</span><span class="pln">result </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"passwordTutorial:passwordRecoveryRequestFailed"</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> token </span><span class="pun">=</span><span class="pln"> generateRandomToken</span><span class="pun">()</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="pln">mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"UPDATE user_data SET recovery_token = ?"</span><span class="pun">,</span><span class="pln"> token</span><span class="pun">)</span><span class="pln">
            </span><span class="com">-- mail the token to the user, mail implementation depends on the mail server/service you use</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"passwordTutorial:passwordRecoveryRequestSuccess"</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM users WHERE email = ?"</span><span class="pun">,</span><span class="pln"> email</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> recoverPassword</span><span class="pun">(</span><span class="pln">recoveryToken</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">)</span><span class="pln">
    <span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln">handle</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(#</span><span class="pln">result </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            </span><span class="com">-- this is only valid if you have the user request password recovery from ingame</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"passwordTutorial:passwordRecoveryFailed"</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">

            <span><a href="https://wiki.multitheftauto.com/wiki/passwordHash" rel="external nofollow">passwordHash</a></span></span><span class="pun">(</span><span class="pln">password</span><span class="pun">,</span><span class="pln"> </span><span class="str">"bcrypt"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">hashedPassword</span><span class="pun">)</span><span class="pln">
                </span><span class="com">-- callback function for hashing the password</span><span class="pln">
                </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> handle </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln"> 
                    </span><span class="com">-- callback function for storing the new password in the database</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">handle</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                        </span><span class="com">-- this is only valid if you have the user request password recovery from ingame</span><span class="pln">
                        <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"passwordTutorial:passwordRecoverySuccess"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- inform the user that registration was successful</span><span class="pln">
                    </span><span class="kwd">else</span><span class="pln">
                        </span><span class="com">-- this is only valid if you have the user request password recovery from ingame</span><span class="pln">
                        <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"passwordTutorial:passwordRecoveryFailed"</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">end</span><span class="pln">
                </span><span class="kwd">end</span><span class="pun">,</span><span class="pln">mysqlHandle</span><span class="pun">,</span><span class="pln"> </span><span class="str">"UPDATE user_data SET password = ? WHERE recovery_token = ?"</span><span class="pun">,</span><span class="pln"> username</span><span class="pun">,</span><span class="pln"> recoveryToken</span><span class="pun">)</span><span class="pln">
        
            </span><span class="kwd">end</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM users WHERE recovery_token = ?"</span><span class="pun">,</span><span class="pln"> recoveryToken</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	Besides changing the password, it's important you also delete any access tokens that user might have if you're using remember me functionality.<br>
	It is also good practice to make recovery tokens expiry after a certain amount of times, and not allow a recovery token to be created whilst one is already in prgoress. This prevents a user from sending a large number of emails from your service.
</p>

<p>
	<br>
	<strong>How to migrate from an older hashing algorithm, to a newer one</strong><br>
	Maybe after reading this topic you realise that your password security is not what it should be. So you want to change your old password hashing / validation logic to the ones explained in this topic. And due to the nature that hashes can not be "unhashed", you can't simply migrate your passwords over. So in order to migrate the passwords what you have to do is when a user logs in, first validate their password with the old hashing algorithm. If this matches, then hash (and salt) it with your new hashing algorithm and save it in your database. Make sure to delete the old password otherwise your password security is not any better than before.
</p>

<p>
	<b>Using a password policy</b><br>
	Passwords policies are important to prevent your users from picking a password that is too easily cracked / brute forced. Many password policies come in the form of "Must have at least one capital letter, one digit and one number". But that discards that fact that the best way to make your password more difficult to crack, is making your password longer. So in the code snippet below is a function that measures the 'search space' of a password. The search space of a password is the amount of possible passwords there are with a certain combination of characters.
</p>

<p>
	In order to use this, you would have to set a minimum password search space when a user registers for an account. This minimum is up for you to set, but be reasonable, you shouldn't expect a user's password to be impossible to remember / create. I recomend playing with the function a bit to see what values you get out of it, and pick something you believe is sensible.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> getPasswordSearchSpace</span><span class="pun">(</span><span class="pln">password</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> lowerCase </span><span class="pun">=</span><span class="pln"> password</span><span class="pun">:</span><span class="pln">find</span><span class="pun">(</span><span class="str">"%l"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">26</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> upperCase </span><span class="pun">=</span><span class="pln"> password</span><span class="pun">:</span><span class="pln">find</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">26</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> digits </span><span class="pun">=</span><span class="pln"> password</span><span class="pun">:</span><span class="pln">find</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> symbols </span><span class="pun">=</span><span class="pln"> password</span><span class="pun">:</span><span class="pln">find</span><span class="pun">(</span><span class="str">"%W"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> length </span><span class="pun">=</span><span class="pln"> password</span><span class="pun">:</span><span class="pln">len</span><span class="pun">()</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lowerCase </span><span class="pun">+</span><span class="pln"> upperCase </span><span class="pun">+</span><span class="pln"> digits </span><span class="pun">+</span><span class="pln"> symbols</span><span class="pun">)</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> length
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- The below function calls are to indicate the difference in search space for a set of passwords</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"a"</span><span class="pun">))</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"abc"</span><span class="pun">))</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"Abc"</span><span class="pun">))</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"Ab!"</span><span class="pun">))</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"Ab!0"</span><span class="pun">))</span><span class="pln">

<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"Mu#9A0h."</span><span class="pun">))</span><span class="pln">
<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-print" rel="external nofollow">print</a></span></span><span class="pun">(</span><span class="pln">getPasswordSearchSpace</span><span class="pun">(</span><span class="str">"This is a demonstration of how easy an incredibly strong password is to remember"</span><span class="pun">))</span></pre>

<p>
	 
</p>

<p>
	<strong>How to handle database leaks</strong><br>
	If you have reason to believe that your database has been leaked or otherwise compromised, it is important that your first course of action is removing any access tokens stored in your database. Once you have done that you have to inform your users. Whilst when properly hashed and salted it's extremely difficult / time consuming to find out a user's password it <strong>is</strong> still a possibilty. So you should inform your users of the breach, tell them that their passwords were properly hashed, and they do not need to fear for their passwords immediately. However you should suggest to your users that they change their password either way, just in case.
</p>

<p>
	<b>What even is hashing and salting?</b><br>
	Hashing has been brought up several times in this tutorial, whilst you do not need to know what it is / does, you might be interested in knowing regardless. I won't be going too far in depth as I simply do not have the knowledge, but the basic idea of hashing is this:
</p>

<p>
	When you hash anything, you turn it into a string of characters (or other value) that has no relation to the original input, other than when you hash the original input again, it will always generate the same hash.<br>
	For example, when you hash the stirng 'banana' using the sha512 hashing algorithm, it will always yield the output: "F8E3183D38E6C51889582CB260AB825252F395B4AC8FB0E6B13E9A71F7C10A80D5301E4A949F2783CB0C20205F1D850F87045F4420AD2271C8FD5F0CD8944BE3"
</p>

<p>
	Now hashing can not be reverted, you can not "unhash" a hash, so in order to verify someone's password you hash it again, and see if the two hashes are the exact same. Now this is great, passwords are safely stored. However there is still more to do, salting.
</p>

<p>
	Salting is adding some random data to your password prior to hashing it. This prevents when two users (on the same service, or on others) have the same password, that their hashes are also the same. Meaning if one password is compromised, the other password is not. It is important that a salt is random for every user in your application, not one salt for your entire application.
</p>

<p>
	Now you might think we didn't do any salting in the code / tutorial above. This is not true, we just didn't do it ourselves. MTA's passwordHash function actually hashes the passwords and salts it, this salt is then stored in the output hash it self, just before the actual password hash. In the case of bcrypt it actually stores a little bit more info in the resulting hash, but you need not worry about that.
</p>


			
		</div>

		
			<div class="ipsItemControls">
				
					
						

	<div data-controller='core.front.core.reaction' class='ipsItemControls_right ipsClearfix '>	
		<div class='ipsReact ipsPos_right'>
			
				
				<div class='ipsReact_blurb ' data-role='reactionBlurb'>
					
						

	
	<ul class='ipsReact_reactions'>
		
		
			
				
				<li class='ipsReact_reactCount'>
					
						<span data-ipsTooltip title="Like">
					
							<span>
								<img src='../../uploads/reactions/react_like.png' alt="Like" loading="lazy">
							</span>
							<span>
								15
							</span>
					
						</span>
					
				</li>
			
		
	</ul>

					
				</div>
			
			
			
		</div>
	</div>

					
				
				<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
					
						
						
						
					
					
<li class="ipsHide" data-role="commentLoading">
						<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
					</li>
				</ul>
			</div>
		

		
	</div>

	

	



<div class='ipsPadding ipsHide cPostShareMenu' id='elShareComment_937075_menu'>
	<h5 class='ipsType_normal ipsType_reset'>Link to comment</h5>
	
		
	
	
	<input type='text' value='https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/' class='ipsField_fullWidth'>

	
</div>
</div>

	</div>
</article>
					
						<ul class='ipsTopicMeta'>
							
								
									<li class="ipsTopicMeta__item ipsTopicMeta__item--moderation">
										<span class='ipsTopicMeta__time ipsType_light'><time datetime='2018-12-03T18:49:00Z' title='03/12/18 18:49 ' data-short='3 yr'>3 yr</time></span>
										<span class='ipsTopicMeta__action'>


<a href='../../profile/38052-dutchman101/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/38052-dutchman101/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to Dutchman101's profile" class="ipsType_break"><span style='color:#a47ceb; font-weight: bold'>Dutchman101</span></a> featured, unfeatured, pinned and featured this topic</span>
									</li>
								
							
							
								<li class="ipsTopicMeta__item ipsTopicMeta__item--time">
									10 months later...
								</li>
							
						</ul>
					
					
					
				

					

					
					



<a id='comment-967380'></a>
<article  id='elComment_967380' class='cPost ipsBox ipsResponsive_pull  ipsComment ipsComment_popular ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone    '>
	

	
		<div class='ipsResponsive_showPhone ipsComment_badges'>
			<ul class='ipsList_reset ipsFlex ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1'>
				
				
				
				
					<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>Popular Post</strong></li>
				
			</ul>
		</div>
	

	<div class='cAuthorPane_mobile ipsResponsive_showPhone'>
		<div class='cAuthorPane_photo'>
			<div class='cAuthorPane_photoWrap'>
				


	<a href="../../profile/71089-pixelaisar01/index.html" rel="nofollow" data-ipsHover data-ipsHover-width="370" data-ipsHover-target="https://forum.multitheftauto.com/profile/71089-pixelaisar01/?do=hovercard" class="ipsUserPhoto ipsUserPhoto_large" title="Go to PixelAisar01's profile">
		<img src='../../uploads/monthly_2019_09/download.thumb.png.39509f73b175c0b6f622044ee6edce68.png' alt='PixelAisar01' loading="lazy">
	</a>

				
				
					<a href="../../profile/71089-pixelaisar01/badges/index.html" rel="nofollow">
						
<img src='../../uploads/set_resources_22/84c1e40ea0e759e3f1505eb1788ddf3c_default_rank.png' loading="lazy" alt="Vic" class="cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px" data-ipsTooltip title="Rank: Vic (3/54)">
					</a>
				
			</div>
		</div>
		<div class='cAuthorPane_content'>
			<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_break ipsType_blendLinks ipsFlex ipsFlex-ai:center'>
				


<a href='../../profile/71089-pixelaisar01/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/71089-pixelaisar01/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to PixelAisar01's profile" class="ipsType_break">PixelAisar01</a>
			</h3>
			<div class='ipsType_light ipsType_reset'>
				<a href='index674a.html?do=findComment&amp;comment=967380' rel="nofollow" class='ipsType_blendLinks'>Posted <time datetime='2019-11-01T16:11:53Z' title='01/11/19 16:11 ' data-short='2 yr'>November 1, 2019</time></a>
				
			</div>
		</div>
	</div>
	<aside class='ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone'>
		<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break'><strong>


<a href='../../profile/71089-pixelaisar01/index.html' rel="nofollow" data-ipsHover data-ipsHover-width='370' data-ipsHover-target='https://forum.multitheftauto.com/profile/71089-pixelaisar01/?do=hovercard&amp;referrer=https%253A%252F%252Fforum.multitheftauto.com%252Ftopic%252F112973-handling-user-credentials-authentication%252F' title="Go to PixelAisar01's profile" class="ipsType_break">PixelAisar01</a></strong>
			
		</h3>
		<ul class='cAuthorPane_info ipsList_reset'>
            
			<li data-role='photo' class='cAuthorPane_photo'>
				<div class='cAuthorPane_photoWrap'>
					


	<a href="../../profile/71089-pixelaisar01/index.html" rel="nofollow" data-ipsHover data-ipsHover-width="370" data-ipsHover-target="https://forum.multitheftauto.com/profile/71089-pixelaisar01/?do=hovercard" class="ipsUserPhoto ipsUserPhoto_large" title="Go to PixelAisar01's profile">
		<img src='../../uploads/monthly_2019_09/download.thumb.png.39509f73b175c0b6f622044ee6edce68.png' alt='PixelAisar01' loading="lazy">
	</a>

					
					
						
<img src='../../uploads/set_resources_22/84c1e40ea0e759e3f1505eb1788ddf3c_default_rank.png' loading="lazy" alt="Vic" class="cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px" data-ipsTooltip title="Rank: Vic (3/54)">
					
				</div>
			</li>
			
				<li data-role='group'>Members</li>
				
			
			
				<li data-role='reputation-badge'>
					

	
		<span title="Member's total reputation" data-ipsTooltip class='ipsRepBadge ipsRepBadge_positive'>
	
			<i class='fa fa-plus-circle'></i> 8
	
		</span>
	

				</li>
				<li data-role='stats'>
					<ul class="ipsList_reset ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:center ipsGap_row:2 cAuthorPane_stats">
						<li>
							<a href="../../profile/71089-pixelaisar01/content/index.html" rel="nofollow" title="6 posts" data-ipsTooltip class="ipsType_blendLinks">
								<i class="fa fa-comment"></i> 6
							</a>
						</li>
						
					</ul>
				</li>
				

			
		</ul>
	</aside>
	<div class='ipsColumn ipsColumn_fluid ipsMargin:none'>
		

<div id="comment-967380_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="967380" data-quotedata="{&quot;userid&quot;:71089,&quot;username&quot;:&quot;PixelAisar01&quot;,&quot;timestamp&quot;:1572624713,&quot;contentapp&quot;:&quot;forums&quot;,&quot;contenttype&quot;:&quot;forums&quot;,&quot;contentid&quot;:112973,&quot;contentclass&quot;:&quot;forums_Topic&quot;,&quot;contentcommentid&quot;:967380}" class="ipsComment_content ipsType_medium">

	<div class="ipsComment_meta ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:between ipsFlex-fd:row-reverse">
		<div class="ipsType_light ipsType_reset ipsType_blendLinks ipsComment_toolWrap">
			<div class="ipsResponsive_hidePhone ipsComment_badges">
				<ul class="ipsList_reset ipsFlex ipsFlex-jc:end ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1">
					
					
					
					
					
						<li><strong class="ipsBadge ipsBadge_large ipsBadge_popular">Popular Post</strong></li>
					
				</ul>
			</div>
			<ul class="ipsList_reset ipsComment_tools">
				<li>
					<a href="#elControls_967380_menu" class="ipsComment_ellipsis" id="elControls_967380" title="More options..." data-ipsmenu data-ipsmenu-appendto="#comment-967380_wrap"><i class="fa fa-ellipsis-h"></i></a>
					<ul id="elControls_967380_menu" class="ipsMenu ipsMenu_narrow ipsHide">
						
						
							<li class="ipsMenu_item"><a href="index674a.html?do=findComment&amp;comment=967380" rel="nofollow" title="Share this post" data-ipsdialog data-ipsdialog-size="narrow" data-ipsdialog-content="#elShareComment_967380_menu" data-ipsdialog-title="Share this post" id="elSharePost_967380" data-role="shareComment">Share</a></li>
						
                        
						
						
						
							
								
							
							
							
							
							
							
						
					</ul>
				</li>
				
			</ul>
		</div>

		<div class="ipsType_reset ipsResponsive_hidePhone">
			<a href="index674a.html?do=findComment&amp;comment=967380" rel="nofollow" class="ipsType_blendLinks">Posted <time datetime='2019-11-01T16:11:53Z' title='01/11/19 16:11 ' data-short='2 yr'>November 1, 2019</time></a>
			
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	

    

	<div class="cPost_contentWrap">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsPadding_bottom ipsContained" data-controller="core.front.core.lightboxedImages">
			<p>
	I did'nt understand anything.
</p>


			
		</div>

		
			<div class="ipsItemControls">
				
					
						

	<div data-controller='core.front.core.reaction' class='ipsItemControls_right ipsClearfix '>	
		<div class='ipsReact ipsPos_right'>
			
				
				<div class='ipsReact_blurb ' data-role='reactionBlurb'>
					
						

	
	<ul class='ipsReact_reactions'>
		
		
			
				
				<li class='ipsReact_reactCount'>
					
						<span data-ipsTooltip title="Haha">
					
							<span>
								<img src='../../uploads/reactions/react_haha.png' alt="Haha" loading="lazy">
							</span>
							<span>
								7
							</span>
					
						</span>
					
				</li>
			
		
			
				
				<li class='ipsReact_reactCount'>
					
						<span data-ipsTooltip title="Sad">
					
							<span>
								<img src='../../uploads/reactions/react_sad.png' alt="Sad" loading="lazy">
							</span>
							<span>
								4
							</span>
					
						</span>
					
				</li>
			
		
	</ul>

					
				</div>
			
			
			
		</div>
	</div>

					
				
				<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
					
						
						
						
					
					
<li class="ipsHide" data-role="commentLoading">
						<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
					</li>
				</ul>
			</div>
		

		
	</div>

	

	



<div class='ipsPadding ipsHide cPostShareMenu' id='elShareComment_967380_menu'>
	<h5 class='ipsType_normal ipsType_reset'>Link to comment</h5>
	
		
	
	
	<input type='text' value='https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/?do=findComment&amp;comment=967380' class='ipsField_fullWidth'>

	
</div>
</div>

	</div>
</article>
					
					
					
				
			
			
<input type="hidden" name="csrfKey" value="714bb4c8fac35f8286ae64e012ef2366" />


		</form>
	</div>

	
	
	
	
	

	
		<div class='ipsBox ipsPadding ipsResponsive_pull ipsResponsive_showPhone ipsMargin_top'>
			
				<div class='ipsResponsive_noFloat ipsResponsive_block ipsMargin_bottom:half'>
					


				</div>
			
			<div class='ipsResponsive_noFloat ipsResponsive_block'>
				

<div data-followApp='forums' data-followArea='topic' data-followID='112973' data-controller='core.front.core.followButton'>
	

	<a href='../../login/index.html' rel="nofollow" class="ipsFollow ipsPos_middle ipsButton ipsButton_light ipsButton_verySmall ipsButton_disabled" data-role="followButton" data-ipsTooltip title='Sign in to follow this'>
		<span>Followers</span>
		<span class='ipsCommentCount'>0</span>
	</a>

</div>
			</div>
			
		</div>
	
</div>



<div class='ipsPager ipsSpacer_top'>
	<div class="ipsPager_prev">
		
			<a href="../../forum/123-tutorials/index.html" title="Go to Tutorials" rel="parent">
				<span class="ipsPager_type">Go to topic listing</span>
			</a>
		
	</div>
	
</div>


						


	<div class='cWidgetContainer '  data-role='widgetReceiver' data-orientation='horizontal' data-widgetArea='footer'>
		<ul class='ipsList_reset'>
			
				
					
					<li class='ipsWidget ipsWidget_horizontal ipsBox  ' data-blockID='app_core_activeUsers_6o9n9w8dl' data-blockConfig="true" data-blockTitle="Recently Browsing" data-blockErrorMessage="This block cannot be shown. This could be because it needs configuring, is unable to show on this page, or will show after reloading this page."  data-controller='core.front.widgets.block'>
<div data-controller='core.front.core.onlineUsersWidget'>
    <h3 class='ipsType_reset ipsWidget_title'>
        
            Recently Browsing
        
        
        &nbsp;&nbsp;<span class='ipsType_light ipsType_unbold ipsType_medium' data-memberCount="0">0 members</span>
        
    </h3>
    <div class='ipsWidget_inner ipsPad'>
        <ul class='ipsList_inline ipsList_csv ipsList_noSpacing ipsType_normal'>
            
                <li class='ipsType_reset ipsType_medium ipsType_light' data-noneOnline>No registered users viewing this page.</li>
            
        </ul>
        
    </div>
</div></li>
				
			
		</ul>
	</div>

					</div>
					


					
<nav class='ipsBreadcrumb ipsBreadcrumb_bottom ipsFaded_withHover'>
	
		


	

	<ul class='ipsList_inline ipsPos_right'>
		
		<li >
			<a data-action="defaultStream" class='ipsType_light '  href='../../discover/index.html'><i class="fa fa-newspaper-o" aria-hidden="true"></i> <span>All Activity</span></a>
		</li>
		
	</ul>

	<ul data-role="breadcrumbList">
		<li>
			<a title="Home" href='../../index.html'>
				<span>Home <i class='fa fa-angle-right'></i></span>
			</a>
		</li>
		
		
			<li>
				
					<a href='../../forum/86-mta-community/index.html'>
						<span>MTA Community <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					<a href='../../forum/71-scripting/index.html'>
						<span>Scripting <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					<a href='../../forum/123-tutorials/index.html'>
						<span>Tutorials <i class='fa fa-angle-right' aria-hidden="true"></i></span>
					</a>
				
			</li>
		
			<li>
				
					Handling user credentials (Authentication)
				
			</li>
		
	</ul>
</nav>
				</div>
			</div>
			
		</main>
		<footer id='ipsLayout_footer' class='ipsClearfix'>
			<div class='ipsLayout_container'>
				
				

<div id="mta_betaMark">Beta. Subject to change.</div>



<ul id='elFooterSocialLinks' class='ipsList_inline ipsType_center ipsSpacer_top'>
	

	
		<li class='cUserNav_icon'>
			<a href='https://www.facebook.com/multitheftauto' target='_blank' class='cShareLink cShareLink_facebook' rel='noopener noreferrer'><i class='fa fa-facebook'></i></a>
		</li>
	
		<li class='cUserNav_icon'>
			<a href='https://twitter.com/mtaqa' target='_blank' class='cShareLink cShareLink_twitter' rel='noopener noreferrer'><i class='fa fa-twitter'></i></a>
		</li>
	
		<li class='cUserNav_icon'>
			<a href='https://github.com/multitheftauto' target='_blank' class='cShareLink cShareLink_github' rel='noopener noreferrer'><i class='fa fa-github'></i></a>
		</li>
	
		<li class='cUserNav_icon'>
			<a href='https://www.youtube.com/user/MTAQA' target='_blank' class='cShareLink cShareLink_youtube' rel='noopener noreferrer'><i class='fa fa-youtube'></i></a>
		</li>
	
		<li class='cUserNav_icon'>
			<a href='https://www.linkedin.com/company/multitheftauto/' target='_blank' class='cShareLink cShareLink_linkedin' rel='noopener noreferrer'><i class='fa fa-linkedin'></i></a>
		</li>
	

	
<li class="cUserNav_icon">
  <a href="https://www.reddit.com/r/MultiTheftAuto/" target="_blank" class="cShareLink cShareLink_reddit" rel="noopener noreferrer">
    <i class="fa fa-reddit"></i>
  </a>
</li>

<li class="cUserNav_icon">
  <a href="https://www.twitch.tv/mtaqa" target="_blank" class="cShareLink cShareLink_twitch" rel="noopener noreferrer">
    <i class="fa fa-twitch"></i>
  </a>
</li>

<li class="cUserNav_icon">
  <a href="https://discord.gg/mtasa" target="_blank" class="cShareLink cShareLink_discord" rel="noopener">
    <img src="../../uploads/set_resources_22/fcd8efae86176d70eedf4d57dcc4f985_icon-discord_287702449.png" alt="Discord" width="28" height="28">
  </a>
</li>

</ul>


<ul class='ipsList_inline ipsType_center ipsSpacer_top' id="elFooterLinks">
	
	
	
	
		<li>
			<a href='#elNavTheme_menu' id='elNavTheme' data-ipsMenu data-ipsMenu-above>Theme <i class='fa fa-caret-down'></i></a>
			<ul id='elNavTheme_menu' class='ipsMenu ipsMenu_selectable ipsHide'>
			
				<li class='ipsMenu_item ipsMenu_itemChecked'>
					<form action="http://forum.multitheftauto.com/theme/?csrfKey=714bb4c8fac35f8286ae64e012ef2366" method="post">
					<input type="hidden" name="ref" value="aHR0cHM6Ly9mb3J1bS5tdWx0aXRoZWZ0YXV0by5jb20vdG9waWMvMTEyOTczLWhhbmRsaW5nLXVzZXItY3JlZGVudGlhbHMtYXV0aGVudGljYXRpb24v">
					<button type='submit' name='id' value='22' class='ipsButton ipsButton_link ipsButton_link_secondary'>Beta (Default)</button>
					</form>
				</li>
			
				<li class='ipsMenu_item'>
					<form action="http://forum.multitheftauto.com/theme/?csrfKey=714bb4c8fac35f8286ae64e012ef2366" method="post">
					<input type="hidden" name="ref" value="aHR0cHM6Ly9mb3J1bS5tdWx0aXRoZWZ0YXV0by5jb20vdG9waWMvMTEyOTczLWhhbmRsaW5nLXVzZXItY3JlZGVudGlhbHMtYXV0aGVudGljYXRpb24v">
					<button type='submit' name='id' value='20' class='ipsButton ipsButton_link ipsButton_link_secondary'>Dark </button>
					</form>
				</li>
			
				<li class='ipsMenu_item'>
					<form action="http://forum.multitheftauto.com/theme/?csrfKey=714bb4c8fac35f8286ae64e012ef2366" method="post">
					<input type="hidden" name="ref" value="aHR0cHM6Ly9mb3J1bS5tdWx0aXRoZWZ0YXV0by5jb20vdG9waWMvMTEyOTczLWhhbmRsaW5nLXVzZXItY3JlZGVudGlhbHMtYXV0aGVudGljYXRpb24v">
					<button type='submit' name='id' value='19' class='ipsButton ipsButton_link ipsButton_link_secondary'>Light </button>
					</form>
				</li>
			
				<li class='ipsMenu_item'>
					<form action="http://forum.multitheftauto.com/theme/?csrfKey=714bb4c8fac35f8286ae64e012ef2366" method="post">
					<input type="hidden" name="ref" value="aHR0cHM6Ly9mb3J1bS5tdWx0aXRoZWZ0YXV0by5jb20vdG9waWMvMTEyOTczLWhhbmRsaW5nLXVzZXItY3JlZGVudGlhbHMtYXV0aGVudGljYXRpb24v">
					<button type='submit' name='id' value='25' class='ipsButton ipsButton_link ipsButton_link_secondary'>Night </button>
					</form>
				</li>
			
			</ul>
		</li>
	
	
	
		<li><a rel="nofollow" href='../../contact/index.html' >Contact Us</a></li>
	
</ul>	


<p id='elCopyright'>
	<span id='elCopyright_userLine'></span>
	<a rel='nofollow' title='Invision Community' href='https://www.invisioncommunity.com/'>Powered by Invision Community</a>
</p>
			</div>
		</footer>
		
<div id='elMobileDrawer' class='ipsDrawer ipsHide'>
	<div class='ipsDrawer_menu'>
		<a href='#' class='ipsDrawer_close' data-action='close'><span>&times;</span></a>
		<div class='ipsDrawer_content ipsFlex ipsFlex-fd:column'>
			
				<div class='ipsPadding ipsBorder_bottom'>
					<ul class='ipsToolList ipsToolList_vertical'>
						<li>
							<a href='../../login/index.html' id='elSigninButton_mobile' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>Existing user? Sign In</a>
						</li>
						
							<li>
								
									<a href='../../register/index.html' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='Sign Up' data-ipsDialog-fixed='true' id='elRegisterButton_mobile' class='ipsButton ipsButton_small ipsButton_fullWidth ipsButton_important'>Sign Up</a>
								
							</li>
						
					</ul>
				</div>
			

			

			<ul class='ipsDrawer_list ipsFlex-flex:11'>
				

				
				
				
				
					
						
						
							<li class='ipsDrawer_itemParent'>
								<h4 class='ipsDrawer_title'><a href='#'>Browse</a></h4>
								<ul class='ipsDrawer_list'>
									<li data-action="back"><a href='#'>Back</a></li>
									
									
										
										
										
											
												
													
													
									
													
									
									
									
										


	
		
			<li>
				<a href='../../index.html' >
					Forums
				</a>
			</li>
		
	

	
		
			<li>
				<a href='../12275-forum-rules/index.html' >
					Forum Rules
				</a>
			</li>
		
	

	
		
			<li>
				<a href='../../staff/index.html' >
					Staff
				</a>
			</li>
		
	

	
		
			<li>
				<a href='../../online/index.html' >
					Online Users
				</a>
			</li>
		
	

	
		
			<li>
				<a href='../../leaderboard/index.html' >
					Leaderboard
				</a>
			</li>
		
	

										
								</ul>
							</li>
						
					
				
					
						
						
							<li class='ipsDrawer_itemParent'>
								<h4 class='ipsDrawer_title'><a href='#'>Activity</a></h4>
								<ul class='ipsDrawer_list'>
									<li data-action="back"><a href='#'>Back</a></li>
									
									
										
										
										
											
												
													
													
									
													
									
									
									
										


	
		
			<li>
				<a href='../../discover/index.html' >
					All Activity
				</a>
			</li>
		
	

	

	

	

	
		
			<li>
				<a href='../../search/index.html' >
					Search
				</a>
			</li>
		
	

										
								</ul>
							</li>
						
					
				
					
						
						
							<li class='ipsDrawer_itemParent'>
								<h4 class='ipsDrawer_title'><a href='#'>MTA Network</a></h4>
								<ul class='ipsDrawer_list'>
									<li data-action="back"><a href='#'>Back</a></li>
									
									
										
										
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
									
													
									
										<li><a href='#'>MTA Network</a></li>
									
									
										


	
		
			<li>
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://community.mtasa.com/' target='_blank' rel="noopener">
					Community
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://wiki.multitheftauto.com/wiki/Main_Page' target='_blank' rel="noopener">
					Wiki
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://github.com/multitheftauto/mtasa-blue/issues' target='_blank' rel="noopener">
					Bugs
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.com/donate/' target='_blank' rel="noopener">
					Heroes
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.com/hosters/' target='_blank' rel="noopener">
					Hosting
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.myspreadshop.net/all' target='_blank' rel="noopener">
					Merch Store
				</a>
			</li>
		
	

									
									
										


	
		
			<li>
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://community.mtasa.com/' target='_blank' rel="noopener">
					Community
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://wiki.multitheftauto.com/wiki/Main_Page' target='_blank' rel="noopener">
					Wiki
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://github.com/multitheftauto/mtasa-blue/issues' target='_blank' rel="noopener">
					Bugs
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.com/donate/' target='_blank' rel="noopener">
					Heroes
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.com/hosters/' target='_blank' rel="noopener">
					Hosting
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://multitheftauto.myspreadshop.net/all' target='_blank' rel="noopener">
					Merch Store
				</a>
			</li>
		
	

										
								</ul>
							</li>
						
					
				
					
						
						
							<li class='ipsDrawer_itemParent'>
								<h4 class='ipsDrawer_title'><a href='#'>Social Media</a></h4>
								<ul class='ipsDrawer_list'>
									<li data-action="back"><a href='#'>Back</a></li>
									
									
										
										
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
											
												
											
										
									
													
									
										<li><a href='#'>Social Media</a></li>
									
									
										


	
		
			<li>
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.twitch.tv/mtaqa' target='_blank' rel="noopener">
					Twitch
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://twitter.com/mtaqa' target='_blank' rel="noopener">
					Twitter
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.youtube.com/user/MTAQA' target='_blank' rel="noopener">
					YouTube
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://github.com/multitheftauto' target='_blank' rel="noopener">
					GitHub
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.facebook.com/multitheftauto' target='_blank' rel="noopener">
					Facebook
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.reddit.com/r/MultiTheftAuto/' target='_blank' rel="noopener">
					Reddit
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.linkedin.com/company/multitheftauto' target='_blank' rel="noopener">
					LinkedIn
				</a>
			</li>
		
	

									
									
										


	
		
			<li>
				<a href='https://discord.com/invite/mtasa' target='_blank' rel="noopener">
					Discord
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.twitch.tv/mtaqa' target='_blank' rel="noopener">
					Twitch
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://twitter.com/mtaqa' target='_blank' rel="noopener">
					Twitter
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.youtube.com/user/MTAQA' target='_blank' rel="noopener">
					YouTube
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://github.com/multitheftauto' target='_blank' rel="noopener">
					GitHub
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.facebook.com/multitheftauto' target='_blank' rel="noopener">
					Facebook
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.reddit.com/r/MultiTheftAuto/' target='_blank' rel="noopener">
					Reddit
				</a>
			</li>
		
	

	
		
			<li>
				<a href='https://www.linkedin.com/company/multitheftauto' target='_blank' rel="noopener">
					LinkedIn
				</a>
			</li>
		
	

										
								</ul>
							</li>
						
					
				
				
			</ul>

			
		</div>
	</div>
</div>

<div id='elMobileCreateMenuDrawer' class='ipsDrawer ipsHide'>
	<div class='ipsDrawer_menu'>
		<a href='#' class='ipsDrawer_close' data-action='close'><span>&times;</span></a>
		<div class='ipsDrawer_content ipsSpacer_bottom ipsPad'>
			<ul class='ipsDrawer_list'>
				<li class="ipsDrawer_listTitle ipsType_reset">Create New...</li>
				
			</ul>
		</div>
	</div>
</div>
		
		

	
	<script type='text/javascript'>
		var ipsDebug = false;		
	
		var CKEDITOR_BASEPATH = '../../applications/core/interface/ckeditor/ckeditor/index.html';
	
		var ipsSettings = {
			
			
			cookie_path: "/",
			
			cookie_prefix: "__Host-",
			
			
			cookie_ssl: true,
			
			upload_imgURL: "",
			message_imgURL: "",
			notification_imgURL: "",
			baseURL: "//forum.multitheftauto.com/",
			jsURL: "//forum.multitheftauto.com/applications/core/interface/js/js.php",
			csrfKey: "714bb4c8fac35f8286ae64e012ef2366",
			antiCache: "977ee345841657049756",
			jsAntiCache: "977ee345841658990715",
			disableNotificationSounds: true,
			useCompiledFiles: true,
			links_external: true,
			memberID: 0,
			lazyLoadEnabled: true,
			blankImg: "//forum.multitheftauto.com/applications/core/interface/js/spacer.png",
			googleAnalyticsEnabled: false,
			matomoEnabled: false,
			viewProfiles: true,
			mapProvider: 'none',
			mapApiKey: '',
			pushPublicKey: "BF0jugJbt4XMR7oOEkdDzhxlfUA_S_sdGhSwmgdA4QIkQLHVO4dNMUseahcsyX_G97J81ncc6GqHARuEBoLyWGI",
			relativeDates: true
		};
		
		
		
		
			ipsSettings['maxImageDimensions'] = {
				width: 1000,
				height: 750
			};
		
		
	</script>





<script type='text/javascript' src='../../uploads/javascript_global/root_libraryef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_global/root_js_lang_1ef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_global/root_frameworkef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_core/global_global_coreef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_global/root_frontef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_core/front_front_coreef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_forums/front_front_topicef65.js?v=977ee345841658990715' data-ips></script>


<script type='text/javascript' src='../../uploads/javascript_global/root_mapef65.js?v=977ee345841658990715' data-ips></script>



	<script type='text/javascript'>
		
			ips.setSetting( 'date_format', jQuery.parseJSON('"dd\/mm\/yy"') );
		
			ips.setSetting( 'date_first_day', jQuery.parseJSON('0') );
		
			ips.setSetting( 'ipb_url_filter_option', jQuery.parseJSON('"black"') );
		
			ips.setSetting( 'url_filter_any_action', jQuery.parseJSON('"allow"') );
		
			ips.setSetting( 'bypass_profanity', jQuery.parseJSON('0') );
		
			ips.setSetting( 'emoji_style', jQuery.parseJSON('"twemoji"') );
		
			ips.setSetting( 'emoji_shortcodes', jQuery.parseJSON('true') );
		
			ips.setSetting( 'emoji_ascii', jQuery.parseJSON('true') );
		
			ips.setSetting( 'emoji_cache', jQuery.parseJSON('1626352838') );
		
			ips.setSetting( 'image_jpg_quality', jQuery.parseJSON('85') );
		
			ips.setSetting( 'cloud2', jQuery.parseJSON('false') );
		
			ips.setSetting( 'isAnonymous', jQuery.parseJSON('false') );
		
		
	</script>



<script type='application/ld+json'>
{
    "name": "Handling user credentials (Authentication)",
    "headline": "Handling user credentials (Authentication)",
    "text": "After a worrying discussion on Discord last night regarding password storage and remember me functionality I\u0027ve decided to write a tutorial on how it should be done. This guide assumes you are not using MTA\u0027s built in account system, but a custom one.\u00a0 Any code shown in this tutorial is purely for illustrative purposes, and is not finished code, you should use it as a guideline, not a solution.\n \n\n\n\tThe following topics will be discussed in this tutorial:\n \n\n\n\t\n\t\tHow to hash and salt passwords (register)\n\t \n\t\n\t\tHow to validate a hashed password (login)\n\t \n\t\n\t\tHow to add \"remember-me\" functionality\n\t \n\t\n\t\tHow to offer password recovery\n\t \n\t\n\t\tHow to migrate from an older hashing algorithm, to a newer one\n\t \n\t\n\t\tUsing a password policy\n\t \n\t\n\t\t(Extra) How to handle database leaks\n\t \n\t\n\t\t(Extra) What even is hashing and salting?\n\t \n\n\n\n\tFor the purpose of this tutorial we expect a database structure which is somewhat similar to this:\n \n\n\n\t\n \n\n\n\tHow to hash and salt passwords \n\tWhen you have a user register on your service, that user expects of you to keep their password safe. Whilst it is generally bad practice to use the same password for multiple services there are many users that still do so. Because of this it\u0027s crucial that you save the user\u0027s passwords in a way that an attacker will be unable to find out the original password the user typed.\u00a0This includes if they have full access to your database. In order to do this we do what is called \"Password hashing\"\n \n\n\n\tWhen a user registers, your server receives the user\u0027s intended username, (email) and password. Before you save that password to the database you have to hash and salt this, luckily MTA has a function that takes care of this. If you wish to know more about what exactly it does, there\u0027s more information at the end of this tutorial.\u00a0\n \n\n\n\tIn order to hash this password you use the passwordHash function. This function is relatively slow (by design), so it is highly recommended you pass a callback to this function, so your entire script doesn\u0027t wait for it to complete.\n \n\n\n\thttps://wiki.multitheftauto.com/wiki/PasswordHash\n \n\n\nlocal mysqlHandle -- we\u0027re assuming this value is set somewhere else in code\n\nfunction register(username, email, password)\n    local player = client\n\n    passwordHash(password, \"bcrypt\", {}, function(hashedPassword)\n        -- callback function for hashing the password\n        local handle = dbExec(function(handle) \n            -- callback function for storing the user in the database\n            if (handle) then\n                triggerClientEvent(player, \"registrationSuccess\") -- inform the user that registration was successful\n            else\n                triggerClientEvent(player, \"registrationFailed\")\n            end\n        end,mysqlHandle, \"INSERT INTO users (email, username, password) VALUES (?, ?, ?)\", email, username, hashedPassword)\n\n    end)\n\nend\naddEvent(\"passwordTutorial:register\", true)\naddEventHandler(\"passwordTutorial:register\", getRootElement(), register)\n\n\n\t\u00a0\n \n\n\n\tHow to validate a hashed password \n\tOnce you\u0027ve saved the hashed pasword to your database you need to do a little bit of additional work when authenticating the user. Luckily MTA offers a passwordVerify() function, which is the counterpart of the previously discussed passwordHash(). What this function does it basically hashes the password in the same way, resulting in the same output hash.\n \n\n\n\thttps://wiki.multitheftauto.com/wiki/passwordVerify\n \n\n\n\tIn order to get the account the user is trying to log in to you have to do a query for an account which has the user submitted username, and of which the password matches through passwordVerify. PasswordVerify is also a relatively slow function, thus you should use a callback.\n \n\n\n\t\u00a0\n \n\n\nfunction login(username, password)\n    local player = client\n\n    dbQuery(function (handle)\n        -- callback for the query selecting the user by username\n        local results = dbPoll(handle, -1)\n        if (#results == 0) then\n            triggerClientEvent(player, \"loginFailed\")\n            return\n        end\n\n        passwordVerify(password, results[1].password, {}, function(matches)\n            -- callback function for the password verify\n            if (matches) then\n                -- Do anything you wish with the database result to log the player in with the rest of your scripts\n                triggerClientEvent(player, \"loginSuccess\")\n            else\n                triggerClientEvent(player, \"loginFailed\")\n            end\n        end)\n\n    end, mysqlHandle, \"SELECT * FROM users WHERE username = ?\", username)\nend\naddEvent(\"passwordTutorial:login\", true)\naddEventHandler(\"passwordTutorial:login\", getRootElement(), login)\n\n\n\t\u00a0\n \n\n\n\tHow to add \"remember me\" functionality \n\tWhen users on your server log in, they often do not want to have to enter their username and password every time they want to log in. In order to satisfy this need you can implement a \"remember me\" function. What I\u0027ve seen happen in the past, is people would store the user\u0027s password (encrypted) on the client. This is\u00a0NOT\u00a0safe, and should never be done!\n \n\n\n\tIn order to properly use remember me functionality what you would do is upon login in, generate a random string. The longer the better. This random string is what we call an access token. You would then allow the user to log in with such an access token, preferably only once generating a new access token each time one is used.\n \n\n\n\tTo implement this you would generate that token every time the user logs in, whilst they have \"remember me\" enabled. You will have to save this token in your database alongside your user.\u00a0 For extra security you could also store the user\u0027s serial alongside the access token, you can then validate that the access token is being used from the same device.\n \n\n\n\thttps://wiki.multitheftauto.com/wiki/Filepath\n \n\n\nfunction login(username, password)\n    -- This code should be put in the callback to the dbQuery function, but to keep the example clean that\u0027s not shown here\n    if (rememberMe) then\n        local token = generateRandomToken()\n        dbExec(function() \n            triggerClientEvent(player, \"loginSuccess\", token)\n        end,mysqlHandle, \"INSERT INTO access_tokens (user_id, token) VALUES (?, ?)\", results[1].id, token)\n    end\nend\n\nfunction rememberMeLogin(username, accessToken)\n    -- this function handles a user\u0027s login attempt \n    dbQuery(function(handle)\n        local result = dbPoll(handle, -1)\n        if (#result == 0) then\n            triggerClientEvent(player, \"loginFailed\")\n        else\n            -- Do anything you wish with the database result to log the player in with the rest of your scripts\n            triggerClientEvent(player, \"loginSuccess\")\n        end\n    end,mysqlHandle, \"SELECT users.* FROM access_tokens JOIN users ON users.id = access_tokens.user_id WHERE users.username = ?\", username)\nend\naddEvent(\"passwordTutorial:loginRememberMe\", true)\naddEventHandler(\"passwordTutorial:loginRememberMe\", getRootElement(), login)\n\n\n\tHow to offer password recovery \n\tOffering password recovery requires a little bit more than just your MTA server. Generally\u00a0password recovery is done with emails. So you would need access to an email server / service which you can use to send an email from an HTTP request. (Like you can do with fetchRemote()).\u00a0\n \n\n\n\tWhen a user requests a password reset, have them enter the email you registered with. You then fetch a user from the database with this email address. You would then store a password recovery token for this user. This token, just like the remember me token, is a random string.\u00a0\n \n\n\n\tIdeally, you would send the user a link with a password reset form that goes to a webpage where the user can reset their password. You could do this with an external service, like a webserver. Or you could use MTA\u0027s Resource web access for it, but if you do make sure you handle permissions properly for anything else that uses this. However another option would be to have the user copy paste the generated token from the email into you server\u0027s login window.\u00a0\n \n\n\n\tWhich of the two solutions you pick is up to you, my personal preference goes to the one with the link in the email. But in either case the server side logic is the same.\n \n\n\n\tWhen the user attempts to perform password recovery, verify that the token they give you belongs to a user, and then change the password to the newly requested password. Make sure you hash this password the same way you do in your login.\n \n\n\nfunction requestPasswordRecovery(email)\n    dbQuery(function (handle))\n        local result = dbPoll(handle, -1)\n        if (#result == 0) then\n            triggerClientEvent(player, \"passwordTutorial:passwordRecoveryRequestFailed\")\n        else\n            local token = generateRandomToken()\n            dbExec(mysqlHandle, \"UPDATE user_data SET recovery_token = ?\", token)\n            -- mail the token to the user, mail implementation depends on the mail server/service you use\n            triggerClientEvent(player, \"passwordTutorial:passwordRecoveryRequestSuccess\")\n        end\n    end, mysqlHandle, \"SELECT * FROM users WHERE email = ?\", email)\nend\n\nfunction recoverPassword(recoveryToken, password)\n    dbQuery(function (handle)\n        local result = dbPoll(handle, -1)\n        if (#result == 0) then\n            -- this is only valid if you have the user request password recovery from ingame\n            triggerClientEvent(player, \"passwordTutorial:passwordRecoveryFailed\")\n        else\n\n            passwordHash(password, \"bcrypt\", {}, function(hashedPassword)\n                -- callback function for hashing the password\n                local handle = dbExec(function(handle) \n                    -- callback function for storing the new password in the database\n                    if (handle) then\n                        -- this is only valid if you have the user request password recovery from ingame\n                        triggerClientEvent(player, \"passwordTutorial:passwordRecoverySuccess\") -- inform the user that registration was successful\n                    else\n                        -- this is only valid if you have the user request password recovery from ingame\n                        triggerClientEvent(player, \"passwordTutorial:passwordRecoveryFailed\")\n                    end\n                end,mysqlHandle, \"UPDATE user_data SET password = ? WHERE recovery_token = ?\", username, recoveryToken)\n        \n            end)\n\n        end\n    end, \"SELECT * FROM users WHERE recovery_token = ?\", recoveryToken)\nend\n\n\n\tBesides changing the password, it\u0027s important you also delete any access tokens that user might have if you\u0027re using remember me functionality. \n\tIt is also good practice to make recovery tokens expiry after a certain amount of times, and not allow a recovery token to be created whilst one is already in prgoress. This prevents a user from sending a large number of emails from your service.\n \n\n\n\t \n\tHow to migrate from an older hashing algorithm, to a newer one \n\tMaybe after reading this topic\u00a0you realise that your password security is not what it should be. So you want to change your old password hashing / validation logic to the ones explained in this topic. And due to the nature that hashes can not be \"unhashed\", you can\u0027t simply migrate your passwords over. So in order to migrate the passwords what you have to do is when a user logs in, first validate their password with the old hashing algorithm. If this matches, then hash (and salt) it with your new hashing algorithm and save it in your database. Make sure to delete the old password otherwise your password security is not any better than before.\n \n\n\n\tUsing a password policy \n\tPasswords policies are important to prevent your users from picking a password that is too easily cracked / brute forced. Many password policies come in the form of \"Must have at least one capital letter, one digit and one number\". But that discards that fact that the best way to make your password more difficult to crack, is making your password longer. So in the code snippet below is a function that measures the \u0027search space\u0027 of a password. The search space of a password is the amount of possible passwords there are with a certain combination of characters.\n \n\n\n\tIn order to use this, you would have to set a minimum password search space when a user registers for an account. This minimum is up for you to set, but be reasonable, you shouldn\u0027t expect a user\u0027s password to be impossible to remember / create. I recomend playing with the function a bit to see what values you get out of it, and pick something you believe is sensible.\n \n\n\nfunction getPasswordSearchSpace(password)\n    local lowerCase = password:find(\"%l\") and 26 or 0\n    local upperCase = password:find(\"%u\") and 26 or 0\n    local digits = password:find(\"%d\") and 10 or 0\n    local symbols = password:find(\"%W\") and 32 or 0\n    local length = password:len()\n\n    return (lowerCase + upperCase + digits + symbols) ^ length\nend\n\n-- The below function calls are to indicate the difference in search space for a set of passwords\nprint(getPasswordSearchSpace(\"a\"))\nprint(getPasswordSearchSpace(\"abc\"))\nprint(getPasswordSearchSpace(\"Abc\"))\nprint(getPasswordSearchSpace(\"Ab!\"))\nprint(getPasswordSearchSpace(\"Ab!0\"))\n\nprint(getPasswordSearchSpace(\"Mu#9A0h.\"))\nprint(getPasswordSearchSpace(\"This is a demonstration of how easy an incredibly strong password is to remember\"))\n\n\n\t\u00a0\n \n\n\n\tHow to handle database leaks \n\tIf you have reason to believe that your database has been leaked or otherwise compromised, it is important that your first course of action is removing any access tokens stored in your database. Once you have done that you have to inform your users. Whilst when properly hashed and salted it\u0027s extremely difficult / time consuming to find out a user\u0027s password it\u00a0is\u00a0still a possibilty. So you should inform your users of the breach, tell them that their passwords were properly hashed, and they do not need to fear for their passwords immediately. However you should suggest to your users that they change their password either way, just in case.\n \n\n\n\tWhat even is hashing and salting? \n\tHashing has been brought up several times in this tutorial, whilst you do not need to know what it is / does, you might be interested in knowing regardless. I won\u0027t be going too far in depth as I simply do not have the knowledge, but the basic idea of hashing is this:\n \n\n\n\tWhen you hash anything, you turn it into a string of characters (or other value)\u00a0that has no relation to the original input, other than when you hash the original input again, it will always generate the same hash. \n\tFor example, when you hash the stirng \u0027banana\u0027 using the sha512 hashing algorithm, it will always yield the output: \"F8E3183D38E6C51889582CB260AB825252F395B4AC8FB0E6B13E9A71F7C10A80D5301E4A949F2783CB0C20205F1D850F87045F4420AD2271C8FD5F0CD8944BE3\"\n \n\n\n\tNow hashing can not be reverted, you can not \"unhash\" a hash, so in order to verify someone\u0027s password you hash it again, and see if the two hashes are the exact same. Now this is great, passwords are safely stored. However there is still more to do, salting.\n \n\n\n\tSalting is adding some random data to your password prior to hashing it. This prevents when two users (on the same service, or on others) have the same password, that their hashes are also the same. Meaning if one password is compromised, the other password is not. It is important that a salt is random for every user in your application, not one salt for your entire application.\n \n\n\n\tNow you might think we didn\u0027t do any salting in the code / tutorial above. This is not true, we just didn\u0027t do it ourselves. MTA\u0027s passwordHash function actually hashes the passwords and salts it, this salt is then stored in the output hash it self, just before the actual password hash. In the case of bcrypt it actually stores a little bit more info in the resulting hash, but you need not worry about that.\n \n",
    "dateCreated": "2018-11-28T09:04:24+0000",
    "datePublished": "2018-11-28T09:04:24+0000",
    "dateModified": "2019-11-01T16:11:53+0000",
    "image": "https://forum.multitheftauto.com/uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png",
    "author": {
        "@type": "Person",
        "name": "NanoBob",
        "image": "https://forum.multitheftauto.com/uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png",
        "url": "https://forum.multitheftauto.com/profile/51280-nanobob/"
    },
    "interactionStatistic": [
        {
            "@type": "InteractionCounter",
            "interactionType": "http://schema.org/ViewAction",
            "userInteractionCount": 6184
        },
        {
            "@type": "InteractionCounter",
            "interactionType": "http://schema.org/CommentAction",
            "userInteractionCount": 1
        },
        {
            "@type": "InteractionCounter",
            "interactionType": "http://schema.org/FollowAction",
            "userInteractionCount": 0
        }
    ],
    "@context": "http://schema.org",
    "@type": "DiscussionForumPosting",
    "@id": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/",
    "isPartOf": {
        "@id": "https://forum.multitheftauto.com/#website"
    },
    "publisher": {
        "@id": "https://forum.multitheftauto.com/#organization",
        "member": {
            "@type": "Person",
            "name": "NanoBob",
            "image": "https://forum.multitheftauto.com/uploads/monthly_2017_04/avatar.thumb.png.56de13fb0fa3fede34c276e0a8298832.png",
            "url": "https://forum.multitheftauto.com/profile/51280-nanobob/"
        }
    },
    "url": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/",
    "discussionUrl": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/"
    },
    "pageStart": 1,
    "pageEnd": 1,
    "comment": [
        {
            "@type": "Comment",
            "@id": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/#comment-967380",
            "url": "https://forum.multitheftauto.com/topic/112973-handling-user-credentials-authentication/#comment-967380",
            "author": {
                "@type": "Person",
                "name": "PixelAisar01",
                "image": "https://forum.multitheftauto.com/uploads/monthly_2019_09/download.thumb.png.39509f73b175c0b6f622044ee6edce68.png",
                "url": "https://forum.multitheftauto.com/profile/71089-pixelaisar01/"
            },
            "dateCreated": "2019-11-01T16:11:53+0000",
            "text": "I did\u0027nt understand anything.\n \n",
            "upvoteCount": 7
        }
    ]
}	
</script>

<script type='application/ld+json'>
{
    "@context": "http://www.schema.org",
    "publisher": "https://forum.multitheftauto.com/#organization",
    "@type": "WebSite",
    "@id": "https://forum.multitheftauto.com/#website",
    "mainEntityOfPage": "https://forum.multitheftauto.com/",
    "name": "Multi Theft Auto: Forums",
    "url": "https://forum.multitheftauto.com/",
    "potentialAction": {
        "type": "SearchAction",
        "query-input": "required name=query",
        "target": "https://forum.multitheftauto.com/search/?q={query}"
    },
    "inLanguage": [
        {
            "@type": "Language",
            "name": "English (UK)",
            "alternateName": "en-GB"
        }
    ]
}	
</script>

<script type='application/ld+json'>
{
    "@context": "http://www.schema.org",
    "@type": "Organization",
    "@id": "https://forum.multitheftauto.com/#organization",
    "mainEntityOfPage": "https://forum.multitheftauto.com/",
    "name": "Multi Theft Auto: Forums",
    "url": "https://forum.multitheftauto.com/",
    "logo": {
        "@type": "ImageObject",
        "@id": "https://forum.multitheftauto.com/#logo",
        "url": "https://forum.multitheftauto.com/uploads/monthly_2021_09/logo-v2.png.f8c8fa62527075983bc8c7b93a3229aa.png"
    },
    "sameAs": [
        "https://www.facebook.com/multitheftauto",
        "https://twitter.com/mtaqa",
        "https://github.com/multitheftauto",
        "https://www.youtube.com/user/MTAQA",
        "https://www.linkedin.com/company/multitheftauto/"
    ]
}	
</script>

<script type='application/ld+json'>
{
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "item": {
                "@id": "https://forum.multitheftauto.com/forum/86-mta-community/",
                "name": "MTA Community"
            }
        },
        {
            "@type": "ListItem",
            "position": 2,
            "item": {
                "@id": "https://forum.multitheftauto.com/forum/71-scripting/",
                "name": "Scripting"
            }
        },
        {
            "@type": "ListItem",
            "position": 3,
            "item": {
                "@id": "https://forum.multitheftauto.com/forum/123-tutorials/",
                "name": "Tutorials"
            }
        }
    ]
}	
</script>

<script type='application/ld+json'>
{
    "@context": "http://schema.org",
    "@type": "ContactPage",
    "url": "https://forum.multitheftauto.com/contact/"
}	
</script>


		
		
		<!--ipsQueryLog-->
		<!--ipsCachingLog-->
		
		
		
        
	</body>
</html>