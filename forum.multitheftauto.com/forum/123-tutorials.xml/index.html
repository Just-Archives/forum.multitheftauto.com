<?xml version="1.0"?>
<rss version="2.0"><channel><title>Tutorials Latest Topics</title><link>https://forum.multitheftauto.com/forum/123-tutorials/</link><description>Tutorials Latest Topics</description><language>en</language><item><title>[Playlist] OOP | Object-Oriented Programming.</title><link>https://forum.multitheftauto.com/topic/135849-playlist-oop-object-oriented-programming/</link><description><![CDATA[<p>
	<span style="font-size:22px;">I found these great tutorials that may clarify the idea of oop for many programmers and I want to share them with you, good luck.</span>
</p>

<div class="ipsEmbeddedVideo">
	<div>
		<iframe allowfullscreen="" frameborder="0" height="113" src="https://www.youtube-nocookie.com/embed/videoseries?list=PL1A1gsSe2tMzpqi8hE5bCUCyQdAWwthuz" width="200"></iframe>
	</div>
</div>
]]></description><guid isPermaLink="false">135849</guid><pubDate>Tue, 17 May 2022 09:28:54 +0000</pubDate></item><item><title>[ENCHANTMENT] client - Render events enchanting</title><link>https://forum.multitheftauto.com/topic/103866-enchantment-client-render-events-enchanting/</link><description><![CDATA[<div data-controller="core.front.core.articlePages">
	<div data-role="contentPage">
		<p>
			<span style="font-size:26px;"><strong>Render events enchanting</strong></span>
		</p>

		<ul>
			<li>
				Having a lot of render events in your resource?
			</li>
			<li>
				Easier attach and remove?
			</li>
			<li>
				Or do you want to pass arguments in to a function which is attached to a render event?
			</li>
		</ul>

		<p>
			Then this might be something for you.
		</p>

		<div data-role="contentPage">
			<p>
				 
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak" />
		</div>

		<p>
			<strong>Syntax: addRenderEvent</strong>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/bool" rel="external nofollow">bool</a></span> addRenderEvent</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> functionVar </span><span class="pun">[,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> eventName</span><span class="pun">,</span><span class="pln"> arguments </span><span class="pun">...])</span></pre>

		<div data-role="contentPage">
			<p>
				<strong>Arguments:</strong>
			</p>

			<ol>
				<li>
					The function you want to attach/target.
				</li>
				<li>
					The event you want to use. ( "onClientRender", "onClientPreRender", "onClientHUDRender") If you do not fill in one of these three, it will automatic fallback to "onClientRender".<em> Fool proof.</em>
				</li>
				<li>
					Arguments you can pass to the target function. (which isn't possible with the default addEventHandler + onClientRender function)
				</li>
			</ol>

			<div data-role="contentPage">
				<p>
					<strong>Returns:</strong> <em>true </em>when<em> </em><strong>added, </strong>and <em>false </em>otherwise.
				</p>
			</div>

			<div data-role="contentPage">
				<hr data-role="contentPageBreak" />
			</div>

			<p>
				<strong>Syntax: removeRenderEvent</strong>
			</p>

			<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/bool" rel="external nofollow">bool</a></span> removeRenderEvent</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> functionVar </span><span class="pun">[,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> eventName</span><span class="pun">])</span></pre>

			<p>
				<strong>Arguments:</strong>
			</p>

			<ol>
				<li>
					The function you want to attach/target.
				</li>
				<li>
					The event you want to use. ( "onClientRender", "onClientPreRender", "onClientHUDRender") If you do not fill in one of these three, it will automatic fallback to "onClientRender".<em> Fool proof.</em>
				</li>
			</ol>

			<p>
				<strong>Returns:</strong> <em>true </em>if <strong>found </strong><strong>+ removed, </strong>and <em>false </em>otherwise.
			</p>
		</div>

		<div data-role="contentPage">
			<p>
				<strong><span style="color:#e74c3c;"><u>(Not recommended to execute this function every frame &gt; performance)</u></span></strong>
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak" />
		</div>

		<p>
			<strong>onClientPreRender + timeslice</strong>
		</p>

		<p>
			If you use "onClientPreRender", just like the default event, it will pass the timeSlice to the attached/targetted function.
		</p>

		<p>
			<a href="https://wiki.multitheftauto.com/wiki/OnClientPreRender" rel="external nofollow">https://wiki.multitheftauto.com/wiki/OnClientPreRender</a>
		</p>

		<div data-role="contentPage">
			<p>
				I am not sure if attached is the right word for this example, because it isn't really attached to the event. It is saved in a table which gets looped every frame.
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak" />
		</div>

		<p>
			<strong>Performance</strong>
		</p>

		<p>
			Is this code bad for performance? The answer to that is NO.
		</p>

		<p>
			I ran a test for it, and it seems that addRenderEvent used less CPU <u><strong>AFTER</strong></u><strong> </strong>adding the events.  (addRenderEvent: 31% CPU, addEventHandler 99/100% CPU) Adding the event will probably use more CPU, but that is only one execution. Feel free to re-test this example, I am interested how it would perform on your pc's.
		</p>

		<p>
			 
		</p>

		<p>
			<em>Performance test code</em> (Not the source code <img alt=":cat:" data-emoticon="" data-src="https://forum.multitheftauto.com/uploads/emoticons/icon_cat.gif.e6826aed3c8d77488fc5ed7104da18d8.gif" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:auto;" title=":cat:" />)
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="str">"runFirstTest"</span><span class="pun">,</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> testFunction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="kwd">end</span><span class="pln">
		addRenderEvent</span><span class="pun">(</span><span class="pln">testFunction</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span><span class="pln">

<span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="str">"runSecondTest"</span><span class="pun">,</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10000</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> testFunction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="kwd">end</span><span class="pln">
		<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> testFunction</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span></pre>

				<p>
					 
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<div data-role="contentPage">
			<p>
				 
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak" />
		</div>

		<p>
			<strong>Source code:</strong>
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="pln">   
</span><span class="com">------------------------------</span><span class="pln">
</span><span class="com">-- Authors: IIYAMA and Kenix --</span><span class="pln">
</span><span class="com">------------------------------</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> addEventHandler 		</span><span class="pun">=</span><span class="pln"> addEventHandler</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> removeEventHandler 	</span><span class="pun">=</span><span class="pln"> removeEventHandler</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> table_remove			</span><span class="pun">=</span><span class="pln"> table</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> unpack				</span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> len					</span><span class="pun">=</span><span class="pln"> table</span><span class="pun">.</span><span class="pln">getn</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> root					</span><span class="pun">=</span><span class="pln"> root</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> renderEvents </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="str">"onClientRender"</span><span class="pun">,</span><span class="pln">
	</span><span class="str">"onClientPreRender"</span><span class="pun">,</span><span class="pln">
	</span><span class="str">"onClientHUDRender"</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> allTargetFunctions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- All attached functions will be stored in this table.</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> acceptedRenderEventTypes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- Is type in use? See: renderEvents.</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> renderEventTypeStatus </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- Is the event in use? (so it doesn't have to be attached again)</span><span class="pln">

</span><span class="kwd">do</span><span class="pln">
	</span><span class="com">-- prepare the data</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> renderEvents </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> event </span><span class="pun">=</span><span class="pln"> renderEvents</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
		allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
		acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">


</span><span class="com">-- render all events here</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> processTargetFunction </span><span class="pun">(</span><span class="pln"> timeSlice </span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln"> eventName </span><span class="pun">]</span><span class="pln">

	</span><span class="kwd">local</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> itemCount </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">targetFunctions</span><span class="pun">)</span><span class="pln">

	</span><span class="kwd">repeat</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln"> i </span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- remove = true</span><span class="pln">
			table_remove</span><span class="pun">(</span><span class="pln"> targetFunctions</span><span class="pun">,</span><span class="pln"> i </span><span class="pun">)</span><span class="pln">
			itemCount </span><span class="pun">=</span><span class="pln"> itemCount </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> targetFunctionData </span><span class="pun">=</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> targetFunctionData </span><span class="kwd">then</span><span class="pln">
                </span><span class="kwd">local</span><span class="pln"> arguments </span><span class="pun">=</span><span class="pln"> targetFunctionData</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
                
                </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> arguments </span><span class="kwd">then</span><span class="pln">
                    targetFunctionData</span><span class="pun">[</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">](</span><span class="pln"> timeSlice </span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> timeSlice </span><span class="kwd">then</span><span class="pln">
                        targetFunctionData</span><span class="pun">[</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">](</span><span class="pln"> timeSlice</span><span class="pun">,</span><span class="pln"> unpack</span><span class="pun">(</span><span class="pln"> arguments </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">else</span><span class="pln">
                        targetFunctionData</span><span class="pun">[</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">](</span><span class="pln"> unpack</span><span class="pun">(</span><span class="pln"> arguments </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">end</span><span class="pln">
                </span><span class="kwd">end</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
			i </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">until</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> itemCount

    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> targetFunctions </span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> renderEventTypeStatus</span><span class="pun">[</span><span class="pln">eventName</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            removeEventHandler </span><span class="pun">(</span><span class="pln">eventName</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> processTargetFunction</span><span class="pun">)</span><span class="pln">
            renderEventTypeStatus</span><span class="pun">[</span><span class="pln">eventName</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">


</span><span class="com">-- check if a function is already attached</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> isRenderEventAdded </span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"onClientRender"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">local</span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
	
	</span><span class="kwd">for</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> targetFunctions </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> theFunction </span><span class="kwd">then</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> isRenderEventAdded </span><span class="pun">=</span><span class="pln"> isRenderEventAdded

</span><span class="com">-- add render event, default type is onClientRender</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> addRenderEvent</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"onClientRender"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> isRenderEventAdded</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
		
		</span><span class="com">-- Don't pass an arguments if it not needed.</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> aArgs </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> mArgs </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> aArgs </span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> aArgs </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">;</span><span class="pln">
		
		targetFunctions</span><span class="pun">[</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> targetFunctions </span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> theFunction</span><span class="pun">,</span><span class="pln"> mArgs </span><span class="pun">}</span><span class="pln">
		
		</span><span class="com">-- attach an event</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
			addEventHandler </span><span class="pun">(</span><span class="pln">event</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> processTargetFunction</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="str">"high"</span><span class="pun">)</span><span class="pln">
			renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
		
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- remove a render event</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> removeRenderEvent</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"onClientRender"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">local</span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
	
	</span><span class="kwd">for</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">(</span><span class="pln"> targetFunctions </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> theFunction </span><span class="kwd">then</span><span class="pln">
			targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="com">-- true = remove</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span></pre>

				<p>
					Updated by <a contenteditable="false" data-ipshover="" data-ipshover-target="https://forum.multitheftauto.com/profile/14830-kenix/?do=hovercard" data-mentionid="14830" href="https://forum.multitheftauto.com/profile/14830-kenix/" rel="">@Kenix</a>
				</p>

				<p>
					Repository: <a href="https://github.com/Kenix157/mta_render_events" rel="external nofollow">https://github.com/Kenix157/mta_render_events</a>
				</p>

				<p>
					 
				</p>

				<p>
					<strong>Previous version:</strong>
				</p>

				<div class="ipsSpoiler" data-ipsspoiler="">
					<div class="ipsSpoiler_header">
						<span>Spoiler</span>
					</div>

					<div class="ipsSpoiler_contents">
						<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="com">--------------------</span><span class="pln">
</span><span class="com">-- Author: IIYAMA --</span><span class="pln">
</span><span class="com">--------------------</span><span class="pln">

</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> renderEvents </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pun">,</span><span class="pln">
	</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientPreRender" rel="external nofollow">onClientPreRender</a></span>"</span><span class="pun">,</span><span class="pln">
	</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientHUDRender" rel="external nofollow">onClientHUDRender</a></span>"</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> allTargetFunctions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- All attached functions will be stored in this table.</span><span class="pln">

</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> acceptedRenderEventTypes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- Is type in use? See: renderEvents.</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> renderEventTypeStatus </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln"> </span><span class="com">-- Is the event in use? (so it doesn't have to be attached again)</span><span class="pln">




</span><span class="kwd">do</span><span class="pln">
	</span><span class="com">-- prepare the data</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">renderEvents </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> event </span><span class="pun">=</span><span class="pln"> renderEvents</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
		allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
		acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- render all events here</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> processTargetFunction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">timeSlice</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">eventName</span><span class="pun">]</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=#</span><span class="pln">targetFunctions</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pln">  </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> targetFunctionData </span><span class="pun">=</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> arguments </span><span class="pun">=</span><span class="pln"> targetFunctionData</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> arguments </span><span class="kwd">then</span><span class="pln">
			targetFunctionData</span><span class="pun">[</span><span class="lit">1</span><span class="pun">](</span><span class="pln">timeSlice</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> timeSlice </span><span class="kwd">then</span><span class="pln">
				targetFunctionData</span><span class="pun">[</span><span class="lit">1</span><span class="pun">](</span><span class="pln">timeSlice</span><span class="pun">,</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-unpack" rel="external nofollow">unpack</a></span></span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">))</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
				targetFunctionData</span><span class="pun">[</span><span class="lit">1</span><span class="pun">](</span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-unpack" rel="external nofollow">unpack</a></span></span><span class="pun">(</span><span class="pln">arguments</span><span class="pun">))</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">



</span><span class="com">-- check if a function is already attached</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> checkIfFunctionIsTargetted </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">targetFunctions </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> theFunction </span><span class="kwd">then</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- add render event, default type is onClientRender</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> addRenderEvent</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> checkIfFunctionIsTargetted</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
		targetFunctions</span><span class="pun">[#</span><span class="pln">targetFunctions </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{...}}</span><span class="pln">
		
		</span><span class="com">-- attach an event</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
			<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span> </span><span class="pun">(</span><span class="pln">event</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> processTargetFunction</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="str">"high"</span><span class="pun">)</span><span class="pln">
			renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- remove a render event</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> removeRenderEvent</span><span class="pun">(</span><span class="pln">theFunction</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> event </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> acceptedRenderEventTypes</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		event </span><span class="pun">=</span><span class="pln"> </span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> targetFunctions </span><span class="pun">=</span><span class="pln"> allTargetFunctions</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">targetFunctions </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> targetFunctions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> theFunction </span><span class="kwd">then</span><span class="pln">
			<span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.remove" rel="external nofollow">table</a></span></span><span class="pun"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.remove" rel="external nofollow">.</a></span></span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.remove" rel="external nofollow">remove</a></span></span><span class="pun">(</span><span class="pln">targetFunctions</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">#</span><span class="pln">targetFunctions </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
					<span><a href="https://wiki.multitheftauto.com/wiki/removeEventHandler" rel="external nofollow">removeEventHandler</a></span> </span><span class="pun">(</span><span class="pln">event</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> processTargetFunction</span><span class="pun">)</span><span class="pln">
					renderEventTypeStatus</span><span class="pun">[</span><span class="pln">event</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
				</span><span class="kwd">end</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span></pre>

						<p>
							 
						</p>
					</div>
				</div>

				<p>
					 
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			 
		</p>

		<p>
			 
		</p>
	</div>
</div>
]]></description><guid isPermaLink="false">103866</guid><pubDate>Fri, 30 Mar 2018 09:39:28 +0000</pubDate></item><item><title>[TUT] Adding a Discord bot to your server. [Newbie friendly]</title><link>https://forum.multitheftauto.com/topic/105859-tut-adding-a-discord-bot-to-your-server-newbie-friendly/</link><description><![CDATA[<p>
	OK so after many requests from people asking me to install discord bots to their servers I have decided to make the simplest tutorial on setting up a bot for your servers.
</p>

<p>
	<span style="font-size:24px;"><span style="color:#c0392b;"><strong>[NOTE]</strong></span>:</span> <span style="font-size:16px;"><strong><u>THIS IS A VPS TUTORIAL. IF YOUR SERVER ISN'T RUNNING ON A VPS THIS WILL NOT WORK FOR YOU UNLESS YOU UNDERSTAND HOW NODE.JS WORKS.</u></strong></span>
</p>

<p>
	Part 1: Bot creation
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			Go to <a href="https://discordapp.com/developers/applications/me" rel="external nofollow">this site.</a> Then you will need to login with your discord account.
		</p>

		<p>
			Click Applications to the left then click New Application.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="3eRvE9U.png" class="ipsImage" data-ratio="49.24" height="492" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/3eRvE9U.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Then give your bot a name and hit Create
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="d1pJrby.png" class="ipsImage" data-ratio="88.02" height="426" width="484" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/d1pJrby.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			After creating the app click on the Bot button to the left then select Add Bot
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="gACk2R9.png" class="ipsImage" data-ratio="49.24" height="492" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/gACk2R9.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			The app will be converted to a bot now we will copy the token and store it somewhere for later use.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="PXCk2TJ.png" class="ipsImage" data-ratio="49.24" height="492" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/PXCk2TJ.png">
				</p>
			</div>
		</div>

		<p>
			Do not share this token with anyone else they will be able to access your bot.
		</p>

		<p>
			 
		</p>

		<p>
			Now we need to invite the bot to join our discord server.
		</p>

		<p>
			To the left click on OAuth2 then scroll down to scopes and select bot then for bot permissions a good choice would be administrator.<br>
			Next hit the copy button and paste that link into a new tab in your browser.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="SFmSGFw.png" class="ipsImage" data-ratio="49.24" height="492" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/SFmSGFw.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			If done correctly you should get to this page
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="avnj2K3.png" class="ipsImage" data-ratio="49.24" height="492" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/avnj2K3.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Next select your server from the drop down list and authorize the bot to the server you want it in
		</p>

		<p>
			 
		</p>

		<p>
			If done correctly you will now see the bot offline in your server:
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="wKmvytp.png" class="ipsImage" height="127" width="227" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/wKmvytp.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>
	</div>
</div>

<p>
	<br>
	Part 2: Files Configuration
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			Firstly you will need the <a href="https://wiki.multitheftauto.com/wiki/Modules/Sockets" rel="external nofollow">mo_sockets</a> module installed on your server.
		</p>

		<p>
			Now we need to download <a href="https://github.com/Necktrox/mta-discord-bot" rel="external nofollow">the files needed</a> to get the bot running.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="ScwJeVR.png" class="ipsImage" height="503" width="1000" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/ScwJeVR.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Now extract those files and you should get a folder called "mta-discord-bot-master"
		</p>

		<p>
			In that folder we will rename the 2 folders called mta and src
		</p>

		<p>
			Rename mta to [Discord] and src to Discordbot.
		</p>

		<p>
			Upload the [Discord] folder to your resources folder in your server.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="yvjCqVT.png" class="ipsImage" height="643" width="945" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/yvjCqVT.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			open the discord resource folder and edit the config.xml.
		</p>

		<p>
			Set the name of the channel to the name of the channel you want your bot to speak in
		</p>

		<p>
			Set the passphrase to anything you want
		</p>

		<pre class="ipsCode prettyprint lang-xml prettyprinted">

<span class="tag">&lt;discord&gt;</span><span class="pln">
    </span><span class="tag">&lt;channel&gt;</span><span class="pln">name-of-your-channel</span><span class="tag">&lt;/channel&gt;</span><span class="pln">
    </span><span class="tag">&lt;passphrase&gt;</span><span class="pln">equal-to-the-server-passphrase</span><span class="tag">&lt;/passphrase&gt;</span><span class="pln">
    </span><span class="tag">&lt;hostname&gt;</span><span class="pln">localhost</span><span class="tag">&lt;/hostname&gt;</span><span class="pln">
    </span><span class="tag">&lt;port&gt;</span><span class="pln">8100</span><span class="tag">&lt;/port&gt;</span><span class="pln">
</span><span class="tag">&lt;/discord&gt;</span></pre>

		<p>
			 
		</p>

		<p>
			Now upload the Discordbot folder to somewhere in your VPS. I uploaded to the same folder that my server is in for easy access.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="asFvIZX.png" class="ipsImage" height="643" width="945" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/asFvIZX.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Rename the example.config.json file to config.json and open it
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="pun">{</span><span class="pln">
    </span><span class="str">"port"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">8100</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"passphrase"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"key"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"guild"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"guild.id"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"bots"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln">
        </span><span class="str">"channel"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"channel.name"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"token"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"bot.token"</span><span class="pln">
    </span><span class="pun">}]</span><span class="pln">
</span><span class="pun">}</span></pre>

		<p>
			 
		</p>

		<p>
			Set the passphrase to the same as your discord resource passphrase we set earlier.
		</p>

		<p>
			Your guild id is located in your server settings &gt; widgets
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="cnhGC4w.png" class="ipsImage" height="461" width="998" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/cnhGC4w.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Set the channel to the same as the channel you set earlier. This is where the bot will read messages.
		</p>

		<p>
			Input the token we got earlier when we created the bot.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="P4ZWUor.png" class="ipsImage" height="410" width="733" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/P4ZWUor.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>
	</div>
</div>

<p>
	 
</p>

<p>
	Part 3: SSH commands<br>
	 
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			Now that we have everything setup and ready here comes the fun part
		</p>

		<p>
			Login to your VPS's console and install node.js
		</p>

		<p>
			Here's a <a href="https://nodejs.org/en/download/package-manager/" rel="external nofollow">site</a> containing different OS and how to install nodejs on those systems.
		</p>

		<p>
			Once it's installed perform these commands to check if you have node installed correctly along with npm
		</p>

		<p>
			"npm -v" and "node -v"
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="SrS8MLw.png" class="ipsImage" height="386" width="642" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/SrS8MLw.png">
				</p>
			</div>
		</div>

		<p>
			Now that we have them installed we need to install process manager 2 aka <a href="https://github.com/Unitech/pm2" rel="external nofollow">pm2</a>
		</p>

		<p>
			To install pm2 we run this command "npm install pm2 -g"
		</p>

		<p>
			to make sure it's installed do a version check like we did with  npm and node
		</p>

		<p>
			 
		</p>

		<p>
			Navigate to your Discordbot directory with the command "cd path/to/folder"
		</p>

		<p>
			Now that we are in the Discordbot directory we run the command "ls" to list the items in that directory.
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="0Ggghnd.png" class="ipsImage" height="386" width="642" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/0Ggghnd.png">
				</p>
			</div>
		</div>

		<p>
			Now we use the command "npm install" to install all discord modules needed for the bot.
		</p>

		<p>
			 
		</p>

		<p>
			Listed in the directory we can see app.js which we must run with pm2 so we use the command "pm2 start app.js"
		</p>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				<span>Spoiler</span>
			</div>

			<div class="ipsSpoiler_contents">
				<p>
					<img alt="hxqB8wd.png" class="ipsImage" height="386" width="642" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/hxqB8wd.png">
				</p>
			</div>
		</div>

		<p>
			 
		</p>

		<p>
			Make sure the bot is running correctly by checking the logs on the app by doing "pm2 logs app"
		</p>

		<p>
			You should now see these messages:
		</p>

		<p>
			<img alt="DWkXojD.png" class="ipsImage" height="49" width="642" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/DWkXojD.png">
		</p>

		<p>
			And you will now see your bot online in the server
		</p>

		<p>
			<img alt="O23pQmZ.png" class="ipsImage" height="125" width="219" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/O23pQmZ.png">
		</p>

		<p>
			 
		</p>

		<p>
			Now all that's left to do is to start the discord resource in your server and once you do the bot will test it's connection to the discord by sending a message back and forth in the channel you set the bot
		</p>

		<p>
			<img alt="B8j3xia.png" class="ipsImage" height="249" width="623" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/B8j3xia.png">
		</p>

		<p>
			 
		</p>
	</div>
</div>

<p>
	 
</p>

<p>
	That should be all now go have fun annoying players in your server.
</p>

<p>
	Some feedback would be appreciated <img alt="xD" data-emoticon="" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/laugh@2x.png 2x" title="xD" width="20" data-src="https://forum.multitheftauto.com/uploads/emoticons/laugh.png">
</p>

<p>
	Good luck <img alt=":P" data-emoticon="" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/tongue@2x.png 2x" title=":P" width="20" data-src="https://forum.multitheftauto.com/uploads/emoticons/tongue.png">
</p>

<p>
	 
</p>
]]></description><guid isPermaLink="false">105859</guid><pubDate>Fri, 22 Jun 2018 21:19:36 +0000</pubDate></item><item><title>[TuT] Lua tables as a efficient data system (Custom element data)</title><link>https://forum.multitheftauto.com/topic/127520-tut-lua-tables-as-a-efficient-data-system-custom-element-data/</link><description><![CDATA[<p>
	Hey. After two years of scripting i've decided to shared a bit of my knowledge with community, which i've learnt - special thanks goes to <a contenteditable="false" data-ipshover="" data-ipshover-target="https://forum.multitheftauto.com/profile/27939-iiyama/?do=hovercard" data-mentionid="27939" href="https://forum.multitheftauto.com/profile/27939-iiyama/" rel="">@IIYAMA</a> for teaching me trigger and tables related stuff. Therefore i present you:
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Custom element data</span></strong>
</p>

<p>
	It is data system based on<strong> Lua tables and trigger(Server)(Client)Event</strong>, which was created and released back in 2020, over few months <strong>received a significant updates</strong> <strong>which</strong> <strong>introduced</strong> useful <strong>client-side features</strong> and not-so complex logic to <strong>fully control data flow</strong> through server-side. I do plan to actively develop it, mainly in improving performance which is already great, but also introducing new features.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">But before going forward...</span></strong>
</p>

<p>
	Let's do some comparision to element data. Color of divbox explains whether is a <span style="color:#008000;">pro</span>, <span style="color:#cc3333;">con</span>, or <span style="color:#808080;">neutral</span> difference.
</p>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Tables are resource dependent, that means you cannot get table and it's contents in other resource without special steps (using exports), while</span>
	</p>
</div>

<div style="background-color:#008000;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Element data is resource independent, it's possible to get data from any resource.</span>
	</p>
</div>

<div style="background-color:#808080;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Restarting resource causes table to lost stored data, while</span>
	</p>
</div>

<div style="background-color:#808080;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Element data keeps it, until element gets destroyed.</span>
	</p>
</div>

<div style="background-color:#008000;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Tables are considerably faster, while</span>
	</p>
</div>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Element data is slower.</span>
	</p>
</div>

<p>
	After acknowledging differences you might say that advantage is taken by element data system because of resource independency, but in later part of tutorial <strong>i will point out</strong> and describe <strong>two scripted features</strong> in this data system (they aren't implemented in element data) which are <strong>important during sending anything</strong> to players, afromentioned features are <strong>heavily affecting</strong> both <strong>client and server performance</strong>.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:20px;">Source code</span></strong>
</p>

<p>
	Latest version is available on <a href="https://github.com/srslyyyy/custom-data" rel="external nofollow">GitHub</a>.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Syntax</span></strong>
</p>

<p>
	<span style="color:#cc3333;"><strong>Client:</strong></span>
</p>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getCustomData(mixed pElement, string pKey, string pType)</span>
	</p>

	<p>
		<span style="color:#000000;">mixed getElementsByKey(string pKey, mixed pValue, string pType, bool pMultipleResults)</span>
	</p>

	<p>
		<span style="color:#000000;">bool setCustomData(mixed pElement, string pKey, mixed pValue, string pType, mixed pEvent, mixed pSyncer)</span>
	</p>

	<p>
		<span style="color:#000000;">bool addDataHandler(mixed pElementTypes, mixed pTypes, mixed pKeys, function pFunction, mixed pEvent)</span>
	</p>
</div>

<p>
	<br />
	<strong><span style="color:#FFA500;">Server:</span></strong>
</p>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getCustomData(mixed pElement, string pKey, string pType, mixed pRequester)</span>
	</p>

	<p>
		<span style="color:#000000;">mixed getElementsByKey(string pKey, mixed pValue, string pType, mixed pRequester, bool pMultipleResults)</span>
	</p>

	<p>
		<span style="color:#000000;">bool setCustomData(mixed pElement, string pKey, mixed pValue, string pType, mixed pReceivers, mixed pSyncer, mixed pEvent, mixed pBuffer, int pTimeout)</span>
	</p>

	<p>
		<span style="color:#000000;">bool forceBatchDataSync(mixed pQueue, mixed pType)</span>
	</p>
</div>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Function acceptable types of data, returns and behaviours:</span></strong>
</p>

<p>
	<span style="color:#cc3333;"><strong>Client:</strong></span>
</p>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getCustomData(mixed pElement, mixed pKey, string pType)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pElement: element or a string which holds data pack<br />
		pKey: string which holds data under certain name or nil<br />
		pType: string which defines data type, can be "local", "synced" or "private"</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">nil: on failure, or when certain key it's not existing<br />
		table: with all data, on success, when pKey is equal to nil<br />
		anything else: on success, this can be a string, number, table, bool</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function is used for retrieving data stored under element, you can retrieve certain key or whole data.</span>
	</p>
</div>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getElementsByKey(string pKey, mixed pValue, string pType, bool pMultipleResults)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pKey: string, which defines a key used by element<br />
		pValue: string, bool, number, userdata in case if you want filter by certain value, or false/nil if you don't need value to be matching<br />
		pType: string, which defines data types, can be "local", "synced" or "private"<br />
		pMultipleResults: bool, which decides if you want get more than one element using certain data, true for multiple elements, false for single element</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">false: on failure<br />
		table: empty on failure, and containing element(s) on success - only if pMultipleResults is enabled<br />
		element: on success</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function allows you to get a element(s) which contains certain data key, if required you can enable matching key to specified value.</span>
	</p>
</div>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">bool setCustomData(mixed pElement, string pKey, mixed pValue, string pType, mixed pEvent, mixed pSyncer)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pElement: element or string, which you wish to set data<br />
		pKey: string, which defines a key used by element<br />
		pValue: string, boolean, number, userdata or table which will be set as key value<br />
		pType: string, which defines type of data, can be "local", "synced" or "private"<br />
		pEvent: string or false/nil, defining which server event caused data to change<br />
		pSyncer: element or false/nil, responsible for data syncing</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">false: on failure<br />
		true: on success</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function allows you to set a data for element, with certain key, value and data type on client-side with some extras. It doesn't force sync due of security reasons.</span>
	</p>
</div>

<p>
	<strong><span style="color:#FFA500;">Server:</span></strong>
</p>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getCustomData(mixed pElement, string pKey, string pType, element pRequester)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pElement: element or a string which holds data pack<br />
		pKey: string which holds data under certain name or nil<br />
		pType: string which defines data type, can be "local", "synced" or "private"<br />
		pRequester: player or nil/false, which requests data - ignored when pType isn't equal to "private"</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">nil: on failure, or when certain key it's not existing<br />
		table: with all data, on success, when pKey is equal to nil<br />
		anything else: on success, this can be a string, number, table, bool</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function is used for retrieving data stored under element, you can retrieve certain key or whole data.</span>
	</p>
</div>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">mixed getElementsByKey(string pKey, mixed pValue, string pType, mixed pRequester, bool pMultipleResults)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pKey: string, which defines a key used by element<br />
		pValue: string, bool, number, userdata in case if you want filter by certain value, or false/nil if you don't need value to be matching<br />
		pType: string, which defines data types, can be "local", "synced" or "private"<br />
		pRequester: player or nil/false, which requests data - ignored when pType isn't equal to "private"<br />
		pMultipleResults: bool, which decides if you want get more than one element using certain data, true for multiple elements, false for single element</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">false: on failure<br />
		table: on success/failure, when pMultipleResults is enabled<br />
		element: on success, when pMultipleResults is disabled</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function allows you to get a element(s) which contains certain data key, if required you can enable matching key to specified value.</span>
	</p>
</div>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">bool setCustomData(mixed pElement, string pKey, mixed pValue, string pType, mixed pReceivers, mixed pSyncer, mixed pEvent, mixed pBuffer, int pTimeout)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pElement: element or string, which you wish to set data<br />
		pKey: string, which defines a key used by element<br />
		pValue: string, boolean, number, userdata or table which will be set as key value<br />
		pType: string, which defines type of data, can be "local", "synced" or "private"<br />
		pReceivers: player or table with players or nil/false, specifies which players will receive data, ignored if pType isn't equal to "private"<br />
		pSyncer: element or false/nil, responsible for data syncing<br />
		pEvent: string or false/nil, defining which server event caused data to change<br />
		pBuffer: string or false/nil, if string passed it will enable batch or buffer functionality (see below for explanation)<br />
		pTimeout: integer or false/nil, if it's == -1 then server will use batch, if it's &gt;= 0 server will use buffer, ignored if pBuffer isn't enabled</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">true: on success<br />
		false: on failure</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function allows you to set a data for element, with certain key, value and data type with some extras on server-side.</span>
	</p>
</div>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">bool forceBatchDataSync(mixed pQueue, mixed pType)</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">pQueue: string/false/nil, when string is passed server will search for specified queue to sync, otherwise it will select all queues, not dependent on it's name<br />
		pType: string/false/nil, when string is passed server will search for certain type of queue, can be "synced" or "private", otherwise it will select all queues, not dependent on type</span>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<font color="#000000">true: on success<br />
		false: on failure</font>
	</p>

	<div>
		<hr />
	</div>

	<p>
		<span style="color:#000000;">This function allows you to optimise data flow by collecting pack of data and sending it with merged trigger, further explanations available in later part of tutorial.</span>
	</p>
</div>

<p>
	After reading detailed syntax, it's time to move on next topic and understand server-side data validation. Often skipped by majority of scripters, even though it's a very important thing.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Server-side data validation</span></strong>
</p>

<p>
	It's a process when server validates data sent from client, if you aren't familiar with it, it might sound difficult, but in reality it isn't. Validation is made in server event function handler, via simple <strong>if </strong>conditions, it ensures that client sent valid data which later will be used by server. While MTA:SA anticheat is one of strongest ones and you can rely on it in most cases, it is scripter task to make sure that server-side logic is also scripted well, to completely eliminate possibility of harming your server by client sending fake (malicious variant), or incorrect data (default variant). Yes, even default client could be harmful, even unintentionally - let's take for a example ping as a main factor, due of delay between certain player and server, data for player <strong>A </strong>might have different value than for player <strong>B</strong>. What to do in that case? Answer is simple, get data value from server.
</p>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Instead of:<br />
		Client -&gt; Request data change with player value -&gt; Server -&gt; Process it</span>
	</p>
</div>

<div style="background-color:#008000;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">Do:<br />
		Client -&gt; Request data change -&gt; Server -&gt; Check for client variable -&gt; Get value from server -&gt; Process it</span>
	</p>
</div>

<p>
	But, what if (MTA) function isn't available server-side? Then you need use client for returning it and sending to server, e.g collision checks. While this might feels insecure you can (and should) always check whether type of data passed is valid. Special Lua function will be irreplaceable here.<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">local</span><span class="pln"> clientData </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> typeOfData </span><span class="pun">=</span><span class="pln"> type</span><span class="pun">(</span><span class="pln">clientData</span><span class="pun">)</span><span class="pln">

print</span><span class="pun">(</span><span class="pln">typeOfData</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- "table"</span></pre>

<div style="background-color:#0099ff;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">You might wonder what is client variable? Shortly, it's a special global variable which is used in server events. This </span><a href="https://wiki.multitheftauto.com/wiki/Script_security" rel="external nofollow"><span style="color:#000000;">wiki article</span></a><span style="color:#000000;"> explains that when we want to receive a player who called the event, we should use <strong>client </strong>instead of <strong>source</strong>. Why? Because:<br />
		<br />
		Any player with access to runcode/Lua injector can pass another player which might have admin permissions. This will result in executing server code even though it shouldn't happen by default.<br />
		Aforementioned <strong>source </strong>might be not an actual player, because you can pass pretty much every element e.g root, resourceRoot.</span>
	</p>
</div>

<p>
	Perhaps you already know that nothing is 100% safe? That is accurate sentence, but when it comes to scripted server-side data validation - you can't bypass it, if it's correctly written. Well, probably you could do that, but you'd need to access server itself, however if it'd happen then it's game over. Example of validation is <a href="https://github.com/majqqq/custom-data/blob/main/custom_data/SElementData.lua#L327" rel="external nofollow">available here</a>, since i do not pass any data from player side, <strong>if</strong> <strong>client then</strong> condition with <strong>parent check</strong> is sufficient.
</p>

<p>
	<strong>Is there anything else you can do to protect your server more?</strong>
</p>

<p>
	Actually yes. Since trigger(Client)ServerEvent is a function which calls a counter-side functions (and pass data to it) it's affecting traffic and CPU. It should be well maintained (element data isn't exception). If you do not understand events then feel free to check IIYAMA's <a href="https://forum.multitheftauto.com/topic/114541-tut-events/" rel="">events tutorial</a>, while he explains basics i will be expanding this by showing how you can reduce calls and optimise passing data between sides, because triggers are main component of my data system. We'll be moving step by step from easier to a bit harder topics, here comes our first step.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Client-side delays</span></strong>
</p>

<p>
	As i mentioned before that triggers should be well maintained, we should add some delay for client-side, which will be a obstacle for someone, who'd try to spam server with triggerServerEvent calls. It's easily achievable with getTickCount function.<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="com">--[[
/***************************************************
	Client
***************************************************\
]]</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> dataToPass </span><span class="pun">=</span><span class="pln"> </span><span class="str">"string"</span><span class="pln"> </span><span class="com">-- data we want pass to server</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> lastTriggerCall </span><span class="pun">=</span><span class="pln"> getTickCount</span><span class="pun">()</span><span class="pln"> </span><span class="com">-- store last trigger call</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> delayValue </span><span class="pun">=</span><span class="pln"> </span><span class="lit">500</span><span class="pln"> </span><span class="com">-- ms</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> triggerEventByCommand</span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> getTickCount</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lastTriggerCall </span><span class="pun">&gt;=</span><span class="pln"> delayValue </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- if delay has passed</span><span class="pln">
		triggerServerEvent</span><span class="pun">(</span><span class="str">"onServerEvent"</span><span class="pun">,</span><span class="pln"> localPlayer</span><span class="pun">,</span><span class="pln"> dataToPass</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- trigger server event</span><span class="pln">
		lastTriggerCall </span><span class="pun">=</span><span class="pln"> getTickCount</span><span class="pun">()</span><span class="pln"> </span><span class="com">-- update last trigger call</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addCommandHandler</span><span class="pun">(</span><span class="str">"trigger"</span><span class="pun">,</span><span class="pln"> triggerEventByCommand</span><span class="pun">)</span><span class="pln">

</span><span class="com">--[[
/***************************************************
	Server
***************************************************\
]]</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> onServerEvent</span><span class="pun">(</span><span class="pln">pData</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> client </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- check whether client exists (just for sake)</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> isString </span><span class="pun">=</span><span class="pln"> type</span><span class="pun">(</span><span class="pln">pData</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"string"</span><span class="pln"> </span><span class="com">-- make sure that is string</span><span class="pln">

		</span><span class="kwd">if</span><span class="pln"> isString </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- if so</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> validLength </span><span class="pun">=</span><span class="pln"> </span><span class="pun">#</span><span class="pln">pData </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="com">-- check whether is less or equal to 4 chars</span><span class="pln">

			</span><span class="kwd">if</span><span class="pln"> validLength </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- if so</span><span class="pln">
				print</span><span class="pun">(</span><span class="str">"The checks have passed... Processing code."</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addEvent</span><span class="pun">(</span><span class="str">"onServerEvent"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
addEventHandler</span><span class="pun">(</span><span class="str">"onServerEvent"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> onServerEvent</span><span class="pun">)</span></pre>

<p>
	You can also implement same delay checks on server-side, but i believe that client-side should be sufficient.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Selecting lowest possible source element for trigger</span></strong>
</p>

<p>
	Probably many of you (including myself), have passed root or resourceRoot as a <strong>2-nd</strong>/<strong>3-rd </strong>argument in function:
</p>

<div style="background-color:#cc3333;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">triggerServerEvent ( string event, <strong>element theElement</strong>, [arguments...] )</span>
	</p>
</div>

<div style="background-color:#FFA500;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">triggerClientEvent ( [ table/element sendTo = getRootElement(), ] string name, <strong>element sourceElement</strong> [, arguments... ] )</span>
	</p>
</div>

<p>
	That shouldn't be done, unless you know what you are doing. Because of CPU impact which wiki states on <a href="https://wiki.multitheftauto.com/wiki/TriggerServerEvent" rel="external nofollow">client</a> and <a href="https://wiki.multitheftauto.com/wiki/TriggerClientEvent" rel="external nofollow">server</a> variation. Most of people (once again, including myself) misunderstood this note. Which is not about attaching custom events to root, but about passing it to trigger itself. While resourceRoot is lower than root in <a href="https://wiki.multitheftauto.com/wiki/Element_tree" rel="external nofollow">element tree</a>, you should use <strong>localPlayer </strong>instead - on client-side. When it comes to server-side you can also use same player which triggered certain event, as for example this is handled similarly in <a href="https://github.com/majqqq/custom-data/blob/main/custom_data/SElementData.lua#L190" rel="external nofollow">server-side part of custom data.</a> But i do also check if <strong>sourceElement</strong> (<strong>pSyncer</strong>) is actual element to avoid warnings. We could say that <strong>attachedTo</strong> is some kind of filter which checks if <strong>sourceElement </strong>which triggered certain event is allowed (depending on it's position in element tree) to process the function. But you've should already know that if you read events tutorial.
</p>

<div style="background-color:#3399ff;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;">addEventHandler ( string eventName, <strong>element attachedTo</strong>, function handlerFunction [, bool propagate = true, string priority = "normal" ] )</span>
	</p>
</div>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Optimising data flow</span></strong>
</p>

<p>
	First and foremost my favourite way - <strong>batching</strong>. What is it, why and when you should use it? Batching is a process when you place data in certain queue, this data however isn't synced instantly, it's stored at server-side in additional table, till force sync will be called (forceBatchDataSync). This is different scenario when we compare it to <a href="https://wiki.multitheftauto.com/wiki/SetElementData" rel="external nofollow">element data</a>, while <a href="https://github.com/majqqq/custom-data" rel="external nofollow">custom data</a> with batching enabled sends pack of data in <strong>1 </strong>trigger (<strong>1 queue = 1 trigger)</strong>, element data sends <strong>each (!)</strong> data separately. In other words, you can do <strong>x100</strong> setCustomData and they will be sent with <strong>1 trigger</strong>, while <strong>x100</strong> setElementData waste a lot of traffic and CPU by doing that separately. Generally you should use it always when you set more than one data.
</p>

<p>
	Practical example, setting data upon spawning vehicle:<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">local</span><span class="pln"> dataTable </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{{</span><span class="str">"Data 1"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Value 1"</span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="str">"Data 2"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Value 2"</span><span class="pun">}}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> spawnInfernus</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> playerType </span><span class="pun">=</span><span class="pln"> getElementType</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"player"</span><span class="pln"> </span><span class="com">-- check if it's player</span><span class="pln">

	</span><span class="kwd">if</span><span class="pln"> playerType </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- if so</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> dataPack </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="com">-- store it for later reuse</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> dataName </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="com">-- store it for later reuse</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> dataValue </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="com">-- store it for later reuse</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> playerX</span><span class="pun">,</span><span class="pln"> playerY</span><span class="pun">,</span><span class="pln"> playerZ </span><span class="pun">=</span><span class="pln"> getElementPosition</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- get player position</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> infernusElement </span><span class="pun">=</span><span class="pln"> createVehicle</span><span class="pun">(</span><span class="lit">411</span><span class="pun">,</span><span class="pln"> playerX </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> playerY</span><span class="pun">,</span><span class="pln"> playerZ</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- create vehicle</span><span class="pln">

		</span><span class="kwd">for</span><span class="pln"> dataID </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">dataTable </span><span class="kwd">do</span><span class="pln"> </span><span class="com">-- loop through data table</span><span class="pln">
			dataPack </span><span class="pun">=</span><span class="pln"> dataTable</span><span class="pun">[</span><span class="pln">dataID</span><span class="pun">]</span><span class="pln"> </span><span class="com">-- get data at certain index</span><span class="pln">
			dataName </span><span class="pun">=</span><span class="pln"> dataPack</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="com">-- get data name</span><span class="pln">
			dataValue </span><span class="pun">=</span><span class="pln"> dataPack</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="com">-- get data value</span><span class="pln">

			setCustomData</span><span class="pun">(</span><span class="pln">infernusElement</span><span class="pun">,</span><span class="pln"> dataName</span><span class="pun">,</span><span class="pln"> dataValue</span><span class="pun">,</span><span class="pln"> </span><span class="str">"synced"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> pPlayer</span><span class="pun">,</span><span class="pln"> </span><span class="str">"spawn_infernus"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"queue_spawn_infernus"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
			</span><span class="com">-- set data for vehicle, with specified name and value, with type "synced", receivers false, pPlayer as syncer, "spawn_infernus" as event name and queue "queue_spawn_infernus" with timeout -1 (batch)</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">

		forceBatchDataSync</span><span class="pun">(</span><span class="str">"queue_spawn_infernus"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"synced"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- force "queue_spawn_infernus" to sync from "synced" type</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addCommandHandler</span><span class="pun">(</span><span class="str">"spawninfernus"</span><span class="pun">,</span><span class="pln"> spawnInfernus</span><span class="pun">)</span></pre>

<p>
	Second way is using <strong>buffer</strong>, the <strong>difference</strong> between previous technique is that instead awaiting synchronization we create a timer which collects pack of data with given delay. Using it also results in data reduction, because calls are reduced. You can apply it to data which is being changed by multiple players, or in different scenario where you'd want to collect various data and sync them in same queue, i'll also include handy code by <a contenteditable="false" data-ipshover="" data-ipshover-target="https://forum.multitheftauto.com/profile/27939-iiyama/?do=hovercard" data-mentionid="27939" href="https://forum.multitheftauto.com/profile/27939-iiyama/" rel="">@IIYAMA</a> which would help you adjust your delay.<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">local</span><span class="pln"> sendingDelay </span><span class="pun">=</span><span class="pln"> </span><span class="lit">100</span><span class="pln"> </span><span class="com">-- ms</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> fps </span><span class="pun">=</span><span class="pln"> </span><span class="lit">60</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> timeSlice </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">/</span><span class="pln">fps
</span><span class="kwd">local</span><span class="pln"> dataReduction </span><span class="pun">=</span><span class="pln"> sendingDelay</span><span class="pun">/</span><span class="pln">timeSlice

print</span><span class="pun">(</span><span class="str">"~"</span><span class="pun">..(</span><span class="pln">dataReduction </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)..</span><span class="str">" x times LESS per "</span><span class="pun">..</span><span class="pln">sendingDelay</span><span class="pun">..</span><span class="str">" ms."</span><span class="pun">)</span></pre>

<p>
	An simple buffer example:<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> bufferExample</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> playerType </span><span class="pun">=</span><span class="pln"> getElementType</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"player"</span><span class="pln"> </span><span class="com">-- check if it's player</span><span class="pln">

	</span><span class="kwd">if</span><span class="pln"> playerType </span><span class="kwd">then</span><span class="pln"> </span><span class="com">-- if so</span><span class="pln">
		</span><span class="kwd">local</span><span class="pln"> bufferChanges </span><span class="pun">=</span><span class="pln"> getCustomData</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Buffer changes"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> pPlayer</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="com">-- get changes for this data</span><span class="pln">

		setCustomData</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Buffer changes"</span><span class="pun">,</span><span class="pln"> bufferChanges </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> pPlayer</span><span class="pun">,</span><span class="pln"> pPlayer</span><span class="pun">,</span><span class="pln"> </span><span class="str">"buffer_change"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"queue_buffer_change"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3000</span><span class="pun">)</span><span class="pln">

		bufferChanges </span><span class="pun">=</span><span class="pln"> getCustomData</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Buffer changes"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> pPlayer</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- get once again changes for this data</span><span class="pln">

		outputChatBox</span><span class="pun">(</span><span class="str">"Data has changed for player: "</span><span class="pun">..</span><span class="pln">getPlayerName</span><span class="pun">(</span><span class="pln">pPlayer</span><span class="pun">)..</span><span class="str">" -&gt; Buffer changes: "</span><span class="pun">..</span><span class="pln">bufferChanges</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addCommandHandler</span><span class="pun">(</span><span class="str">"buffertest"</span><span class="pun">,</span><span class="pln"> bufferExample</span><span class="pun">)</span></pre>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Data handlers - awesome addition</span></strong>
</p>

<p>
	Meet <strong>data handlers</strong>, equivalent of onClientElementDataChange, those are your own custom functions which could be attached to certain element, data type, key, and event.<br />
	Once the function is triggered, it provides set of useful parameters which could be used inside function scope, this is another feature which makes this data system powerful.<br />
	For examples, we'll refer to previously set data with batch and buffer.<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted"><span class="kwd">function</span><span class="pln"> onClientInternusDataChange</span><span class="pun">(</span><span class="pln">pElement</span><span class="pun">,</span><span class="pln"> pKey</span><span class="pun">,</span><span class="pln"> pType</span><span class="pun">,</span><span class="pln"> pOldValue</span><span class="pun">,</span><span class="pln"> pNewValue</span><span class="pun">,</span><span class="pln"> pEvent</span><span class="pun">,</span><span class="pln"> pSyncer</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> pSyncer </span><span class="pun">==</span><span class="pln"> localPlayer </span><span class="kwd">then</span><span class="pln">
		print</span><span class="pun">(</span><span class="str">"I am syncer of this data! At event: "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pEvent</span><span class="pun">))</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">

	print</span><span class="pun">(</span><span class="str">"Key: "</span><span class="pun">..</span><span class="pln">pKey</span><span class="pun">..</span><span class="str">" ("</span><span class="pun">..</span><span class="pln">pType</span><span class="pun">..</span><span class="str">") has changed: "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pOldValue</span><span class="pun">)..</span><span class="str">" -&gt; "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pNewValue</span><span class="pun">))</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addDataHandler</span><span class="pun">(</span><span class="str">"vehicle"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> </span><span class="pun">{},</span><span class="pln"> onClientInternusDataChange</span><span class="pun">,</span><span class="pln"> </span><span class="str">"spawn_infernus"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- requirements to trigger function: element needs to be vehicle, any data type and key name can trigger this, event needs to be equal to "spawn_infernus"</span><span class="pln">

</span><span class="com">--[[
/***************************************************

***************************************************\
]]</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> onClientBufferChange</span><span class="pun">(</span><span class="pln">pElement</span><span class="pun">,</span><span class="pln"> pKey</span><span class="pun">,</span><span class="pln"> pType</span><span class="pun">,</span><span class="pln"> pOldValue</span><span class="pun">,</span><span class="pln"> pNewValue</span><span class="pun">,</span><span class="pln"> pEvent</span><span class="pun">,</span><span class="pln"> pSyncer</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> pSyncer </span><span class="pun">==</span><span class="pln"> localPlayer </span><span class="kwd">then</span><span class="pln">
		print</span><span class="pun">(</span><span class="str">"I am syncer of this data! At event: "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pEvent</span><span class="pun">))</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">

	print</span><span class="pun">(</span><span class="str">"Key: "</span><span class="pun">..</span><span class="pln">pKey</span><span class="pun">..</span><span class="str">" ("</span><span class="pun">..</span><span class="pln">pType</span><span class="pun">..</span><span class="str">") has changed: "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pOldValue</span><span class="pun">)..</span><span class="str">" -&gt; "</span><span class="pun">..</span><span class="pln">tostring</span><span class="pun">(</span><span class="pln">pNewValue</span><span class="pun">))</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addDataHandler</span><span class="pun">(</span><span class="str">"player"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Buffer changes"</span><span class="pun">,</span><span class="pln"> onClientBufferChange</span><span class="pun">,</span><span class="pln"> </span><span class="str">"buffer_change"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- requirements to trigger function: element needs to be player, data type == "private" and key name == "Buffer changes" can trigger this, event needs to be equal to "buffer_change"</span></pre>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">How to use it?</span></strong>
</p>

<p>
	Download latest version, and add it directly to your gamemode, to use functions directly or leave it as a separate resource to use functions with exports. First option gives best performance, and allows you to use data handlers. Make sure that player parent isn't changed, in order for server-side to work correctly.
</p>

<div>
	<hr />
</div>

<p>
	<strong><span style="font-size:22px;">Efficiency test</span></strong>
</p>

<div style="background-color:#3366cc;border:solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<p>
		<span style="color:#000000;"><strong>Element data &amp; Custom data in 100000 iterations (client-side, sync off)</strong></span>
	</p>

	<p>
		<span style="color:#000000;"><strong>Set local data:</strong></span>
	</p>

	<p>
		<span style="color:#000000;">ED: 31 ms <strong>&lt;</strong> CD: <strong>17 ms</strong></span>
	</p>

	<p>
		<span style="color:#000000;"><strong>Get local data by key:</strong></span>
	</p>

	<p>
		<span style="color:#000000;">ED: 19 ms <strong>&lt;</strong> CD: <strong>9 ms</strong></span>
	</p>

	<p>
		<span style="color:#000000;"><strong>Get all local data:</strong></span>
	</p>

	<p>
		<span style="color:#000000;">ED: n/a <strong>&lt;</strong> CD: <strong>10 ms</strong></span>
	</p>
</div>
]]></description><guid isPermaLink="false">127520</guid><pubDate>Mon, 05 Oct 2020 12:11:12 +0000</pubDate></item><item><title>Sublime Text 3 - 50p's MTA Editor (package) UPDATE 1.5.7</title><link>https://forum.multitheftauto.com/topic/123500-sublime-text-3-50ps-mta-editor-package-update-157/</link><description><![CDATA[<p>
	<a href="https://github.com/Vadya963/50pSublimeText3Package" rel="external nofollow">https://github.com/Vadya963/50pSublimeText3Package</a> download from here<br>
	<br>
	you can read how to install it below
</p>
<iframe allowfullscreen="" data-embedauthorid="1687" data-embedcontent="" data-embedid="embed425536525" scrolling="no" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:278px;max-width:502px;" data-embed-src="https://forum.multitheftauto.com/topic/66760-sublime-text-3-50ps-mta-editor-package/?tab=comments&amp;do=embed&amp;comment=622040&amp;embedComment=622040&amp;embedDo=findComment#comment-622040"></iframe>

<p>
	 
</p>
]]></description><guid isPermaLink="false">123500</guid><pubDate>Tue, 07 Apr 2020 19:56:10 +0000</pubDate></item><item><title>[TUT] addEventHandler on a group of elements. (Small tutorial)</title><link>https://forum.multitheftauto.com/topic/100069-tut-addeventhandler-on-a-group-of-elements-small-tutorial/</link><description><![CDATA[<div data-controller="core.front.core.articlePages">
	<div data-role="contentPage">
		<p>
			<span style="font-size:36px;">addEventHandler + group elements</span>
		</p>

		<p>
			I noticed that some people like to add 1000<span style="font-size:12px;">0000000</span><span style="font-size:8px;">000000</span> addEventHandlers for each element, while you probably only need 1 addEventHandler.
		</p>

		<div data-role="contentPage">
			<p>
				 
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak"></div>

		<p>
			 
		</p>

		<p>
			<span style="font-size:24px;">Using <strong>ONE</strong> addEventHandler on a <strong>group of elements</strong>?</span>
		</p>

		<p>
			<strong>Answer:</strong>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> group </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/createElement" rel="external nofollow">createElement</a></span></span><span class="pun">(</span><span class="str">"groupMyCutePeds"</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- Create a custom element and save it in to the variable &lt;group&gt;.</span><span class="pln">



</span><span class="com">-- Create 3 peds.</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> ped1 </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/createPed" rel="external nofollow">createPed</a></span></span><span class="pun">(</span><span class="lit">120</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5540.6654</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1020.55122</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1240.545</span><span class="pun">)</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> ped2 </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/createPed" rel="external nofollow">createPed</a></span></span><span class="pun">(</span><span class="lit">120</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5541.6654</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1021.55122</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1240.545</span><span class="pun">)</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> ped3 </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/createPed" rel="external nofollow">createPed</a></span></span><span class="pun">(</span><span class="lit">120</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5542.6654</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1022.55122</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1240.545</span><span class="pun">)</span><span class="pln">


</span><span class="com">-- Set the parent of the 3 peds.</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/setElementParent" rel="external nofollow">setElementParent</a></span></span><span class="pun">(</span><span class="pln">ped1</span><span class="pun">,</span><span class="pln"> group</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/setElementParent" rel="external nofollow">setElementParent</a></span></span><span class="pun">(</span><span class="pln">ped2</span><span class="pun">,</span><span class="pln"> group</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/setElementParent" rel="external nofollow">setElementParent</a></span></span><span class="pun">(</span><span class="pln">ped3</span><span class="pun">,</span><span class="pln"> group</span><span class="pun">)</span><span class="pln">



</span><span class="com">-- Add an addEventHandler and use the &lt;group&gt; as &lt;attachedTo&gt; element.</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onPedWasted" rel="external nofollow">onPedWasted</a></span>"</span><span class="pun">,</span><span class="pln"> group</span><span class="pun">,</span><span class="pln"> </span><span class="com">-- "onPedWasted" = serverside. "onClientPedWasted" = clientside.</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"One of my cute peds just died. ;'( No exceptions!"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span></pre>

		<p>
			Code is untested, but the method is tested.<br>
			 
		</p>

		<p>
			 
		</p>

		<div data-role="contentPage">
			<p>
				 
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak"></div>

		<p>
			<span style="font-size:24px;">Syntax for functions in example</span>
		</p>

		<p>
			<a href="https://wiki.multitheftauto.com/wiki/CreateElement" rel="external nofollow">createElement syntax</a>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/element" rel="external nofollow">element</a></span> <span><a href="https://wiki.multitheftauto.com/wiki/createElement" rel="external nofollow">createElement</a></span> </span><span class="pun">(</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> elementType</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> elementID </span><span class="pun">=</span><span class="pln"> </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span></pre>

		<p>
			 
		</p>

		<p>
			<a href="https://wiki.multitheftauto.com/wiki/SetElementParent" rel="external nofollow">setElementParent syntax</a>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/bool" rel="external nofollow">bool</a></span> <span><a href="https://wiki.multitheftauto.com/wiki/setElementParent" rel="external nofollow">setElementParent</a></span> </span><span class="pun">(</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/element" rel="external nofollow">element</a></span> theElement</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/element" rel="external nofollow">element</a></span> parent </span><span class="pun">)</span><span class="pln">  </span></pre>

		<p>
			 
		</p>

		<p>
			<a href="https://wiki.multitheftauto.com/wiki/AddEventHandler" rel="external nofollow">addEventHandler syntax</a>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/bool" rel="external nofollow">bool</a></span> <span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span> </span><span class="pun">(</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> eventName</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/element" rel="external nofollow">element</a></span> attachedTo</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> handlerFunction</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/bool" rel="external nofollow">bool</a></span> getPropagated </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span> priority </span><span class="pun">=</span><span class="pln"> </span><span class="str">"normal"</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span></pre>

		<p>
			<strong><span style="color:#c0392b;">DO NOT disable getPropagated</span></strong>
		</p>

		<div style="background-color:#FF0000;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
			<p>
				<span style="color:#ffffff;"><b>getPropagated:</b> A boolean representing whether the handler will be triggered if the event was propagated down or up the </span><a href="https://wiki.multitheftauto.com/wiki/Element_tree" rel="external nofollow" title="Element tree"><span style="color:#ffffff;">element tree</span></a><span style="color:#ffffff;"> (starting from the source), and not triggered directly on attachedTo (that is, handlers attached with this argument set to <i>false</i> will only be triggered if <i>source == this</i>).</span>
			</p>
		</div>

		<p>
			If you disable this, children of the &lt;group&gt; element are <strong>not included</strong>.
		</p>

		<p>
			 
		</p>

		<div data-role="contentPage">
			 
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak"></div>

		<p>
			 
		</p>

		<p>
			<span style="font-size:24px;">Make use of the element tree</span>
		</p>

		<div style="border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
			<p>
				<img alt="Tre.png" class="ipsImage" height="408" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" width="511" data-src="https://wiki.multitheftauto.com/images/b/b3/Tre.png"></p>

			<p>
				 
			</p>

			<p>
				<a href="https://wiki.multitheftauto.com/wiki/Element_tree" rel="external nofollow">Element tree</a>
			</p>

			<p>
				 
			</p>

			<p>
				<strong>For applying addEventHandlers to elements created by the resource:</strong>
			</p>

			<p>
				Use: <a href="https://forum.multitheftauto.com/topic/33407-list-of-predefined-variables/" rel="">resourceRoot</a> / <a href="https://wiki.multitheftauto.com/wiki/GetResourceRootElement" rel="external nofollow">getResourceRootElement</a>
			</p>

			<p>
				 
			</p>

			<p>
				<strong>For applying addEventHandlers to elements created by scripts of the resource:</strong>
			</p>

			<p>
				Use: <a href="https://wiki.multitheftauto.com/wiki/GetResourceDynamicElementRoot" rel="external nofollow">getResourceDynamicElementRoot</a>
			</p>

			<p>
				 
			</p>

			<p>
				<strong>For applying addEventHandlers to elements created by maps of the resource:</strong>
			</p>

			<p>
				Use: <a href="https://wiki.multitheftauto.com/wiki/GetResourceMapRootElement" rel="external nofollow">getResourceMapRootElement</a>
			</p>
		</div>

		<p>
			 
		</p>
		 

		<div data-role="contentPage">
			<p>
				 
			</p>
		</div>

		<div data-role="contentPage">
			<hr data-role="contentPageBreak"></div>

		<p>
			 
		</p>

		<p>
			<span style="color:#f39c12;">I hope your code will be without... </span>
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">print</span><span class="pun">(</span><span class="lit">10</span><span class="pun">^</span><span class="lit">10</span><span class="pun">^</span><span class="lit">10</span><span class="pun">^</span><span class="lit">10</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- Print here: https://www.lua.org/cgi-bin/demo</span></pre>

		<p>
			<span style="color:#f39c12;">...addEventHandlers in the future. </span><img alt=":cheers:" data-emoticon="" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" title=":cheers:" data-src="https://forum.multitheftauto.com/uploads/emoticons/icon_cheers.gif.005365b4d0b5d2f95d1b2f88dfd30044.gif"></p>

		<p>
			 
		</p>

		<p>
			 
		</p>
	</div>
</div>]]></description><guid isPermaLink="false">100069</guid><pubDate>Mon, 02 Oct 2017 11:59:25 +0000</pubDate></item><item><title><![CDATA[VM Player in MTA:SA - Setup & use]]></title><link>https://forum.multitheftauto.com/topic/125809-vm-player-in-mtasa-setup-use/</link><description><![CDATA[<p>
	 
</p>

<p style="text-align:center;">
	<img alt="اهداء الى اخوي الغالي |اكستريم هكر:$ | صقور الإبدآع" data-ratio="63.64" style="height:auto;" width="550" data-src="https://hostr.co/file/970/YOsL3NFI97gi/97865.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
</p>

<p>
	 
</p>

<p style="text-align:center;">
	<span style="font-size:18px;"><strong>Our explanation today is about how to play the MTV game</strong></span>
</p>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>The first Windows 7 version is .IOS version</strong></span>
</p>

<p style="text-align:center;">
	<b>how to download <span style="color:#c0392b;">Windows_7.ios</span> <span><span>:</span></span></b>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p style="text-align:right;">
			<strong><span style="font-size:20px;">For purchase: Enter the official website of a page from the <a href="http://microsoft.com" rel="external nofollow">Microsoft</a> website.</span></strong>
		</p>
	</div>
</blockquote>

<p style="text-align:right;">
	<strong><span style="font-size:18px;">The second thing you download VMware Workstation 15 Player</span></strong>
</p>

<p style="text-align:center;">
	<strong><span style="font-size:18px;">how to download<span style="color:#c0392b;"> VMware Workstation 15 Player </span></span></strong>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p style="text-align:right;">
			<strong><span style="font-size:20px;">The first thing you log into is the <a href="https://www.vmware.com/" rel="external nofollow">vmware </a>application site</span></strong><br>
			 
		</p>

		<p style="text-align:center;">
			<img alt="spacer.png" class="ipsImage" data-ratio="45.47" height="454" style="height:auto;" width="1000" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727197229747535941/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png"><br>
			 
		</p>

		<p style="text-align:right;">
			The second thing is to click on Products and then choose Personal Desktop and then <a href="https://www.vmware.com/products/workstation-player.html" rel="external nofollow">Workstation Player</a><img alt="spacer.png" class="ipsImage" data-ratio="32.84" height="328" style="height:auto;" width="1000" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727199529384018070/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>

		<p>
			<span style="font-size:20px;"><b>then click down</b></span>
		</p>

		<p style="text-align:center;">
			<img alt="spacer.png" class="ipsImage" data-ratio="11.44" height="114" style="height:auto;" width="1000" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727202859623645235/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>

		<p>
			<span style="font-size:20px;"><b>if link is don't work then you we have to <a href="https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html" rel="external nofollow">https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html</a></b></span>
		</p>

		<p style="text-align:center;">
			<img alt="spacer.png" class="ipsImage" data-ratio="38.70" height="386" style="height:auto;" width="1000" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727203117774536754/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>

		<p style="text-align:right;">
			<font color="#c0392b"><b>installation it's normally</b></font>
		</p>
	</div>
</blockquote>

<p>
	<strong><span style="font-size:18px;">Fourth way to install in the windows_7_ios program <span>:</span></span></strong>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			<strong><span style="font-size:18px;">The first time you open the program, this interface will show you</span></strong>
		</p>

		<p>
			<img alt="spacer.png" class="ipsImage" data-ratio="80.20" height="559" style="height:auto;" width="697" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727206439218839562/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>

		<p>
			<b>learn with video</b>
		</p>

		<p style="text-align:center;">
			<iframe frameborder="0" height="270" width="480" data-embed-src="https://www.youtube.com/embed/TDKZ6QVHmsU"></iframe><br>
			<b>when installation end then restart VM player</b>
		</p>

		<p>
			 
		</p>
	</div>
</blockquote>

<p style="text-align:center;">
	<strong><span style="font-size:18px;">how to download <span style="color:#330099;">Grand Theft Auto San Andreas</span> <span>:</span></span></strong><br>
	 
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			You can buy it from Steam platform or any other platform
		</p>
	</div>
</blockquote>

<p>
	<strong>How to transform game from your pc to VM Host <span>:</span></strong>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			<iframe frameborder="0" height="600" style="color:#000000;font-size:medium;text-align:right;" width="800" data-embed-src="https://www.youtube.com/embed/TdyZh36UAeA"></iframe>
		</p>

		<p>
			<strong>After you download the tools, copy and paste the game to the desktop<br>
			Then do a spin if it is turned on or not</strong>
		</p>

		<p>
			<strong>Display &lt;-Settings and press OK</strong>
		</p>

		<p>
			<img alt="unknown.png?width=489&amp;height=473" data-ratio="96.73" style="height:auto;" width="489" data-src="https://media.discordapp.net/attachments/330407145084551168/727269014325428345/unknown.png?width=489&amp;height=473" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>
	</div>
</blockquote>

<p>
	<strong> Multi theft auto san download <span>:</span></strong>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<strong>the first thing that goes to the game site <a href="http://MTASA.com" rel="external nofollow">MTASA.com</a></strong>
				</p>

				<p>
					<img alt="unknown.png?width=730&amp;height=473" data-ratio="64.79" style="height:auto;" width="730" data-src="https://media.discordapp.net/attachments/330407145084551168/727271235687284917/unknown.png?width=730&amp;height=473" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
				</p>
			</div>
		</blockquote>

		<p>
			 
		</p>
	</div>
</blockquote>

<p>
	<b>How to use</b>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			<strong>After the download is completed, do not run the game, restart the host<br>
			And then open the game on your device after you open it. You go to the host and run the game, God willing, and its bounty will work</strong><br>
			<img alt="spacer.png" class="ipsImage" data-ratio="50.84" height="508" style="height:auto;" width="1000" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727279560269365268/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
		</p>
	</div>
</blockquote>

<p>
	<strong><span><span><span><span> </span>problems and solutions :</span></span></span></strong>
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			<strong><span style="font-size:18px;">Some problems that you encounter during installation:</span></strong>
		</p>

		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<span style="font-size:18px;"><strong>The game does not run on XP, VISTA operating system<br>
					The solution :<br>
					Download top versions of win7 +</strong></span>
				</p>
			</div>
		</blockquote>

		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<strong>Poor performance and difficulty moving the mousse<br>
					The solution<br>
					HOST RAM put a quarter of the RAM device<br>
					8 -&gt; [2-3.25]</strong>
				</p>
			</div>
		</blockquote>

		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<strong><span style="font-size:18px;">The host does not connect to the Internet<br>
					The solution</span></strong>
				</p>

				<p>
					<iframe frameborder="0" height="600" width="800" data-embed-src="https://www.youtube.com/embed/AsSDXznIhGc"></iframe>
				</p>

				<p>
					<strong>in WIND7</strong><br>
					<img alt="spacer.png" class="ipsImage" data-ratio="98.28" height="687" style="height:auto;" width="699" data-src="https://cdn.discordapp.com/attachments/330407145084551168/727281602765258822/unknown.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png">
				</p>

				<p>
					 
				</p>
			</div>
		</blockquote>

		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<b style="font-size:18px;">give </b><b>ownership</b><br>
					<b style="font-size:18px;">The solution</b>
				</p>

				<p>
					<iframe frameborder="0" height="600" width="800" data-embed-src="https://www.youtube.com/embed/LuQgFiHoyKk"></iframe>
				</p>

				<p>
					 
				</p>

				<p>
					 
				</p>
			</div>
		</blockquote>

		<blockquote class="ipsQuote" data-ipsquote="">
			<div class="ipsQuote_citation">
				Quote
			</div>

			<div class="ipsQuote_contents">
				<p>
					<strong>MTA Serial inviable<br>
					The solution<br>
					The game looked at the computer, then it got lost in the host</strong>
				</p>
			</div>
		</blockquote>
	</div>
</blockquote>

<p>
	<strong>I hope you will support the channel because a relative is going to download a clip explaining in detail how to carry it and install it.<br>
	<a href="https://www.youtube.com/channel/UCVRgdhrC6ZkSJnzkt32c6BQ?view_as=subscriber" rel="external nofollow">MRPOP:)</a><br>
	Peace is a good conclusion</strong>
</p>
]]></description><guid isPermaLink="false">125809</guid><pubDate>Mon, 29 Jun 2020 22:33:51 +0000</pubDate></item><item><title>Tarantool: use case and workaround</title><link>https://forum.multitheftauto.com/topic/131195-tarantool-use-case-and-workaround/</link><description><![CDATA[<p>
	<strong><span style="font-size:18px;">Part 0; Preamble</span></strong>
</p>

<p>
	At the moment we have a long discussion about databases in the MTA Community, a huge part of the Team thinks that DB-drivers must be only as modules, but right now, we have only RDBMS databases(SQLite and MySQL). It isn’t enough for many dynamic MTA servers.
</p>

<p>
	So, I want to suggest an interesting solution to this problem, so let’s get started!
</p>

<p>
	 
</p>

<p>
	<strong><span style="font-size:18px;">Part 1; Tarantool</span></strong>
</p>

<p>
	When we think about <a href="https://en.wikipedia.org/wiki/Document-oriented_database" rel="external nofollow">DODBMS</a> the first variant of this is MongoDB. MongoDB works well with JS, like nodejs, but I want to present to you the <a href="https://en.wikipedia.org/wiki/Document-oriented_database" rel="external nofollow">DODBMS</a> which work with Lua. 
</p>

<p>
	This database is sometimes similar to MongoDB, but it works only with Lua(and SQL but I don’t get it). You can put the data there, get it, and write functions. Cool! And this DBMS is used in <a href="https://www.tarantool.io/en/cases/" rel="external nofollow">production</a>, the developer of this DB is MailRu Group, so, take my word for it, these clients are serious guys, especially MasterCard.
</p>

<p>
	<span style="font-size:18px;"><strong>Part 1.1: Setting and installing Tarantool</strong></span>
</p>

<p>
	<a href="https://www.tarantool.io/en/download/os-installation/debian/" rel="external nofollow">https://www.tarantool.io/en/download/os-installation/debian/</a>
</p>

<p>
	After installing launch the command `tarantool` and load global config with command  <strong>box.cfg{}</strong>
</p>

<p>
	 
</p>

<p>
	<strong><span style="font-size:18px;">Part 1.2: The space’s markup</span></strong>
</p>

<p>
	I'll try to make a managed alcohol list, so watch my hands
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- a sequence</span><span class="pln">
box</span><span class="pun">.</span><span class="pln">schema</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">.</span><span class="pln">create</span><span class="pun">(</span><span class="str">'drinks_seq'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> if_not_exists </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">})</span><span class="pln"> </span></pre>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- a space, like a table in MySQL</span><span class="pln">
box</span><span class="pun">.</span><span class="pln">schema</span><span class="pun">.</span><span class="pln">create_space</span><span class="pun">(</span><span class="str">'drinks'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> if_not_exists </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">={</span><span class="pln">

    </span><span class="pun">{</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'id'</span><span class="pun">,</span><span class="pln"> type </span><span class="pun">=</span><span class="pln"> </span><span class="str">'unsigned'</span><span class="pun">},</span><span class="pln">

    </span><span class="pun">{</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'name'</span><span class="pun">,</span><span class="pln"> type </span><span class="pun">=</span><span class="pln"> </span><span class="str">'string'</span><span class="pun">},</span><span class="pln">

    </span><span class="pun">{</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'count'</span><span class="pun">,</span><span class="pln"> type </span><span class="pun">=</span><span class="pln"> </span><span class="str">'unsigned'</span><span class="pun">}}</span><span class="pln">

</span><span class="pun">})</span><span class="pln"> </span></pre>

<p>
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- an index</span><span class="pln">
box</span><span class="pun">.</span><span class="pln">space</span><span class="pun">.</span><span class="pln">drinks</span><span class="pun">:</span><span class="pln">create_index</span><span class="pun">(</span><span class="str">'pk'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> parts </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">'id'</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> if_not_exists </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">})</span></pre>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- Insert 13 bottles of beer</span><span class="pln">
box</span><span class="pun">.</span><span class="pln">space</span><span class="pun">.</span><span class="pln">drinks</span><span class="pun">:</span><span class="pln">insert</span><span class="pun">{</span><span class="pln">box</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">.</span><span class="pln">drinks_seq</span><span class="pun">:</span><span class="pln">next</span><span class="pun">(),</span><span class="pln"> </span><span class="str">'Beer'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">}</span></pre>

<p>
	 
</p>

<p>
	That’s all, the cascade has done!
</p>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>Part 1.3: Fall in love workarounds</strong></span>
</p>

<p>
	Without spoilers, our workaround is <a href="https://wiki.multitheftauto.com/wiki/FetchRemote" rel="external nofollow">fetchRemote</a>, so, do the server.
</p>

<p>
	Any solution from: <a href="https://github.com/tarantool/http#installation" rel="external nofollow">https://github.com/tarantool/http#installation</a>
</p>

<p>
	 
</p>

<p>
	And take a look to my code:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pun">#!/</span><span class="pln">usr</span><span class="pun">/</span><span class="pln">bin</span><span class="pun">/</span><span class="pln">env tarantool
</span><span class="kwd">local</span><span class="pln"> http_router </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="str">'http.router'</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> http_server </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="str">'http.server'</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> json </span><span class="pun">=</span><span class="pln"> require</span><span class="pun">(</span><span class="str">'json'</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- Load default config</span><span class="pln">
box</span><span class="pun">.</span><span class="pln">cfg</span><span class="pun">{}</span><span class="pln">

</span><span class="com">-- Start the server</span><span class="pln">
</span><span class="com">-- WARNING: 0.0.0.0 listen the port for all interfaces, don't do it, use 127.0.0.1!</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> httpd </span><span class="pun">=</span><span class="pln"> http_server</span><span class="pun">.</span><span class="pln">new</span><span class="pun">(</span><span class="str">'0.0.0.0'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3820</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log_requests </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
    log_errors </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> router </span><span class="pun">=</span><span class="pln"> http_router</span><span class="pun">.</span><span class="pln">new</span><span class="pun">()</span><span class="pln">

</span><span class="com">-- GET endpoint, returns data from database</span><span class="pln">
router</span><span class="pun">:</span><span class="pln">route</span><span class="pun">({</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/drinks'</span><span class="pun">,</span><span class="pln"> method </span><span class="pun">=</span><span class="pln"> </span><span class="str">'GET'</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> 
    </span><span class="kwd">function</span><span class="pun">()</span><span class="pln">
        </span><span class="com">-- Load space</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> dspace </span><span class="pun">=</span><span class="pln"> box</span><span class="pun">.</span><span class="pln">space</span><span class="pun">.</span><span class="pln">drinks
        </span><span class="com">-- Select all, too risky read more about select and limits</span><span class="pln">
        </span><span class="com">-- Here: https://www.tarantool.io/en/doc/latest/reference/reference_lua/box_index/select/</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> drinks </span><span class="pun">=</span><span class="pln"> dspace</span><span class="pun">:</span><span class="pln">select</span><span class="pun">{}</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> json</span><span class="pun">.</span><span class="pln">encode</span><span class="pun">(</span><span class="pln">drinks</span><span class="pun">),</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">[</span><span class="str">'content-type'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'application/json; charset=utf8'</span><span class="pln"> </span><span class="pun">}}</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- PUT endpoint, add data to the database</span><span class="pln">
router</span><span class="pun">:</span><span class="pln">route</span><span class="pun">({</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/drinks'</span><span class="pun">,</span><span class="pln"> method </span><span class="pun">=</span><span class="pln"> </span><span class="str">'PUT'</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> 
    </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> dspace </span><span class="pun">=</span><span class="pln"> box</span><span class="pun">.</span><span class="pln">space</span><span class="pun">.</span><span class="pln">drinks
        </span><span class="com">-- [1] is https://github.com/multitheftauto/mtasa-blue/issues/1073</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">:</span><span class="pln">json</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
        </span><span class="com">-- box.sequence.drinks_seq:next() is auto-increment</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> drinks </span><span class="pun">=</span><span class="pln"> dspace</span><span class="pun">:</span><span class="pln">insert</span><span class="pun">{</span><span class="pln">box</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">.</span><span class="pln">drinks_seq</span><span class="pun">:</span><span class="pln">next</span><span class="pun">(),</span><span class="pln"> body</span><span class="pun">.</span><span class="pln">type</span><span class="pun">,</span><span class="pln"> tonumber</span><span class="pun">(</span><span class="pln">body</span><span class="pun">.</span><span class="pln">count</span><span class="pun">)}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> drinks </span><span class="kwd">then</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> json</span><span class="pun">.</span><span class="pln">encode</span><span class="pun">(</span><span class="pln">drinks</span><span class="pun">),</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">[</span><span class="str">'content-type'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'application/json; charset=utf8'</span><span class="pln"> </span><span class="pun">}}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> </span><span class="str">'{"status": "something went wrong"}'</span><span class="pun">,</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">[</span><span class="str">'content-type'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'application/json; charset=utf8'</span><span class="pln"> </span><span class="pun">}}</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- POST endpoint, edit the data in the database</span><span class="pln">
router</span><span class="pun">:</span><span class="pln">route</span><span class="pun">({</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="str">'/drinks'</span><span class="pun">,</span><span class="pln"> method </span><span class="pun">=</span><span class="pln"> </span><span class="str">'POST'</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> 
    </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> dspace </span><span class="pun">=</span><span class="pln"> box</span><span class="pun">.</span><span class="pln">space</span><span class="pun">.</span><span class="pln">drinks
        </span><span class="com">-- [1] is https://github.com/multitheftauto/mtasa-blue/issues/1073</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">:</span><span class="pln">json</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
        </span><span class="com">-- Well... Complicated thing (not much)</span><span class="pln">
        </span><span class="com">-- update(key, {{ = is assignment, number of field, value}, ...})</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> drinks </span><span class="pun">=</span><span class="pln"> dspace</span><span class="pun">:</span><span class="pln">update</span><span class="pun">(</span><span class="pln">tonumber</span><span class="pun">(</span><span class="pln">body</span><span class="pun">.</span><span class="pln">id</span><span class="pun">),</span><span class="pln"> </span><span class="pun">{{</span><span class="str">'='</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> tonumber</span><span class="pun">(</span><span class="pln">body</span><span class="pun">.</span><span class="pln">count</span><span class="pun">)}})</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> drinks </span><span class="kwd">then</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> json</span><span class="pun">.</span><span class="pln">encode</span><span class="pun">(</span><span class="pln">drinks</span><span class="pun">),</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">[</span><span class="str">'content-type'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'application/json; charset=utf8'</span><span class="pln"> </span><span class="pun">}}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> </span><span class="str">'{"status": "something went wrong"}'</span><span class="pun">,</span><span class="pln"> headers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">[</span><span class="str">'content-type'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'application/json; charset=utf8'</span><span class="pln"> </span><span class="pun">}}</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="pun">)</span><span class="pln">

httpd</span><span class="pun">:</span><span class="pln">set_router</span><span class="pun">(</span><span class="pln">router</span><span class="pun">)</span><span class="pln">
httpd</span><span class="pun">:</span><span class="pln">start</span><span class="pun">()</span></pre>

<p>
	 
</p>

<p>
	After that we have to start it.
</p>

<pre class="ipsCode">
cd /path/to/saved/script &amp;&amp; chmod +x ./server.lua &amp;&amp; ./server.lua</pre>

<p>
	 
</p>

<p>
	<strong><span style="font-size:18px;">Part 2.0: MTA resource</span></strong>
</p>

<p>
	The communication side will be simple command <em>drinks </em>with interactive options.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="str">"http://127.0.0.1:3820/drinks"</span><span class="pln">

</span><span class="com">-- GET endpoint</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> showDrinks</span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> sendOptions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		queueName </span><span class="pun">=</span><span class="pln"> </span><span class="str">"tarantool.drinks.get"</span><span class="pun">,</span><span class="pln">
		method </span><span class="pun">=</span><span class="pln"> </span><span class="str">"GET"</span><span class="pun">,</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> successRemote </span><span class="pun">=</span><span class="pln"> fetchRemote</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> sendOptions</span><span class="pun">,</span><span class="pln">
		</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">responseData</span><span class="pun">,</span><span class="pln"> responseInfo</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> error </span><span class="pun">=</span><span class="pln"> responseInfo</span><span class="pun">.</span><span class="pln">statusCode
			</span><span class="kwd">if</span><span class="pln"> error </span><span class="pun">==</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
				print </span><span class="pun">(</span><span class="pln">responseData</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">

	</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
</span><span class="com">-- PUT endpoint</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> addDrinks</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		type </span><span class="pun">=</span><span class="pln"> tostring</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]),</span><span class="pln">
		count </span><span class="pun">=</span><span class="pln"> tonumber</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> sendOptions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		queueName </span><span class="pun">=</span><span class="pln"> </span><span class="str">"tarantool.drinks.add"</span><span class="pun">,</span><span class="pln">
		postData </span><span class="pun">=</span><span class="pln"> toJSON</span><span class="pun">(</span><span class="pln">data</span><span class="pun">),</span><span class="pln">
		method </span><span class="pun">=</span><span class="pln"> </span><span class="str">"PUT"</span><span class="pun">,</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> successRemote </span><span class="pun">=</span><span class="pln"> fetchRemote</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> sendOptions</span><span class="pun">,</span><span class="pln">
		</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">responseData</span><span class="pun">,</span><span class="pln"> responseInfo</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> error </span><span class="pun">=</span><span class="pln"> responseInfo</span><span class="pun">.</span><span class="pln">statusCode
			</span><span class="kwd">if</span><span class="pln"> error </span><span class="pun">==</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
				print </span><span class="pun">(</span><span class="str">"Successfully added"</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">

	</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- POST endpoint</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> updateDrinks</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		id </span><span class="pun">=</span><span class="pln"> tonumber</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]),</span><span class="pln">
		count </span><span class="pun">=</span><span class="pln"> tonumber</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> sendOptions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		queueName </span><span class="pun">=</span><span class="pln"> </span><span class="str">"tarantool.drinks.update"</span><span class="pun">,</span><span class="pln">
		postData </span><span class="pun">=</span><span class="pln"> toJSON</span><span class="pun">(</span><span class="pln">data</span><span class="pun">),</span><span class="pln">
		method </span><span class="pun">=</span><span class="pln"> </span><span class="str">"POST"</span><span class="pun">,</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> successRemote </span><span class="pun">=</span><span class="pln"> fetchRemote</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> sendOptions</span><span class="pun">,</span><span class="pln">
		</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">responseData</span><span class="pun">,</span><span class="pln"> responseInfo</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> error </span><span class="pun">=</span><span class="pln"> responseInfo</span><span class="pun">.</span><span class="pln">statusCode
			</span><span class="kwd">if</span><span class="pln"> error </span><span class="pun">==</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
				print </span><span class="pun">(</span><span class="str">"Successfully updated"</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">end</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">

	</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- Command handler</span><span class="pln">
addCommandHandler</span><span class="pun">(</span><span class="str">"drinks"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ply</span><span class="pun">,</span><span class="pln"> cmd</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> arg </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{...}</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> subcmd </span><span class="pun">=</span><span class="pln"> arg</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
	</span><span class="com">-- subcmd is useless in the table</span><span class="pln">
	table</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">

	</span><span class="com">-- case/switch</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> subcmd </span><span class="pun">==</span><span class="pln"> </span><span class="str">'list'</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		showDrinks</span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">

	</span><span class="kwd">if</span><span class="pln"> subcmd </span><span class="pun">==</span><span class="pln"> </span><span class="str">'add'</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		addDrinks</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">

	</span><span class="kwd">if</span><span class="pln"> subcmd </span><span class="pun">==</span><span class="pln"> </span><span class="str">'update'</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		updateDrinks</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	And… That’s all. Look at the screenshot, it works!
</p>

<p>
	<img alt="image.png.e6a31f03ba006dcc715b510e21a799d6.png" class="ipsImage ipsImage_thumbnailed" data-fileid="89" data-ratio="50.00" style="height:auto;" width="960" data-src="https://forum.multitheftauto.com/uploads/monthly_2021_06/image.png.e6a31f03ba006dcc715b510e21a799d6.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
</p>

<p>
	 
</p>

<p>
	<strong>Conclusion</strong>: By the idea it must be simple only in resource without HTTP middleware, but at the moment it is impossible due to slow moving MTA progress, so if you like my tutorial and want to push my solution without middleware push <img src="https://twemoji.maxcdn.com/2/72x72/3f.png" class="ipsEmoji" alt="?"> and talk about it there.
</p>

<p>
	A solution without workaround: <a href="https://github.com/multitheftauto/mtasa-blue/issues/2208" rel="external nofollow">https://github.com/multitheftauto/mtasa-blue/issues/2208</a>
</p>
]]></description><guid isPermaLink="false">131195</guid><pubDate>Sun, 06 Jun 2021 19:15:47 +0000</pubDate></item><item><title>Software Rendering in MTA:SA Lua</title><link>https://forum.multitheftauto.com/topic/122576-software-rendering-in-mtasa-lua/</link><description><![CDATA[<p>
	Dear MTA community,
</p>

<p>
	I have been spending my last 8 weeks on mathematical problems. One of them is the 3D Frustum-Plane intersection that is used by GPUs to draw triangles onto your screen. If you want to learn more about this please consider reading this thread.
</p>

<p>
	<strong>Promotional Video: </strong><a href="https://www.youtube.com/watch?v=RQy3Q4Xe110" rel="external nofollow">https://www.youtube.com/watch?v=RQy3Q4Xe110</a>
</p>

<p>
	<strong>Prerequisites</strong><br>
	This tutorial is aimed at people who are capable of scientific thinking and are willing to playfully learn with Lua code. To execute steps in this tutorial minimal knowledge of Linear Algebra and Lua is required.
</p>

<p>
	<strong>Required MTA Resource:</strong> <a href="https://github.com/quiret/mta_lua_3d_math" rel="external nofollow">https://github.com/quiret/mta_lua_3d_math</a>
</p>

<p>
	<strong>Description of the math</strong><br>
	Imagine that we have got a frustum and a plane in a 3D room described by coordinates plus their boundaries. By intersecting both you obtain all coordinates on a screen along with their depth values.
</p>

<p>
	<img alt="LTzouBz.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/LTzouBz.png">
</p>

<p>
	Now think about how your vision works. You see distant objects smaller than closer ones. You rotate your eyes to angles of vision. If we were to put this concept into terms of math we could say: the plane of vision is bigger in the distance than in close proximity. The frustum is a seamless row of vision planes starting from the pyramid tip to the bottom.
</p>

<p>
	<img alt="MX70YM4.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/MX70YM4.png">
</p>

<p>
	<strong>How to use the MTA Resource</strong><br>
	Just download the GitHub repository into a folder of your MTA Resources, name it "math_3d_nonlin" and start it. You can execute the following commands for quick testing:
</p>

<ul>
	<li>
		send_bbuf: draws a simple depth test
	</li>
	<li>
		draw_model: draws the DFF file "gfriend.dff"
	</li>
</ul>

<p>
	<img alt="dHoMY9C.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/dHoMY9C.png">
</p>

<p>
	Now we have got the basics out of the way. Time to start coding. <img alt=":)" data-emoticon="" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/smile@2x.png 2x" title=":)" width="20" data-src="https://forum.multitheftauto.com/uploads/emoticons/smile.png">
</p>

<p>
	Please create a new "_math_test.Lua" script file in the resource and include it server-side at the bottom of meta.xml.
</p>

<p>
	<strong>Tutorial: software rendering a plane on screen</strong><br>
	Open your _math_test.Lua and include the following code:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> viewFrustum </span><span class="pun">=</span><span class="pln"> createViewFrustum</span><span class="pun">(</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln">      </span><span class="com">-- position</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln">     </span><span class="com">-- right</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">),</span><span class="pln">     </span><span class="com">-- up</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">      </span><span class="com">-- front</span><span class="pln">
</span><span class="pun">);</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> plane </span><span class="pun">=</span><span class="pln"> createPlane</span><span class="pun">(</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">-3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-3</span><span class="pun">),</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> task_draw_scene</span><span class="pun">(</span><span class="pln">thread</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> bbuf </span><span class="pun">=</span><span class="pln"> create_backbuffer</span><span class="pun">(</span><span class="lit">640</span><span class="pun">,</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">50</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> dbuf </span><span class="pun">=</span><span class="pln"> createDepthBuffer</span><span class="pun">(</span><span class="lit">640</span><span class="pun">,</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> time_start </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getTickCount" rel="external nofollow">getTickCount</a></span></span><span class="pun">();</span><span class="pln">
    
    </span><span class="kwd">do</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> gotToDraw</span><span class="pun">,</span><span class="pln"> numDrawn</span><span class="pun">,</span><span class="pln"> numSkipped </span><span class="pun">=</span><span class="pln"> draw_plane_on_bbuf</span><span class="pun">(</span><span class="pln">viewFrustum</span><span class="pun">,</span><span class="pln"> bbuf</span><span class="pun">,</span><span class="pln"> dbuf</span><span class="pun">,</span><span class="pln"> plane</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
        
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> gotToDraw </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            <span><a href="https://wiki.multitheftauto.com/wiki/outputDebugString" rel="external nofollow">outputDebugString</a></span></span><span class="pun">(</span><span class="pln"> </span><span class="str">"drawn "</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> numDrawn </span><span class="pun">..</span><span class="pln"> </span><span class="str">" pixels (skipped "</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> numSkipped </span><span class="pun">..</span><span class="pln"> </span><span class="str">")"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> time_end </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getTickCount" rel="external nofollow">getTickCount</a></span></span><span class="pun">();</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> ms_diff </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> time_end </span><span class="pun">-</span><span class="pln"> time_start </span><span class="pun">);</span><span class="pln">
    
    <span><a href="https://wiki.multitheftauto.com/wiki/outputDebugString" rel="external nofollow">outputDebugString</a></span></span><span class="pun">(</span><span class="pln"> </span><span class="str">"render time: "</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> ms_diff </span><span class="pun">..</span><span class="pln"> </span><span class="str">"ms"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
    
    taskUpdate</span><span class="pun">(</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="str">"creating backbuffer color composition <span><a href="https://wiki.multitheftauto.com/wiki/string" rel="external nofollow">string</a></span>"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> bbuf_width_ushort </span><span class="pun">=</span><span class="pln"> num_to_ushort_bytes</span><span class="pun">(</span><span class="pln"> bbuf</span><span class="pun">.</span><span class="pln">width </span><span class="pun">);</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> bbuf_height_ushort </span><span class="pun">=</span><span class="pln"> num_to_ushort_bytes</span><span class="pun">(</span><span class="pln"> bbuf</span><span class="pun">.</span><span class="pln">height </span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> pixels_str </span><span class="pun">=</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.concat" rel="external nofollow">table</a></span></span><span class="pun"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.concat" rel="external nofollow">.</a></span></span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-table.concat" rel="external nofollow">concat</a></span></span><span class="pun">(</span><span class="pln">bbuf</span><span class="pun">.</span><span class="pln">items</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> bbuf_string </span><span class="pun">=</span><span class="pln">
        pixels_str </span><span class="pun">..</span><span class="pln">
        </span><span class="pun">(</span><span class="pln"> bbuf_width_ushort </span><span class="pun">..</span><span class="pln">
        bbuf_height_ushort </span><span class="pun">);</span><span class="pln">
        
    taskUpdate</span><span class="pun">(</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="str">"sending backbuffer to clients (render time: "</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> ms_diff </span><span class="pun">..</span><span class="pln"> </span><span class="str">"ms)"</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
        
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> players </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getElementsByType" rel="external nofollow">getElementsByType</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span>"</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd">for</span><span class="pln"> m</span><span class="pun">,</span><span class="pln">n </span><span class="kwd">in</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-ipairs" rel="external nofollow">ipairs</a></span></span><span class="pun">(</span><span class="pln">players</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
        <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="str">"onServerTransmitImage"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> bbuf_string</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    
    <span><a href="https://wiki.multitheftauto.com/wiki/outputDebugString" rel="external nofollow">outputDebugString</a></span></span><span class="pun">(</span><span class="str">"sent backbuffer to clients"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="pln"> </span><span class="str">"testdraw"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln">
        spawnTask</span><span class="pun">(</span><span class="pln">task_draw_scene</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="pun">);</span></pre>

<p>
	<strong>Result:</strong><br>
	<img alt="WN1jwbN.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/WN1jwbN.png">
</p>

<p>
	Try executing the "testdraw" command.
</p>

<p>
	At the top of file you see the definition of our frustum cone as well as a plane. By calling the function "draw_plane_on_bbuf" we put color information into bbuf for exactly the pixels that make up the rectangle. If you change the plane definition to...
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> plane </span><span class="pun">=</span><span class="pln"> createPlane</span><span class="pun">(</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">-2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">-4</span><span class="pun">),</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">),</span><span class="pln">
    createVector</span><span class="pun">(</span><span class="lit">-2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span></pre>

<p>
	you instead get this image:
</p>

<p>
	<img alt="16iyXaa.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/16iyXaa.png">
</p>

<p>
	Try changing around the coordinates of frustum and plane to obtain different pictures!
</p>

<p>
	<strong>Tutorial: software rendering a triangle on screen</strong><br>
	Take the same code as in the tutorial above but change line 19 to:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> gotToDraw</span><span class="pun">,</span><span class="pln"> numDrawn</span><span class="pun">,</span><span class="pln"> numSkipped </span><span class="pun">=</span><span class="pln"> draw_plane_on_bbuf</span><span class="pun">(</span><span class="pln">viewFrustum</span><span class="pun">,</span><span class="pln"> bbuf</span><span class="pun">,</span><span class="pln"> dbuf</span><span class="pun">,</span><span class="pln"> plane</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"tri"</span><span class="pun">);</span></pre>

<p>
	This way we have changed the primitive type to triangle (rectangle is the default). Try executing the "testdraw" command again to inspect the new result!
</p>

<p>
	<strong>Tutorial: drawing a DFF file onto screen</strong><br>
	Instead of writing triangle definitions by hand we can take them from a DFF file instead. DFF files are storage of triangle and vertex information along with 3D rotation and translation information. By extacting the triangles from the DFF file we can put them into our algorithm to software-render them!
</p>

<p>
	Here is a related excerpt from math_server.Lua:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> modelToDraw </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">do</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> modelFile </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/fileOpen" rel="external nofollow">fileOpen</a></span></span><span class="pun">(</span><span class="str">"gfriend.dff"</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">modelFile</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        modelToDraw </span><span class="pun">=</span><span class="pln"> rwReadClump</span><span class="pun">(</span><span class="pln">modelFile</span><span class="pun">);</span><span class="pln">
        <span><a href="https://wiki.multitheftauto.com/wiki/fileClose" rel="external nofollow">fileClose</a></span></span><span class="pun">(</span><span class="pln">modelFile</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> task_draw_model</span><span class="pun">(</span><span class="pln">thread</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> bbuf </span><span class="pun">=</span><span class="pln"> create_backbuffer</span><span class="pun">(</span><span class="lit">640</span><span class="pun">,</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">50</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> dbuf </span><span class="pun">=</span><span class="pln"> createDepthBuffer</span><span class="pun">(</span><span class="lit">640</span><span class="pun">,</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> time_start </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getTickCount" rel="external nofollow">getTickCount</a></span></span><span class="pun">();</span><span class="pln">
    
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> num_triangles_drawn </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">modelToDraw</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="com">-- Setup the camera.</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> geom </span><span class="pun">=</span><span class="pln"> modelToDraw</span><span class="pun">.</span><span class="pln">geomlist</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> mt </span><span class="pun">=</span><span class="pln"> geom</span><span class="pun">.</span><span class="pln">morphTargets</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> centerSphere </span><span class="pun">=</span><span class="pln"> mt</span><span class="pun">.</span><span class="pln">sphere</span><span class="pun">;</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> camPos </span><span class="pun">=</span><span class="pln"> viewFrustum</span><span class="pun">.</span><span class="pln">getPos</span><span class="pun">();</span><span class="pln">
        camPos</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="pln">centerSphere</span><span class="pun">.</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
        camPos</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="pln">centerSphere</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">3.8</span><span class="pun">);</span><span class="pln">
        camPos</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="pln">centerSphere</span><span class="pun">.</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> camFront </span><span class="pun">=</span><span class="pln"> viewFrustum</span><span class="pun">.</span><span class="pln">getFront</span><span class="pun">();</span><span class="pln">
        camFront</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        camFront</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="lit">5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> centerSphere</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
        camFront</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> camRight </span><span class="pun">=</span><span class="pln"> viewFrustum</span><span class="pun">.</span><span class="pln">getRight</span><span class="pun">();</span><span class="pln">
        camRight</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="pln">centerSphere</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
        camRight</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        camRight</span><span class="pun">.</span><span class="pln">getZ</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> camUp </span><span class="pun">=</span><span class="pln"> viewFrustum</span><span class="pun">.</span><span class="pln">getUp</span><span class="pun">();</span><span class="pln">
        camUp</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        camUp</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        camUp</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="pln">centerSphere</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> triPlane </span><span class="pun">=</span><span class="pln"> createPlane</span><span class="pun">(</span><span class="pln">
            createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln">
            createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln">
            createVector</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">);</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> vertices </span><span class="pun">=</span><span class="pln"> modelToDraw</span><span class="pun">.</span><span class="pln">geomlist</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">morphTargets</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">vertices</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> triangles </span><span class="pun">=</span><span class="pln"> modelToDraw</span><span class="pun">.</span><span class="pln">geomlist</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">triangles</span><span class="pun">;</span><span class="pln">
        
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> tpos </span><span class="pun">=</span><span class="pln"> triPlane</span><span class="pun">.</span><span class="pln">getPos</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> tu </span><span class="pun">=</span><span class="pln"> triPlane</span><span class="pun">.</span><span class="pln">getU</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> tv </span><span class="pun">=</span><span class="pln"> triPlane</span><span class="pun">.</span><span class="pln">getV</span><span class="pun">();</span><span class="pln">
        
        </span><span class="kwd">for</span><span class="pln"> m</span><span class="pun">,</span><span class="pln">n </span><span class="kwd">in</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-ipairs" rel="external nofollow">ipairs</a></span></span><span class="pun">(</span><span class="pln">triangles</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
            taskUpdate</span><span class="pun">(</span><span class="pln"> m </span><span class="pun">/</span><span class="pln"> </span><span class="pun">#</span><span class="pln">triangles</span><span class="pun">,</span><span class="pln"> </span><span class="str">"drawing triangle #"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> m </span><span class="pun">);</span><span class="pln">
            
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> vert1 </span><span class="pun">=</span><span class="pln"> vertices</span><span class="pun">[</span><span class="pln">n</span><span class="pun">.</span><span class="pln">vertex1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> vert2 </span><span class="pun">=</span><span class="pln"> vertices</span><span class="pun">[</span><span class="pln">n</span><span class="pun">.</span><span class="pln">vertex2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> vert3 </span><span class="pun">=</span><span class="pln"> vertices</span><span class="pun">[</span><span class="pln">n</span><span class="pun">.</span><span class="pln">vertex3 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            tpos</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="pln">vert1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
            tpos</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="pln">vert1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            tpos</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="pln">vert1</span><span class="pun">.</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
            
            tu</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="pln">vert2</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
            tu</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="pln">vert2</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            tu</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="pln">vert2</span><span class="pun">.</span><span class="pln">z </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
            
            tv</span><span class="pun">.</span><span class="pln">setX</span><span class="pun">(</span><span class="pln">vert3</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
            tv</span><span class="pun">.</span><span class="pln">setY</span><span class="pun">(</span><span class="pln">vert3</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
            tv</span><span class="pun">.</span><span class="pln">setZ</span><span class="pun">(</span><span class="pln">vert3</span><span class="pun">.</span><span class="pln">z </span><span class="pun">-</span><span class="pln"> vert1</span><span class="pun">.</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
            
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> gotToDraw</span><span class="pun">,</span><span class="pln"> numDrawn</span><span class="pun">,</span><span class="pln"> numSkipped </span><span class="pun">=</span><span class="pln"> draw_plane_on_bbuf</span><span class="pun">(</span><span class="pln">viewFrustum</span><span class="pun">,</span><span class="pln"> bbuf</span><span class="pun">,</span><span class="pln"> dbuf</span><span class="pun">,</span><span class="pln"> triPlane</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="str">"tri"</span><span class="pun">);</span><span class="pln">
            
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">gotToDraw</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">(</span><span class="pln">numDrawn </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                num_triangles_drawn </span><span class="pun">=</span><span class="pln"> num_triangles_drawn </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
        
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> time_end </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getTickCount" rel="external nofollow">getTickCount</a></span></span><span class="pun">();</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> ms_diff </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> time_end </span><span class="pun">-</span><span class="pln"> time_start </span><span class="pun">);</span><span class="pln">
    
    </span><span class="pun">(...)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	<br>
	The code first loads a DFF file called "gfriend.dff" and stores it inside the "modelToDraw" variable. Once you execute the "draw_model" command the code looks up the first geometry in the DFF file and fetches all triangles associated with it. The rendering camera is set up to point at the middle of the model. Then all triangles are drawn one-by-one.
</p>

<p>
	<a href="https://twitter.com/rplgn/status/1230650912345067520" rel="external nofollow">https://twitter.com/rplgn/status/1230650912345067520</a>
</p>

<p>
	Try swapping the DFF file for another one, like biker.dff, and examine the results! Maybe extract a different DFF file from GTA:SA and replace gfriend.dff with that one.
</p>

<p>
	<strong>External references:</strong>
</p>

<ul>
	<li>
		math calculation on paper example: <a href="https://imgur.com/gallery/rLvln3X" rel="external nofollow">https://imgur.com/gallery/rLvln3X</a>
	</li>
	<li>
		German thread on mta-sa.org: <a href="https://www.mta-sa.org/thread/38693-3d-frustum-ebene-schneidung-in-Lua/" rel="external nofollow">https://www.mta-sa.org/thread/38693-3d-frustum-ebene-schneidung-in-Lua/</a>
	</li>
</ul>

<p>
	Do you have any questions related to the math or the implementation? Do not shy away from asking! I want to provide you with as much insight as I can. <img alt=":)" data-emoticon="" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/smile@2x.png 2x" title=":)" width="20" data-src="https://forum.multitheftauto.com/uploads/emoticons/smile.png">
</p>
]]></description><guid isPermaLink="false">122576</guid><pubDate>Sat, 22 Feb 2020 10:30:57 +0000</pubDate></item><item><title>[TUT] Scaling DX</title><link>https://forum.multitheftauto.com/topic/117472-tut-scaling-dx/</link><description><![CDATA[<p>
	<strong><span style="font-size:48px;">[TUT] Scaling DX</span></strong>
</p>

<p>
	The reason why I am creating this topic, is because there are a lot of people asking this question:
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			How to display DX for all screen formats?
		</p>
	</div>
</blockquote>

<p>
	 
</p>

<p>
	And to be honest there is no best practice for.
</p>

<p>
	 
</p>

<p>
	But here you have my recommendation as guidance for display them the ~<strong>s~a~m~e~</strong><strong> </strong>for all screen formats.
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	<strong><span style="font-size:24px;">There are two important factors while dealing with screen formats</span></strong>
</p>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>1. Pixel density </strong></span>
</p>

<p>
	Indication: PPI(Pixels Per Inch) <span style="color:#7f8c8d;">and some also use the term DPI(Dots Per Inch) They do not have to be the same while talking about printing stuff.</span>
</p>

<p>
	This indication tells us about how many pixels are used per inch. Which more or less tells us how sharp/smooth things like text can be looking.
</p>

<p>
	PPI doesn't really play a big role, but to display something nicely you need enough pixels to display it. Else it will be either too small or too crispy.
</p>

<p>
	<span style="color:#ff0000;"><strong>So be careful to not scale things (especially text) too small.</strong></span>
</p>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>2. Display aspect ratio</strong></span>
</p>

<p>
	<a href="https://en.wikipedia.org/wiki/Display_aspect_ratio" rel="external nofollow">Wiki</a>
</p>

<p>
	The difference between resolution X and resolution Y as a ratio.
</p>

<p>
	A list of common ratios:
</p>

<p>
	<strong>4:3      5:4       3:2       </strong>16:10 <strong>      16:9</strong>
</p>

<p>
	 
</p>

<p>
	<strong>So for example if we take: </strong>
</p>

<p>
	fHD: <strong><span style="color:#c0392b;">1920x1080</span></strong>
</p>

<p>
	Which has the ratio <strong><span style="color:#2980b9;">16:9</span></strong>
</p>

<p>
	 
</p>

<p>
	that is calculated like this:
</p>

<p>
	<strong><span style="color:#c0392b;">1920</span> </strong>/ <strong><span style="color:#2980b9;">16</span></strong> = <strong><span style="color:#000000;">120</span></strong>
</p>

<p>
	<strong><span style="color:#000000;">120 </span></strong>*<span style="color:#2980b9;"> <strong>9</strong></span> = <strong><span style="color:#c0392b;">1080</span></strong>
</p>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<strong><span style="font-size:24px;">Scaling without ratio</span></strong>
</p>

<p>
	 
</p>

<p>
	Before I am going to explain any of this, I am going to ask you an important question:
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			Does anybody play his MTA game on a vertical screen? Just like you hold your mobile phone.
		</p>
	</div>
</blockquote>

<p>
	 
</p>

<p>
	<strong>Like this: (</strong>vertical<strong>)</strong>
</p>

<p>
	<span style="color:#000000;"><span style="font-size:72px;"><span title="Black Vertical Rectangle">▮</span></span></span>
</p>

<p>
	 
</p>

<p>
	<strong>Or horizontal?</strong>
</p>

<p>
	<span style="color:#000000;"><span style="font-size:72px;"><span title="Lower Five Eighths Block">▅</span></span></span>
</p>

<p>
	I assume most people would agree to play MTA horizontal, else you are probably reading a book or document.<br />
	<span style="color:#7f8c8d;">p.s If you play MTA on a vertical screen, then we developers do not like you at all, sorry.</span>
</p>

<p>
	 
</p>

<p>
	<strong>So what does this tell us? </strong>
</p>

<ul>
	<li>
		You can assume that the X-resolution is never going to be smaller than the Y-resolution. <img alt=":???:" data-emoticon="" data-src="https://forum.multitheftauto.com/uploads/emoticons/icon_confused.gif.6c3bdc61f23d44f3eb9d288e9c1d48f3.gif" height="15" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:auto;" title=":???:" width="15" /><br />
		<strong>Useful? You will figure it out.</strong>
	</li>
</ul>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>Doing the scaling</strong></span>
</p>

<p>
	<span style="color:#c0392b;">Note: This part is ABOUT SCALING and not positioning</span>.
</p>

<p>
	 
</p>

<p>
	<strong>So what we are going to do is:</strong>
</p>

<ol>
	<li>
		Calculating a scale which can display the same DX on multiple screen formats &gt;
	</li>
	<li>
		without messing with the ratio.
	</li>
</ol>

<p>
	 
</p>

<p>
	<strong>Example:</strong> A computer runs MTA at a resolution of 1920 x 1080.
</p>

<p>
	Lets define that!
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> devScreenX </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1920</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> devScreenY </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1080</span></pre>

<p>
	 
</p>

<p>
	If this code is used by a different pc, we also need to know on which resolution it is running:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> screenX</span><span class="pun">,</span><span class="pln"> screenY </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/guiGetScreenSize" rel="external nofollow">guiGetScreenSize</a></span></span><span class="pun">()</span></pre>

<p>
	 
</p>

<p>
	For the next step we have to look at this screenshot:
</p>

<p>
	<img alt="cut-1080x1080.png" class="ipsImage" data-ratio="56.25" height="562" style="height:auto;" width="1000" data-src="https://i.ibb.co/S6LDb9N/cut-1080x1080.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
</p>

<p>
	I have cut out of the wide-screen format a square.
</p>

<p>
	 
</p>

<p>
	Squares have the ratio 1:1, which means that we have removed our ratio difference from this screen resolution.
</p>

<p>
	It is very easy to do, as our Y * Y resolution makes exactly that beautiful square!
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	The next thing we have to do is creating our scaling value. This value is required for adjust our resolution values so that they match to every screen format.
</p>

<p>
	So to use our ratio 1:1, we use the <strong>Y resolution </strong>to achieve that<span><span>:</span></span>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> scaleValue </span><span class="pun">=</span><span class="pln"> screenY </span><span class="pun">/</span><span class="pln"> devScreenY</span></pre>

<p>
	 
</p>

<p>
	And as last we can create a rectangle shape that is displayed at the center of every screen format, perfectly!
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> devScreenX </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1920</span><span class="pln">
</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> devScreenY </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1080</span><span class="pln">

</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> screenX</span><span class="pun">,</span><span class="pln"> screenY </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/guiGetScreenSize" rel="external nofollow">guiGetScreenSize</a></span></span><span class="pun">()</span><span class="pln">

</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> scaleValue </span><span class="pun">=</span><span class="pln"> screenY </span><span class="pun">/</span><span class="pln"> devScreenY

<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onClientRender" rel="external nofollow">onClientRender</a></span>"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	</span><span class="com">-- create a scaled size</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> sizeX </span><span class="pun">=</span><span class="pln"> scaleValue </span><span class="pun">*</span><span class="pln"> </span><span class="lit">300</span><span class="pln"> </span><span class="com">-- 300px</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> sizeY </span><span class="pun">=</span><span class="pln"> scaleValue </span><span class="pun">*</span><span class="pln"> </span><span class="lit">50</span><span class="pln"> </span><span class="com">-- 50px</span><span class="pln">
	
	</span><span class="com">-- get the center of the screen</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> centerX </span><span class="pun">=</span><span class="pln"> screenX </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> centerY </span><span class="pun">=</span><span class="pln"> screenY </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
	
	</span><span class="com">-- calculate the starting point of the rectangle</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> startRectangleX </span><span class="pun">=</span><span class="pln"> centerX </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sizeX </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> startRectangleY </span><span class="pun">=</span><span class="pln"> centerY </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sizeY </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	
	<span><a href="https://wiki.multitheftauto.com/wiki/dxDrawRectangle" rel="external nofollow">dxDrawRectangle</a></span> </span><span class="pun">(</span><span class="pln"> startRectangleX</span><span class="pun">,</span><span class="pln"> startRectangleY</span><span class="pun">,</span><span class="pln"> sizeX</span><span class="pun">,</span><span class="pln"> sizeY</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/tocolor" rel="external nofollow">tocolor</a></span> </span><span class="pun">(</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
</span><span class="kwd">end</span><span class="pun">)</span></pre>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	<span style="font-size:18px;"><strong>Lower limit</strong></span>
</p>

<ul>
	<li>
		What if we have a resolution of 800x600?
	</li>
	<li>
		And the text is getting too small?
	</li>
</ul>

<p>
	Making sure that the pixel density is OK, is very important.
</p>

<p>
	<strong>So to counter that we have to make sure that the text is not getting too small.</strong>
</p>

<p>
	 
</p>

<p>
	Our development Y resolution is 1080 pixels. And we are dealing with an Y resolution 600 pixels.
</p>

<p>
	The first thing we are going to look at, is what the scale is going to be at that point.
</p>

<p>
	600 / 1080 = 0.555<span style="color:#bdc3c7;">55555555555555555555555555556</span>
</p>

<p>
	 
</p>

<p>
	It is not very nice to have your text scaled to 55.5% of the original size, when having low resolution already. But without scaling, the DX stuff might fill up the entire screen and that is just as bad.
</p>

<p>
	So what we now need is a limit, in this case a lower limit.
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">scaleValue </span><span class="pun">=</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-math.max" rel="external nofollow">math</a></span></span><span class="pun"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-math.max" rel="external nofollow">.</a></span></span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-math.max" rel="external nofollow">max</a></span></span><span class="pun">(</span><span class="pln">scaleValue</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.65</span><span class="pun">)</span></pre>

<p>
	The math.max function returns the highest value of all the arguments you put in to it.
</p>

<p>
	<strong>In this case it contains the:</strong>
</p>

<ul>
	<li>
		<strong>scaleValue</strong>: 0.555
	</li>
	<li>
		And the <strong>lower limit </strong>of: 0.65
	</li>
</ul>

<p>
	 
</p>

<p>
	This will make sure that the DX stuff is not getting smaller than 65%. This might make text read able for a 800x600 resolution.
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<pre class="ipsCode prettyprint lang-lua prettyprinted">


<span class="kwd">local</span><span class="pln"> devScreenX </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1920</span><span class="pln"> 
</span><span class="kwd">local</span><span class="pln"> devScreenY </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1080</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> screenX</span><span class="pun">,</span><span class="pln"> screenY </span><span class="pun">=</span><span class="pln"> guiGetScreenSize</span><span class="pun">()</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> scaleValue </span><span class="pun">=</span><span class="pln"> screenY </span><span class="pun">/</span><span class="pln"> devScreenY

scaleValue </span><span class="pun">=</span><span class="pln"> math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">scaleValue</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.65</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- &lt; here add the limit</span><span class="pln">

addEventHandler</span><span class="pun">(</span><span class="str">"onClientRender"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	</span><span class="com">-- create a scaled size</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> sizeX </span><span class="pun">=</span><span class="pln"> scaleValue </span><span class="pun">*</span><span class="pln"> </span><span class="lit">300</span><span class="pln"> </span><span class="com">-- 300px</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> sizeY </span><span class="pun">=</span><span class="pln"> scaleValue </span><span class="pun">*</span><span class="pln"> </span><span class="lit">50</span><span class="pln"> </span><span class="com">-- 50px</span><span class="pln">
	
	</span><span class="com">-- get the center of the screen</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> centerX </span><span class="pun">=</span><span class="pln"> screenX </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> centerY </span><span class="pun">=</span><span class="pln"> screenY </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
	
	</span><span class="com">-- calculate the starting point of the rectangle</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> startRectangleX </span><span class="pun">=</span><span class="pln"> centerX </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sizeX </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">local</span><span class="pln"> startRectangleY </span><span class="pun">=</span><span class="pln"> centerY </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sizeY </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	
	dxDrawRectangle </span><span class="pun">(</span><span class="pln"> startRectangleX</span><span class="pun">,</span><span class="pln"> startRectangleY</span><span class="pun">,</span><span class="pln"> sizeX</span><span class="pun">,</span><span class="pln"> sizeY</span><span class="pun">,</span><span class="pln"> tocolor </span><span class="pun">(</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
</span><span class="kwd">end</span><span class="pun">)</span></pre>

		<p>
			 
		</p>
	</div>
</div>

<p>
	 
</p>

<p>
	 
</p>

<p>
	<strong><span style="font-size:24px;">Positioning</span></strong>
</p>

<p>
	Do you want to place your dx-effects at a specific place on your screen?
</p>

<p>
	See the following useful function: <a href="https://wiki.multitheftauto.com/wiki/GetScreenStartPositionFromBox" rel="external nofollow">https://wiki.multitheftauto.com/wiki/GetScreenStartPositionFromBox</a>
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>
]]></description><guid isPermaLink="false">117472</guid><pubDate>Thu, 13 Jun 2019 19:21:14 +0000</pubDate></item><item><title>Lua tables as sets (instead of arrays)</title><link>https://forum.multitheftauto.com/topic/130181-lua-tables-as-sets-instead-of-arrays/</link><description><![CDATA[<p>
	I don't know why I even have to point this out since this is something I figured out automatically in my early days of MTA scripting. But it seems necessary because I see people using Lua tables but not taking advantage of their flexibility.
</p>

<p>
	<span style="font-size:24px;"><strong>Very brief overview of tables as arrays</strong></span>
</p>

<p>
	Anyway, Lua tables are often used as arrays - that is, data structures that store values under consecutive integer keys starting at 1 (0 in most other languages, but that's another story), making a sequence. Various functions that operate on tables, including those in <span style="background-color:#555555;">table</span> namespace, treat them as arrays. Take this example:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> fruits </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
table</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"apple"</span><span class="pun">)</span><span class="pln">
table</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"banana"</span><span class="pun">)</span><span class="pln">
table</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"lemon"</span><span class="pun">)</span><span class="pln">
table</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"orange"</span><span class="pun">)</span></pre>

<p>
	It creates an empty table, then uses <span style="background-color:#555555;">table.insert</span> to insert values. Because <span style="background-color:#555555;">table.insert</span> treats the table as an array and because it inserts at the end of the sequence if position argument is omitted, we end up with values <span style="background-color:#555555;">"apple"</span>, <span style="background-color:#555555;">"banana"</span>, <span style="background-color:#555555;">"lemon"</span> and <span style="background-color:#555555;">"orange"</span> values under keys 1, 2, 3 and 4 respectively.
</p>

<p>
	Using index operator [], you can retrieve the associated value from the key:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- assuming standalone Lua, using print</span><span class="pln">
</span><span class="com">-- replace with outputChatBox or another output function if running in MTA</span><span class="pln">
print</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="com">-- outputs: apple</span><span class="pln">
print</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln"> </span><span class="com">-- outputs: banana</span><span class="pln">
print</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">[</span><span class="lit">3</span><span class="pun">])</span><span class="pln"> </span><span class="com">-- outputs: lemon</span><span class="pln">
print</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">[</span><span class="lit">4</span><span class="pun">])</span><span class="pln"> </span><span class="com">-- outputs: orange</span></pre>

<p>
	<span style="font-size:24px;"><strong>Tables as sets</strong></span>
</p>

<p>
	However, table keys don't have to be integers. You can use any value except <span style="background-color:#555555;">nil</span> and <span style="background-color:#555555;">nan</span>. Strings, other tables, MTA elements. Therefore, if the order of values is irrelevant and the values are unique, instead of inserting the value under some key, you can use that value itself as the key. And set the associated value to <span style="background-color:#555555;">true</span>:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> fruits </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"apple"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"banana"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"lemon"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"orange"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span></pre>

<p>
	Now we have a table with keys <span style="background-color:#555555;">"apple"</span>, <span style="background-color:#555555;">"banana"</span>, <span style="background-color:#555555;">"lemon"</span> and <span style="background-color:#555555;">"orange",</span> while the associated value <span style="background-color:#555555;">true</span> is only used to indicate the presence of key and nothing else. That effectively makes the table a set, a collection of unique values with no particular order.
</p>

<p>
	<span style="font-size:24px;"><strong>Usage and comparison</strong></span>
</p>

<p>
	<span style="font-size:18px;"><strong>Insertion</strong></span>
</p>

<p>
	So we have two different ways to insert values:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
table</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"apple"</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"apple"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span></pre>

<p>
	This alone doesn't say much. Both operations are simple and take a roughly constant amount of time to execute. However, it makes other operations very different.
</p>

<p>
	<span style="font-size:18px;"><strong>Removal</strong></span>
</p>

<p>
	Because arrays require you to know the key to remove the value, you have to loop through the array to find it. In contrast, with sets you can just assign <span style="background-color:#555555;">nil</span> (because <span style="background-color:#555555;">nil</span> is the value for unassigned fields):
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> removeFromArray</span><span class="pun">(</span><span class="pln">array</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> ipairs</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> v </span><span class="pun">==</span><span class="pln"> value </span><span class="kwd">then</span><span class="pln">
            table</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">array</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

removeFromArray</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"banana"</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
fruits</span><span class="pun">[</span><span class="str">"banana"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">nil</span></pre>

<p>
	Arrays are very inefficient for this if there is a large number of values, because the more values there are <strong>in total</strong>, the longer the removal of <strong>a single</strong> value will take - whereas removing from the set will take more or less the same.
</p>

<p>
	<span style="font-size:18px;"><strong>Checking if exists</strong></span>
</p>

<p>
	Checking for presence of a value is a lot like removal, you need to know where the value is, so arrays require looping. With sets, you just retrieve the associated value. If the checked value exists, the associated value will be <span style="background-color:#555555;">true</span>, otherwise it will be <span style="background-color:#555555;">nil</span>.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> existsInArray</span><span class="pun">(</span><span class="pln">array</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> ipairs</span><span class="pun">(</span><span class="pln">array</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> v </span><span class="pun">==</span><span class="pln"> value </span><span class="kwd">then</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> existsInArray</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">,</span><span class="pln"> </span><span class="str">"lemon"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"found"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">else</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"not found"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> fruits</span><span class="pun">[</span><span class="str">"lemon"</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"found"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">else</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"not found"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	Arrays are again inefficient in the same way.
</p>

<p>
	<strong><span style="font-size:18px;">Looping</span></strong>
</p>

<p>
	Looping is roughly the same, but as far as I know, Lua tables are optimized to be used as arrays, so I guess looping may be a little faster for arrays than sets. I have never checked this myself.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> value </span><span class="kwd">in</span><span class="pln"> ipairs</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"found value: "</span><span class="pun">..</span><span class="pln">value</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> value </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"found value: "</span><span class="pun">..</span><span class="pln">value</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	Notice that <span style="background-color:#555555;">ipairs</span> is used for the array and <span style="background-color:#555555;">pairs</span> is used for the set. <span style="background-color:#555555;">pairs</span> will work for the array as well, but the order will be unspecified. <span style="background-color:#555555;">ipairs</span> is meant to be used on arrays, it starts at index 1 and increments until no value is found.
</p>

<p>
	<span style="font-size:18px;"><strong>Size retrieval</strong></span>
</p>

<p>
	Lua has length operator #, which returns the array length when used on tables. But there is no built-in operator or function to retrieve the total number of fields in a table, so it takes more to get the size of a set.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="pun">#</span><span class="pln">fruits
print</span><span class="pun">(</span><span class="str">"fruit count: "</span><span class="pun">..</span><span class="pln">count</span><span class="pun">)</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> getSetSize</span><span class="pun">(</span><span class="pln">set</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> value </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln">set</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
        count </span><span class="pun">=</span><span class="pln"> count</span><span class="lit">+1</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> count
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> getSetSize</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">)</span><span class="pln">
print</span><span class="pun">(</span><span class="str">"fruit count: "</span><span class="pun">..</span><span class="pln">count</span><span class="pun">)</span></pre>

<p>
	This makes size retrieval much more efficient for arrays than sets because the more values the set has, the longer it takes to loop through them.
</p>

<p>
	That's speaking of sets in their simplest form though. You can have a structure like this:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> fruits </span><span class="pun">=</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
    values </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="pun">}</span></pre>

<p>
	And modify the count every time a value is inserted or removed. Then you can retrieve the size simply by reading <span style="background-color:#555555;">fruits.count</span>, which is efficient. But then other operations have to be altered too so we're not getting into this here.
</p>

<p>
	<span style="font-size:18px;"><strong>Checking if empty</strong></span>
</p>

<p>
	Checking if a collection is empty means checking if its size is 0. For arrays, nothing changes, but for sets it can be done efficiently.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="com">-- array</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">#</span><span class="pln">fruits </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"array is empty"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">else</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"array is not empty"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- set</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> next</span><span class="pun">(</span><span class="pln">fruits</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"set is empty"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">else</span><span class="pln">
    print</span><span class="pun">(</span><span class="str">"set is not empty"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	<span style="background-color:#555555;">next</span> is a Lua function for traversing the table. It's used by <span style="background-color:#555555;">pairs</span> too, called once for each pair. But here we call <span style="background-color:#555555;">next</span> directly. Its first returned value is one of the keys in the table, or <span style="background-color:#555555;">nil</span> if no key is found.
</p>

<p>
	<strong><span style="font-size:24px;">Conclusion</span></strong>
</p>

<p>
	For some of the most common operations, sets are both more efficient and simpler to operate on than arrays. In its simplest form, it loses against array in size retrieval, but you can keep track of size separately. When you want to store unique values and their order is unimportant, using tables as sets is probably the right choice.
</p>

<p>
	Syntax summary:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">tbl </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">

</span><span class="com">-- insertion</span><span class="pln">
tbl</span><span class="pun">[</span><span class="pln">value</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">

</span><span class="com">-- removal</span><span class="pln">
tbl</span><span class="pun">[</span><span class="pln">value</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln">

</span><span class="com">-- checking if exists</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> tbl</span><span class="pun">[</span><span class="pln">value</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">

</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- looping</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> value </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln">tbl</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">

</span><span class="kwd">end</span><span class="pln">

</span><span class="com">-- checking if empty</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> next</span><span class="pun">(</span><span class="pln">tbl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">

</span><span class="kwd">end</span></pre>

<p>
	 
</p>
]]></description><guid isPermaLink="false">130181</guid><pubDate>Sat, 03 Apr 2021 19:31:36 +0000</pubDate></item><item><title>[enhancement] MTA-Communication-Enhancement</title><link>https://forum.multitheftauto.com/topic/119507-enhancement-mta-communication-enhancement/</link><description><![CDATA[
<h1>
	<span style="font-size:36px;">MTA-Communication-</span>Enhancement
</h1>

<p>
	This is an <em>enhancement</em> that allows you to communicate between clientside and serverside a bit easier. If you know how to work with events, then you probably do not need this, but it has some nice features which allows you to sit back and write less code + achieve some nice results.
</p>

<p>
	<em>Note: It is important to keep in mind that this is an enhancement. Which means it is just an layer on top of the basic functionalities of MTA. And most enhancements come with a cost, in this case that is bit of performance.</em>
</p>

<p>
	 
</p>

<p>
	I will keep the information of topic to the minimal, as I have written most of the information already on the repository.
</p>

<p>
	<strong>You can find the repository </strong><a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment" rel="external nofollow">here</a>.
</p>

<ul>
	<li>
		<a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment/blob/master/documentation/examples/readme.md" rel="external nofollow">Examples</a>
	</li>
	<li>
		<a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment/tree/master/documentation/syntax" rel="external nofollow">Syntax</a>
	</li>
	<li>
		<a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment/tree/master/documentation/set-up" rel="external nofollow">Installation</a>
	</li>
</ul>

<p>
	 
</p>

<p>
	<span style="font-size:28px;"><strong>What can you do with it?</strong></span>
</p>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<strong><span style="font-size:20px;">Calling from clientside to serverside</span></strong>
</p>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">callServer</span><span class="pun">(</span><span class="str">"hello"</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Server</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> hello </span><span class="pun">()</span><span class="pln">
	<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Hello <span><a href="https://wiki.multitheftauto.com/wiki/client" rel="external nofollow">client</a></span>!"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<strong><span style="font-size:20px;">Calling from serverside to clientside</span></strong>
</p>

<p>
	 
</p>

<p>
	<strong>Server</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="str">"callclient"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln"> 
	
	</span><span class="com">-- An addCommandHandler is needed, because the client hasn't loaded it's scripts yet.</span><span class="pln">
	callClient</span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"hello"</span><span class="pun">)</span><span class="pln">
	
</span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> hello </span><span class="pun">()</span><span class="pln">
	<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Hello server!"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	Ok, ok, that was boring. The next one this is a bit nicer!
</p>

<p>
	 
</p>

<p>
	<em><span style="font-size:20px;">Hello are you there? Just Call-me-back... <u>I miss(ed)</u> you too</span></em><br />
	<strong><span style="font-size:20px;">Callback</span></strong>
</p>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">callServer</span><span class="pun">(</span><span class="pln">
	</span><span class="str">"callbackMe"</span><span class="pun">,</span><span class="pln"> 
	</span><span class="str">"argument"</span><span class="pun">,</span><span class="pln"> 
	</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">argument</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- &lt; This is the callback function</span><span class="pln">
		<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="pln">argument</span><span class="pun">)</span><span class="pln"> 
	</span><span class="kwd">end</span><span class="pln">
</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Server</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> callbackMe </span><span class="pun">(</span><span class="pln">argument</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> argument </span><span class="pun">..</span><span class="pln"> </span><span class="str">" &lt; I looked at it :)"</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	 
</p>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<strong><span style="font-size:20px;">Callback + internal arguments</span></strong>
</p>

<p>
	Sometimes you have arguments that you simply can't send over. &gt; <strong>functions</strong><br />
	Or arguments that shouldn't be send over. &gt;<strong> LARGE quantities of database data</strong>
</p>

<p>
	Internal arguments can be used to pass information to a callback without exposing it to the other side(client/server).
</p>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">callServer</span><span class="pun">(</span><span class="pln">
	</span><span class="str">"callbackMe"</span><span class="pun">,</span><span class="pln"> 
	
	</span><span class="com">--------------------------------</span><span class="pln">
	</span><span class="com">-- arguments that are send over</span><span class="pln">
	
	</span><span class="str">"argument"</span><span class="pun">,</span><span class="pln"> 
	
	</span><span class="com">--</span><span class="pln">
	</span><span class="com">--------------------------------</span><span class="pln">
	
	</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">internalArgument</span><span class="pun">,</span><span class="pln"> argument</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- &lt; This is the callback function.</span><span class="pln">
	
		<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="pln">internalArgument</span><span class="pun">)</span><span class="pln">
		<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="pln">argument</span><span class="pun">)</span><span class="pln"> 
		
	</span><span class="kwd">end</span><span class="pun">,</span><span class="pln">
	
	</span><span class="com">--------------------------------</span><span class="pln">
	</span><span class="com">-- arguments that are not send over</span><span class="pln">
	
	</span><span class="str">"internalArgument"</span><span class="pln"> </span><span class="com">-- &lt; internal argument</span><span class="pln">
	
	</span><span class="com">--</span><span class="pln">
	</span><span class="com">--------------------------------</span><span class="pln">
</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Server</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> callbackMe </span><span class="pun">(</span><span class="pln">argument</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> argument </span><span class="pun">..</span><span class="pln"> </span><span class="str">" &lt; I looked at it :D"</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	 
</p>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<span style="font-size:20px;"><strong>Ha! Serverside what is that? No need for complicated things!</strong></span>
</p>

<p>
	Communicate between clients without writing a single line of serverside. Magic!
</p>

<p>
	<em>Note: There is serverside used behind the scenes, you just don't have to write it.</em>
</p>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> smile </span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln">
	
	<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">((</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/isElement" rel="external nofollow">isElement</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getPlayerName" rel="external nofollow">getPlayerName</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="str">"[unknown]"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="str">" has send you a: :)"</span><span class="pun">)</span><span class="pln">
	
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getElementPosition" rel="external nofollow">getElementPosition</a></span></span><span class="pun">(</span><span class="pln">localPlayer</span><span class="pun">)</span><span class="pln">
	<span><a href="https://wiki.multitheftauto.com/wiki/setElementPosition" rel="external nofollow">setElementPosition</a></span></span><span class="pun">(</span><span class="pln">localPlayer</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> z </span><span class="pun">+</span><span class="pln"> </span><span class="lit">100</span><span class="pun">)</span><span class="pln">
	
</span><span class="kwd">end</span><span class="pln">
addRemoteClientAccessPoint</span><span class="pun">(</span><span class="pln">smile</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- &lt; This function allows other clients to call this function.</span><span class="pln">


</span><span class="com">---------------------------------------</span><span class="pln">
</span><span class="com">--                                   --</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> getPlayerFromPartialName</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> name </span><span class="kwd">and</span><span class="pln"> name</span><span class="pun">:</span><span class="pln">gsub</span><span class="pun">(</span><span class="str">"#%x%x%x%x%x%x"</span><span class="pun">,</span><span class="pln"> </span><span class="str">""</span><span class="pun">):</span><span class="pln">lower</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> name </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> _</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span> </span><span class="kwd">in</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-ipairs" rel="external nofollow">ipairs</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/getElementsByType" rel="external nofollow">getElementsByType</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span>"</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> name_ </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getPlayerName" rel="external nofollow">getPlayerName</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">):</span><span class="pln">gsub</span><span class="pun">(</span><span class="str">"#%x%x%x%x%x%x"</span><span class="pun">,</span><span class="pln"> </span><span class="str">""</span><span class="pun">):</span><span class="pln">lower</span><span class="pun">()</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> name_</span><span class="pun">:</span><span class="pln">find</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span>
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
</span><span class="com">-- Author: TAPL</span><span class="pln">
</span><span class="com">-- https://wiki.multitheftauto.com/wiki/GetPlayerFromPartialName</span><span class="pln">
</span><span class="com">--                                   --</span><span class="pln">
</span><span class="com">---------------------------------------</span><span class="pln">


<span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="str">"smile"</span><span class="pun">,</span><span class="pln"> 
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cmd</span><span class="pun">,</span><span class="pln"> playerName</span><span class="pun">)</span><span class="pln"> 
	</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span> </span><span class="pun">=</span><span class="pln"> getPlayerFromPartialName</span><span class="pun">(</span><span class="pln">playerName</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span> </span><span class="kwd">then</span><span class="pln">
		<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Sending smile!"</span><span class="pun">)</span><span class="pln">
		callRemoteClient</span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"smile"</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln">
		<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Can't find <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span>!"</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	Turtle, I will wait for you to catch up. So don't worry, you are still cute.
</p>

<p>
	<strong><span style="font-size:20px;">Await functions</span></strong>
</p>

<p>
	 
</p>

<p>
	When a player has joined the server, he or she doesn't have <strong>download + loaded</strong> his <strong>scripts </strong>yet. This means that you can't deliver your love letter yet and all your work will be for nothing. But what if you don't have to worry about that? <img alt=":propellerhead:" data-emoticon="" data-src="https://forum.multitheftauto.com/uploads/emoticons/5propeller.gif.a51224a6b24b2faf9bee8a02900d515c.gif" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:auto;" title=":propellerhead:" width="15" /><em>You can just wait now!</em>
</p>

<p>
	 
</p>

<p>
	<strong>Server</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"<span><a href="https://wiki.multitheftauto.com/wiki/onPlayerJoin" rel="external nofollow">onPlayerJoin</a></span>"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> 
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln">
	
	callClientAwait</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"testCallClientAwait"</span><span class="pun">)</span><span class="pln">
	
</span><span class="kwd">end</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Client</strong>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> testCallClientAwait </span><span class="pun">()</span><span class="pln">
	<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Yes this works!"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span></pre>

<p>
	 
</p>

<div>
	<hr />
</div>

<p>
	 
</p>

<p>
	<strong><span style="font-size:20px;">Security</span></strong>
</p>

<p>
	Worried about security issues?
</p>

<ul>
	<li>
		Remote calls for C++/MTA functions have been blocked.
	</li>
	<li>
		There is a whitelist feature included, <strong>if enabled</strong> your code can only remote-call whitelisted functions. <strong>(this is disabled by default)</strong><br />
		<em>Read the docs for that.</em><strong> <a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment/tree/master/documentation/syntax#shared-variables" rel="external nofollow">Here</a> </strong>and <strong><a href="https://gitlab.com/IIYAMA12/mta-communication-enchantment/tree/master/documentation/syntax#syntax-9" rel="external nofollow">here</a></strong>
	</li>
</ul>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>
]]></description><guid isPermaLink="false">119507</guid><pubDate>Sun, 18 Aug 2019 18:46:07 +0000</pubDate></item><item><title>[src] Automatic mta compiler using mta services.</title><link>https://forum.multitheftauto.com/topic/85956-src-automatic-mta-compiler-using-mta-services/</link><description><![CDATA[<p>
	Automatic compile your whole resource. Do what you want with it, but keep the formal credits.
</p>

<p>
	Don't forget that compiling isn't just for protection, <strong>it was also meant for optimization!</strong>
</p>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>Version for universal resource compiler: (NEW)</strong></span>
</p>

<p>
	<strong><span style="color:#2ecc71;">resourceCompiler</span></strong>/<span style="color:#c0392b;"><strong>meta.xml</strong></span>
</p>

<pre class="ipsCode prettyprint lang-xml prettyprinted">
<span class="tag">&lt;meta&gt;</span><span class="pln">
	</span><span class="tag">&lt;info</span><span class="pln"> </span><span class="atn">author</span><span class="pun">=</span><span class="atv">"IIYAMA"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"script"</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"Resource compiler"</span><span class="pln"> </span><span class="atn">version</span><span class="pun">=</span><span class="atv">"1.3.0"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
	
	</span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"scripts/compiler_s.lua"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">	
	</span><span class="tag">&lt;export</span><span class="pln"> </span><span class="atn">function</span><span class="pun">=</span><span class="atv">"compileResource"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"server"</span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;aclrequest&gt;</span><span class="pln">
		</span><span class="tag">&lt;right</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"function.fetchRemote"</span><span class="pln"> </span><span class="atn">access</span><span class="pun">=</span><span class="atv">"true"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;right</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"general.ModifyOtherObjects"</span><span class="pln"> </span><span class="atn">access</span><span class="pun">=</span><span class="atv">"true"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;/aclrequest&gt;</span><span class="pln">
</span><span class="tag">&lt;/meta&gt;</span></pre>

<div data-role="contentPage">
	<p>
		 
	</p>

	<hr data-role="contentPageBreak"></div>

<p>
	<span style="color:#2ecc71;"><strong>resourceCompiler</strong></span><span style="color:#e67e22;">/<strong>scripts</strong></span>/<span style="color:#c0392b;"><strong>compiler_s.lua</strong></span>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln"> 
</span><span class="com">------------------ </span><span class="pln">
</span><span class="com">-- by IIYAMA -- </span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> compileResource </span><span class="pun">(</span><span class="pln">player</span><span class="pun">,</span><span class="pln"> resourceName</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> hasObjectPermissionTo </span><span class="pun">(</span><span class="pln"> player</span><span class="pun">,</span><span class="pln"> </span><span class="str">"function.shutdown"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> getResourceFromName </span><span class="pun">(</span><span class="pln"> resourceName </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
		</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> hasObjectPermissionTo </span><span class="pun">(</span><span class="pln"> getThisResource </span><span class="pun">(),</span><span class="pln"> </span><span class="str">"function.fetchRemote"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
			outputChatBox</span><span class="pun">(</span><span class="str">" "</span><span class="pun">,</span><span class="pln"> player</span><span class="pun">)</span><span class="pln">
			outputChatBox</span><span class="pun">(</span><span class="str">"Require fetchRemote to compiling this resource!"</span><span class="pun">,</span><span class="pln"> player</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
			outputChatBox</span><span class="pun">(</span><span class="str">" "</span><span class="pun">,</span><span class="pln"> player</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
			</span><span class="kwd">local</span><span class="pln"> meta </span><span class="pun">=</span><span class="pln"> xmlLoadFile</span><span class="pun">(</span><span class="str">":"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> resourceName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/meta.xml"</span><span class="pun">)</span><span class="pln"> 
			</span><span class="kwd">if</span><span class="pln"> meta </span><span class="kwd">then</span><span class="pln"> 
				</span><span class="kwd">local</span><span class="pln"> folderName </span><span class="pun">=</span><span class="pln">  </span><span class="str">"compiled/"</span><span class="pun">..</span><span class="pln"> resourceName </span><span class="com">--.. "_compiled" </span><span class="pln">
				</span><span class="kwd">local</span><span class="pln"> newMeta </span><span class="pun">=</span><span class="pln"> xmlCopyFile</span><span class="pun">(</span><span class="pln">meta</span><span class="pun">,</span><span class="pln"> folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/meta.xml"</span><span class="pun">)</span><span class="pln"> 
				</span><span class="kwd">if</span><span class="pln"> newMeta </span><span class="kwd">then</span><span class="pln"> 
					</span><span class="kwd">local</span><span class="pln"> metaNotes </span><span class="pun">=</span><span class="pln"> xmlNodeGetChildren</span><span class="pun">(</span><span class="pln">meta</span><span class="pun">)</span><span class="pln"> 
					</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">metaNotes </span><span class="kwd">do</span><span class="pln"> 
						</span><span class="kwd">local</span><span class="pln"> metaNote </span><span class="pun">=</span><span class="pln"> metaNotes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
						</span><span class="kwd">local</span><span class="pln"> scriptName </span><span class="pun">=</span><span class="pln"> xmlNodeGetAttribute</span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
						</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> scriptName </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> string</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">scriptName</span><span class="pun">,</span><span class="pln"> </span><span class="str">"compiler.lua"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
							</span><span class="kwd">if</span><span class="pln"> xmlNodeGetName</span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"script"</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
								
								</span><span class="kwd">if</span><span class="pln"> scriptName </span><span class="kwd">and</span><span class="pln"> scriptName </span><span class="pun">~=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
									</span><span class="kwd">local</span><span class="pln"> FROM </span><span class="pun">=</span><span class="pln"> </span><span class="str">":"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> resourceName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> scriptName 
									</span><span class="kwd">local</span><span class="pln"> TO </span><span class="pun">=</span><span class="pln"> folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> scriptName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"c"</span><span class="pln"> 
									 
									</span><span class="kwd">local</span><span class="pln"> scriptFile </span><span class="pun">=</span><span class="pln"> fileOpen</span><span class="pun">(</span><span class="pln">FROM</span><span class="pun">)</span><span class="pln"> 
									 
									fetchRemote</span><span class="pun">(</span><span class="pln"> </span><span class="str">"https://luac.multitheftauto.com/?compile=1&amp;debug=0&amp;obfuscate=2"</span><span class="pun">,</span><span class="pln">  
									</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">data</span><span class="pun">)</span><span class="pln">  
										</span><span class="kwd">local</span><span class="pln"> newscriptFile </span><span class="pun">=</span><span class="pln"> fileCreate </span><span class="pun">(</span><span class="pln"> TO </span><span class="pun">)</span><span class="pln"> 
										</span><span class="kwd">if</span><span class="pln"> newscriptFile </span><span class="kwd">then</span><span class="pln"> 
											fileWrite</span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">)</span><span class="pln">  
											fileFlush</span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">)</span><span class="pln"> 
											fileClose</span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">)</span><span class="pln"> 
										</span><span class="kwd">end</span><span class="pln"> 
									</span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> fileRead</span><span class="pun">(</span><span class="pln">scriptFile</span><span class="pun">,</span><span class="pln"> fileGetSize </span><span class="pun">(</span><span class="pln"> scriptFile </span><span class="pun">))</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">)</span><span class="com">--fileLoad(FROM) </span><span class="pln">
									</span><span class="com">--https://luac.multitheftauto.com/api/ </span><span class="pln">
									 
								 
									fileClose</span><span class="pun">(</span><span class="pln">scriptFile</span><span class="pun">)</span><span class="pln"> 
								</span><span class="kwd">end</span><span class="pln"> 
							</span><span class="kwd">else</span><span class="pln"> 
								</span><span class="kwd">local</span><span class="pln"> fileName </span><span class="pun">=</span><span class="pln"> xmlNodeGetAttribute</span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
								</span><span class="kwd">if</span><span class="pln"> fileName </span><span class="kwd">then</span><span class="pln"> 
									fileCopy </span><span class="pun">(</span><span class="str">":"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> resourceName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> fileName</span><span class="pun">,</span><span class="pln"> folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> fileName</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
								</span><span class="kwd">end</span><span class="pln"> 
							</span><span class="kwd">end</span><span class="pln">
						</span><span class="kwd">end</span><span class="pln">
					</span><span class="kwd">end</span><span class="pln"> 
					</span><span class="kwd">local</span><span class="pln"> newMetaNotes </span><span class="pun">=</span><span class="pln"> xmlNodeGetChildren</span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
					</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">newMetaNotes </span><span class="kwd">do</span><span class="pln"> 
						</span><span class="kwd">local</span><span class="pln"> newMetaNote </span><span class="pun">=</span><span class="pln"> newMetaNotes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> 
						</span><span class="kwd">if</span><span class="pln"> xmlNodeGetName</span><span class="pun">(</span><span class="pln">newMetaNote</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"script"</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
							
							</span><span class="kwd">local</span><span class="pln"> scriptName </span><span class="pun">=</span><span class="pln"> xmlNodeGetAttribute</span><span class="pun">(</span><span class="pln">newMetaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
							
							</span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> string</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">scriptName</span><span class="pun">,</span><span class="pln"> </span><span class="str">"compiler.lua"</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
								</span><span class="kwd">if</span><span class="pln"> scriptName </span><span class="kwd">and</span><span class="pln"> scriptName </span><span class="pun">~=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
									xmlNodeSetAttribute </span><span class="pun">(</span><span class="pln"> newMetaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">,</span><span class="pln"> scriptName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"c"</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
								</span><span class="kwd">end</span><span class="pln"> 
							</span><span class="kwd">else</span><span class="pln">
								xmlDestroyNode</span><span class="pun">(</span><span class="pln">newMetaNote</span><span class="pun">)</span><span class="pln">
							</span><span class="kwd">end</span><span class="pln">
						</span><span class="kwd">end</span><span class="pln"> 
					</span><span class="kwd">end</span><span class="pln"> 
					xmlSaveFile</span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
					xmlUnloadFile</span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
				</span><span class="kwd">end</span><span class="pln"> 
				xmlUnloadFile</span><span class="pun">(</span><span class="pln">meta</span><span class="pun">)</span><span class="pln"> 
				outputChatBox</span><span class="pun">(</span><span class="str">"Compiling done!"</span><span class="pun">,</span><span class="pln"> player</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> 
			</span><span class="kwd">end</span><span class="pln"> 
		</span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln"> 
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">


addCommandHandler</span><span class="pun">(</span><span class="str">"compile"</span><span class="pun">,</span><span class="pln"> 
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">player</span><span class="pun">,</span><span class="pln"> commandName</span><span class="pun">,</span><span class="pln"> resourceName </span><span class="pun">)</span><span class="pln"> 
	compileResource </span><span class="pun">(</span><span class="pln">player</span><span class="pun">,</span><span class="pln"> resourceName</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	 
</p>

<p>
	<strong>Installation:</strong>
</p>

<ul><li>
		Put everything inside the folder <strong><span style="color:#2ecc71;">resourceCompiler</span></strong>. (see file path for <strong><span style="color:#c0392b;">file name</span></strong> and <strong><span style="color:#e67e22;">sub folders</span></strong>)
	</li>
	<li>
		Use the commando: /refresh
	</li>
	<li>
		Give the resource the required rights(login as admin before you use this commando):<br><strong>/aclrequest allow <span style="color:#2ecc71;">resourceCompiler </span>all</strong><br>
		This commando will give the resource all the rights that are defined in the meta.xml. (those are required to make the resource work)
	</li>
</ul><p>
	<strong>Rights:</strong>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			<br></p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="pun">&lt;</span><span class="pln">right name</span><span class="pun">=</span><span class="str">"function.fetchRemote"</span><span class="pln"> access</span><span class="pun">=</span><span class="str">"true"</span><span class="pln"> </span><span class="pun">/&gt;</span></pre>

		<p>
			This right for the function fetchRemote will make sure that you can send and receive your code. (to the mta compiler)
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="pun">&lt;</span><span class="pln">right name</span><span class="pun">=</span><span class="str">"general.ModifyOtherObjects"</span><span class="pln"> access</span><span class="pun">=</span><span class="str">"true"</span><span class="pln"> </span><span class="pun">/&gt;</span></pre>

		<p>
			This right will allow the resource to read and edit the files of other resources. (In this case it is for reading and copy files)
		</p>

		<p>
		</p>
		<br><p>
			 
		</p>
	</div>
</div>

<p>
	<strong>Usage:</strong>
</p>

<ul><li>
		/compile [resourceName]
	</li>
	<li>
		There is an export function you can use.
	</li>
</ul><p>
	 
</p>

<p>
	<span style="color:#3498db;"><strong>Now you are ready to go!</strong><strong> Don't forget to leave a <u>like</u>!</strong></span>
</p>

<div data-role="contentPage">
	<p>
		 
	</p>

	<hr data-role="contentPageBreak"></div>

<p>
	<strong><span style="color:#c0392b;">EXCLUDED (but can be included)</span></strong>
</p>

<p>
	Do you want to compile resources it in your admin panel as well? That would be nice right? (This source code is only on request because I do not want to be responsible for releasing a version of admin panel. My credits isn't on it as well)
</p>

<p>
	<img alt="mta-screen_2017-06-08_17-23-582.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://s29.postimg.org/mcu05vhg7/mta-screen_2017-06-08_17-23-582.png"></p>

<p>
	 
</p>

<p>
	<span style="color:#3498db;"><strong>Like this post</strong></span> <strong>+</strong><span style="color:#c0392b;"><strong> send me a PM</strong></span> to get a look at the adminpanel adjustments!<br>
	A PM with just: 'yes I want this!' is enough!
</p>

<p>
	<strong>Installation:</strong><br>
	 
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			<br></p>

		<ol><li>
				Remove the default admin resource. (pls make a backup)
			</li>
			<li>
				Add the new admin resource you will receive from me.
			</li>
			<li>
				Command: /refreshall
			</li>
			<li>
				Give the admin group the acl right: <strong>command.compile</strong><br><u>Else you wouldn't be able to press the 'compile' button.</u>
			</li>
		</ol><pre class="ipsCode prettyprint lang-xml prettyprinted">

<span class="tag">&lt;right</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"command.compile"</span><span class="pln"> </span><span class="atn">access</span><span class="pun">=</span><span class="atv">"true"</span><span class="tag">&gt;&lt;/right&gt;</span></pre>

		<p>
			<br></p>

		<p>
			 
		</p>

		<p>
			 
		</p>
	</div>
</div>

<p>
	<strong>Usage:</strong>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			<br></p>

		<ol><li>
				Make sure that the <em>resources </em><strong>admin </strong>and <strong>resourceCompiler </strong>are <u>running</u>.
			</li>
			<li>
				Press your <em>damn super super easy</em> <strong>left mouse </strong>button on top of the<strong> 'compile' button</strong> in <u>adminpanel</u>.
			</li>
			<li>
				It will give feedback inside the adminpanel if the export is successfully.
			</li>
			<li>
				Take a look in &gt;<strong> resourceCompiler\compiled</strong> &lt; This is where all your compiled resources will show up.<br><u>You can use this folder as an administration method for the resources you will upload to your server.</u>
			</li>
		</ol><p>
			 
		</p>
	</div>
</div>

<p>
	 
</p>

<p>
	 
</p>

<div data-role="contentPage">
	<p>
		 
	</p>

	<hr data-role="contentPageBreak"></div>

<p>
	 
</p>

<p>
	<span style="font-size:18px;"><strong>Version for compiling inside the same resource: (OLD, but still useful)</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			 
		</p>

		<p>
			<strong>Serverside</strong>
		</p>

		<pre class="prettyprint lang-lua ipsCode prettyprinted">

<span class="pln">  
</span><span class="com">------------------ </span><span class="pln">
</span><span class="com">-- by IIYAMA -- </span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addCommandHandler" rel="external nofollow">addCommandHandler</a></span></span><span class="pun">(</span><span class="str">"compileScripts"</span><span class="pun">,</span><span class="pln"> 
</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">)</span><span class="pln"> 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/hasObjectPermissionTo" rel="external nofollow">hasObjectPermissionTo</a></span> </span><span class="pun">(</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/player" rel="external nofollow">player</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="str">"function.shutdown"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> meta </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlLoadFile" rel="external nofollow">xmlLoadFile</a></span></span><span class="pun">(</span><span class="str">"meta.xml"</span><span class="pun">)</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pln"> meta </span><span class="kwd">then</span><span class="pln"> 
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> folderName </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getResourceName" rel="external nofollow">getResourceName</a></span> </span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/getThisResource" rel="external nofollow">getThisResource</a></span> </span><span class="pun">())</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="str">"_compiled"</span><span class="pln"> 
            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> newMeta </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlCopyFile" rel="external nofollow">xmlCopyFile</a></span></span><span class="pun">(</span><span class="pln">meta</span><span class="pun">,</span><span class="pln">folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/meta.xml"</span><span class="pun">)</span><span class="pln"> 
            </span><span class="kwd">if</span><span class="pln"> newMeta </span><span class="kwd">then</span><span class="pln"> 
                </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> metaNotes </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetChildren" rel="external nofollow">xmlNodeGetChildren</a></span></span><span class="pun">(</span><span class="pln">meta</span><span class="pun">)</span><span class="pln"> 
                </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">metaNotes </span><span class="kwd">do</span><span class="pln"> 
                    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> metaNote </span><span class="pun">=</span><span class="pln"> metaNotes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> 
                    </span><span class="kwd">if</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetName" rel="external nofollow">xmlNodeGetName</a></span></span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"script"</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
                        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> scriptName </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetAttribute" rel="external nofollow">xmlNodeGetAttribute</a></span></span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">if</span><span class="pln"> scriptName </span><span class="kwd">and</span><span class="pln"> scriptName </span><span class="pun">~=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
                            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> FROM </span><span class="pun">=</span><span class="pln"> scriptName 
                            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> TO </span><span class="pun">=</span><span class="pln"> folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> scriptName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"c"</span><span class="pln"> 
                             
                            </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> scriptFile </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/fileOpen" rel="external nofollow">fileOpen</a></span></span><span class="pun">(</span><span class="pln">FROM</span><span class="pun">)</span><span class="pln"> 
                             
                            <span><a href="https://wiki.multitheftauto.com/wiki/fetchRemote" rel="external nofollow">fetchRemote</a></span></span><span class="pun">(</span><span class="pln"> </span><span class="str">"https://luac.multitheftauto.com/?compile=1&amp;debug=0&amp;obfuscate=2"</span><span class="pun">,</span><span class="pln">  
                            </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">data</span><span class="pun">)</span><span class="pln">  
                                </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> newscriptFile </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/fileCreate" rel="external nofollow">fileCreate</a></span> </span><span class="pun">(</span><span class="pln"> TO </span><span class="pun">)</span><span class="pln"> 
                                </span><span class="kwd">if</span><span class="pln"> newscriptFile </span><span class="kwd">then</span><span class="pln"> 
                                    <span><a href="https://wiki.multitheftauto.com/wiki/fileWrite" rel="external nofollow">fileWrite</a></span></span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">)</span><span class="pln">  
                                    <span><a href="https://wiki.multitheftauto.com/wiki/fileFlush" rel="external nofollow">fileFlush</a></span></span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">)</span><span class="pln"> 
                                    <span><a href="https://wiki.multitheftauto.com/wiki/fileClose" rel="external nofollow">fileClose</a></span></span><span class="pun">(</span><span class="pln">newscriptFile</span><span class="pun">)</span><span class="pln"> 
                                </span><span class="kwd">end</span><span class="pln"> 
                            </span><span class="kwd">end</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/fileRead" rel="external nofollow">fileRead</a></span></span><span class="pun">(</span><span class="pln">scriptFile</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/fileGetSize" rel="external nofollow">fileGetSize</a></span> </span><span class="pun">(</span><span class="pln"> scriptFile </span><span class="pun">))</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">)</span><span class="com">--fileLoad(FROM) </span><span class="pln">
                            </span><span class="com">--https://luac.multitheftauto.com/api/ </span><span class="pln">
                             
                         
                            <span><a href="https://wiki.multitheftauto.com/wiki/fileClose" rel="external nofollow">fileClose</a></span></span><span class="pun">(</span><span class="pln">scriptFile</span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">end</span><span class="pln"> 
                    </span><span class="kwd">else</span><span class="pln"> 
                        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> fileName </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetAttribute" rel="external nofollow">xmlNodeGetAttribute</a></span></span><span class="pun">(</span><span class="pln">metaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">if</span><span class="pln"> fileName </span><span class="kwd">then</span><span class="pln"> 
                            <span><a href="https://wiki.multitheftauto.com/wiki/fileCopy" rel="external nofollow">fileCopy</a></span> </span><span class="pun">(</span><span class="pln"> fileName</span><span class="pun">,</span><span class="pln"> folderName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> fileName</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">end</span><span class="pln"> 
                    </span><span class="kwd">end</span><span class="pln"> 
                </span><span class="kwd">end</span><span class="pln"> 
                </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> newMetaNotes </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetChildren" rel="external nofollow">xmlNodeGetChildren</a></span></span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
                </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">#</span><span class="pln">newMetaNotes </span><span class="kwd">do</span><span class="pln"> 
                    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> newMetaNote </span><span class="pun">=</span><span class="pln"> newMetaNotes</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> 
                    </span><span class="kwd">if</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetName" rel="external nofollow">xmlNodeGetName</a></span></span><span class="pun">(</span><span class="pln">newMetaNote</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"script"</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
                        </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> scriptName </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeGetAttribute" rel="external nofollow">xmlNodeGetAttribute</a></span></span><span class="pun">(</span><span class="pln">newMetaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">if</span><span class="pln"> scriptName </span><span class="kwd">and</span><span class="pln"> scriptName </span><span class="pun">~=</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln"> 
                            <span><a href="https://wiki.multitheftauto.com/wiki/xmlNodeSetAttribute" rel="external nofollow">xmlNodeSetAttribute</a></span> </span><span class="pun">(</span><span class="pln"> newMetaNote</span><span class="pun">,</span><span class="pln"> </span><span class="str">"src"</span><span class="pun">,</span><span class="pln"> scriptName </span><span class="pun">..</span><span class="pln"> </span><span class="str">"c"</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
                        </span><span class="kwd">end</span><span class="pln"> 
                    </span><span class="kwd">end</span><span class="pln"> 
                </span><span class="kwd">end</span><span class="pln"> 
                <span><a href="https://wiki.multitheftauto.com/wiki/xmlSaveFile" rel="external nofollow">xmlSaveFile</a></span></span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
                <span><a href="https://wiki.multitheftauto.com/wiki/xmlUnloadFile" rel="external nofollow">xmlUnloadFile</a></span></span><span class="pun">(</span><span class="pln">newMeta</span><span class="pun">)</span><span class="pln"> 
            </span><span class="kwd">end</span><span class="pln"> 
            <span><a href="https://wiki.multitheftauto.com/wiki/xmlUnloadFile" rel="external nofollow">xmlUnloadFile</a></span></span><span class="pun">(</span><span class="pln">meta</span><span class="pun">)</span><span class="pln"> 
            <span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="str">"Compiling done!"</span><span class="pun">)</span><span class="pln"> 
        </span><span class="kwd">end</span><span class="pln"> 
    </span><span class="kwd">end</span><span class="pln"> 
</span><span class="kwd">end</span><span class="pun">)</span><span class="pln"> </span></pre>

		<div>
			 
		</div>

		<ol style="list-style-type:decimal;"><li>
				Add those line in your mta script. (serverside)
			</li>
			<li>
				Make sure your resource has admin rights to use the function fetchRemote.
			</li>
			<li>
				write: /compileScripts
			</li>
			<li>
				Check out the folder of your resource.
			</li>
			<li>
				A new folder will show up, with the name: _compiled
			</li>
		</ol><p>
			 
		</p>
	</div>
</div>

<p>
	 
</p>
]]></description><guid isPermaLink="false">85956</guid><pubDate>Sat, 04 Jun 2016 10:31:18 +0000</pubDate></item><item><title>Introduction to the PHP SDK</title><link>https://forum.multitheftauto.com/topic/74834-introduction-to-the-php-sdk/</link><description><![CDATA[<p style="background-color:#343a40;color:#fafafa;font-size:14px;">
	<span style="font-size:20px;"><span style="color:#e74c3c;"><strong>TUTORIAL/GUIDE NO LONGER MAINTAINED</strong></span></span>
</p>

<p style="background-color:#343a40;color:#fafafa;font-size:14px;">
	<span style="font-size:14px;">This tutorial is no longer maintained and it's contents may be deprecated or no longer work. I created this tutorial in 2014, when I was very involved with MTA and the community around it. Due to the nature of life, I ended up leaving MTA to focus on more important things (work, family, life, etc). </span>
</p>

<p style="background-color:#343a40;color:#fafafa;font-size:14px;">
	<span style="font-size:14px;">I believe this tutorial has helped a lot of people get into scripting for MTA over the years, and I'm happy I was able to do answer questions and help people get into coding!</span>
</p>

<p>
	 
</p>

<p>
	Hello! Welcome to my MTA PHP SDK tutorial! In this tutorial I'm going to be teaching you guys how to call your MTA server from your web-server, and call your web-server from your mta server.
</p>

<p>
	<strong>This tutorial may require a small amount of prior PHP knowledge</strong>
</p>

<p>
	Let's get started!
</p>

<p>
	<span><strong>Getting your web server</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			There's loads of software that will work for this. This software will host a web-server on your computer; this is the server that we're going to be working with for our MTA server.
		</p>

		<p>
			For this tutorial I'm going to be using the software XAMPP, but you can use whatever you want. If you don't have any web-server software on your machine, I recommend that you use XAMPP just so that it'll be easier for you to follow along with me.
		</p>

		<p>
			<strong>List of popular software to use</strong>
		</p>

		<p>
			- <a href="https://www.apachefriends.org/index.html" rel="external nofollow">XAMPP</a> <em>(Compatible with Windows, Linux, and OS X)</em>
		</p>

		<p>
			- <a href="http://www.wampserver.com/en/" rel="external nofollow">WAMP</a> <em>(Compatible with Windows)</em>
		</p>

		<p>
			- <a href="http://csg.sph.umich.edu/abecasis/LAMP/download/" rel="external nofollow">LAMP</a> <em>(Compatible with Linux)</em>
		</p>

		<p>
			- <a href="http://www.usbwebserver.net/en/download.php" rel="external nofollow">USBWebServer</a> <em>(Compatible with only Windows, as far as I know)</em>
		</p>

		<p>
			<strong>Common fixes</strong>
		</p>

		<p>
			If you install some web-software but it's not working, follow the following steps:
		</p>

		<p>
			1. If the process is running, stop it (Best through Task Manager)
		</p>

		<p>
			2. Exit Skype if it's running (Can open it later - this is only for XAMPP as far as I'm aware)
		</p>

		<p>
			3. Disable any anti-virus/firewalls
		</p>

		<p>
			4. Try opening the application as an administrator
		</p>

		<p>
			5. Still not working? Try restarting your machine and repeating these steps
		</p>

		<p>
			6. Still not working?? Try researching the problem
		</p>

		<p>
			<strong>When your software is running</strong>
		</p>

		<p>
			Once you get the program to finally open and work properly, you will need to start your Apache server.
		</p>

		<p>
			<img alt="3THyTwc.png" style="height:auto;" data-src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
		</p>

		<p>
			Once you start it, to confirm that it's working, in your browser open a new tab to <a href="http://localhost" rel="external nofollow">http://localhost</a>; you'll see some type of landing or welcome page for the software you installed.
		</p>

		<p>
			Next, you'll need to find where your htdocs/www folder is. This is the folder that the web-server software uses and puts onto your server. By default, xampp should be in the following location:
		</p>

		<p>
			[XAMPP INSTALL DIR(C:\xampp)]/htdocs
		</p>

		<p>
			Inside your installation directory, you should see an htdocs folder. If you don't, then look for a www or public_html folder.
		</p>

		<p>
			Once you find the folder, remember where it is, because you'll need it for later steps.
		</p>

		<p>
			<em>(In this tutorial, I'll be using XAMPP on Windows. I cannot with with other Operating Systems as I'm not familiar with them.)</em>
		</p>
	</div>
</div>

<p>
	<span><strong>Getting &amp; installing the PHP SDK</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			If you don't have a web server by now, then you cannot follow this step!
		</p>

		<p>
			Now, you need to download the MTA PHP SDK, download from the following link:
		</p>

		<p>
			<a href="https://wiki.multitheftauto.com/wiki/PHP_SDK" rel="external nofollow">https://wiki.multitheftauto.com/wiki/PHP_SDK</a> (The current version is 0.4, may be different when you're reading this. Download the most recent version)
		</p>

		<p>
			Once it's downloaded, go to your htdocs/www folder for your web-server and create a new folder. I'm going to call this folder "MTA_SDK."
		</p>

		<p>
			Inside your new folder, create another folder called "sdk" and extract the contents of the zip file you downloaded into this folder.
		</p>

		<p>
			<img alt="pNc5Qd6.png" style="height:auto;" data-src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
		</p>

		<p>
			Once you have done this, you can now delete the zip file, it is no longer needed.
		</p>
	</div>
</div>

<p>
	Great! Now you're ready to actually get started with using the SDK.
</p>

<p>
	<span><strong>Setting up an HTTP user</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			Once you've got the SDK downloaded, installed, and your web-server working correctly, you need to create the user that will be used to call the mta server with from the website.
		</p>

		<p>
			This is an extremely easy step to follow.
		</p>

		<p>
			The first thing you need to do is stop your MTA server, if it's running.
		</p>

		<p>
			Open your ACL, and add the following code to your Admin ACL group:
		</p>

		<pre class="prettyprint lang-xml ipsCode">&lt;object name="user.mta_php_sdk"&gt;&lt;/object&gt; 
</pre>

		<div>
			 
		</div>

		<p>
			Assumptionally, this is just creating a new user that we'll be using to make the requests to the server.
		</p>

		<p>
			once that's in your ACL, start your server and execute the following command in the console:
		</p>

		<pre class="ipsCode">addaccount mta_php_sdk SECERET_ACCOUNT_PASSWORD 
</pre>

		<div>
			 
		</div>

		<p>
			This'll create our user to the server so that we have something to work with!
		</p>
	</div>
</div>

<p>
	<span><strong>Connecting the servers</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			This step might be slightly more difficult than the rest, up to this point. Don't worry, I'll be your special guide!
		</p>

		<p>
			Once both your web and mta servers are running (at the same time) then we're ready to begin our PHP development.
		</p>

		<p>
			In your MTA_SDK folder (then one you created in step 2 on your web server,) create a new PHP file. I'm going to call mine <em>mta_tut.php</em>.
		</p>

		<p>
			Inside the file you've just created, paste the following code (It's pretty self-explanitory. Change the $MY_SERVER array information)
		</p>

		<pre class="ipsCode">&lt;?php  
  
include "sdk/mta_sdk.php";   # Include the MTA PHP SDK - Give us the classes and methods that we'll need 
  
  
$MY_SERVER = [ 
    "host" =&gt; "localhost",        #The host/IP of your MTA server 
    "http_port" =&gt; 22005,         #The HTTP port for your MTA server (Default 22005) 
    "http_user" =&gt; "mta_php_sdk", #The username that we created in the previous step 
    "http_pass" =&gt; "httppass"     #The password for the username that we created 
]; 
  
  
#Create a new mta object 
$SERVER = new mta ( $MY_SERVER['host'], $MY_SERVER['http_port'], $MY_SERVER['http_user'], $MY_SERVER['http_pass'] ); 
  
</pre>

		<div>
			 
		</div>

		<p>
			Once you save this code in the file, open <a href="http://localhost/MTA_SDK/mta_tut.php" rel="external nofollow">http://localhost/MTA_SDK/mta_tut.php</a> (or whatever your path will be) and make sure it displays no errors and successfully runs.
		</p>
	</div>
</div>

<p>
	<span><strong>Creating an HTTP responsive resource</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			We're back to scripting in Lua for this part!
		</p>

		<p>
			Go head and create a new resource on your MTA server. I'll call mine <em>mta_php</em>.
		</p>

		<p>
			Copy the following code into the <em>server.lua</em> file:
		</p>

		<pre class="prettyprint lang-lua lang-xml ipsCode">function doPrint ( string ) 
    return print ( string ); 
end  
</pre>

		<div>
			 
		</div>

		<p>
			Copy the following code into the <em>meta.xml</em> file:
		</p>

		<pre class="ipsCode">&lt;meta&gt; 
    &lt;info author="xXMADEXx" type="script" version="1.0" name="MTA PHP" /&gt; 
     
    &lt;!-- Include our awesome script --&gt; 
    &lt;script src="server.lua" /&gt; 
     
    &lt;!-- Export our function -- Make sure to allow HTTP to access it --&gt; 
    &lt;export function="doPrint" type="server" http="true" /&gt; 
     
&lt;/meta&gt; 
</pre>

		<div>
			 
		</div>

		<p>
			This is just a resource that'll allow us to test the PHP SDK to make sure that everything is working correctly, other than that it's basically pointless.
		</p>

		<p>
			Once it's created, refresh the resources (/refresh) and start this resource (/start mta_php).
		</p>
	</div>
</div>

<p>
	<span><strong>Calling our function from the web</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			Now we're back to the <em>mta_tut.php</em> file.
		</p>

		<p>
			Now that the servers are connected, and we have a resource to use, we can finally actually do something cool.
		</p>

		<p>
			Add the following code to your PHP file, it again is pretty self-explanitory:
		</p>

		<pre class="ipsCode">#We'll try to call our function... 
try { 
     
    $RESOURCE = $SERVER-&gt;getResource ( "mta_php" ); # We need to get our resource Object 
     
    $RESOURCE-&gt;call ( "doPrint", "this should be in the server console?" ); # Try to call the "doPrint" function with a string as an argument 
  
#Catch any errors that occurred 
} catch ( Exception $e ){ 
    #Output error message 
    echo "&lt;strong&gt;Oops, Something went wrong!&lt;/strong&gt;&lt;br /&gt;Error: {$e-&gt;getMessage()}&lt;br /&gt;&lt;br /&gt;e printout:&lt;br /&gt;"; 
     
    #Print the error table 
    print_r ( $e ); 
} 
</pre>

		<div>
			 
		</div>

		<p>
			The final code should look similar to this:
		</p>

		<pre class="ipsCode">&lt;?php  
  
include "sdk/mta_sdk.php";   # Include the MTA PHP SDK - Give us the classes and methods that we'll need 
  
  
$MY_SERVER = [ 
    "host" =&gt; "localhost",        #The host/IP of your MTA server 
    "http_port" =&gt; 22005,         #The HTTP port for your MTA server (Default 22005) 
    "http_user" =&gt; "mta_php_sdk", #The username that we created in the previous step 
    "http_pass" =&gt; "httppass"     #The password for the username that we created 
]; 
  
  
#Create a new mta object 
$SERVER = new mta ( $MY_SERVER['host'], $MY_SERVER['http_port'], $MY_SERVER['http_user'], $MY_SERVER['http_pass'] ); 
  
#We'll try to call our function... 
try { 
     
    $RESOURCE = $SERVER-&gt;getResource ( "mta_php" ); # We need to get our resource Object 
     
    $RESOURCE-&gt;call ( "doPrint", "this should be in the server console?" ); # Try to call the "doPrint" function with a string as an argument 
  
#Catch any errors that occurred 
} catch ( Exception $e ){ 
    #Output error message 
    echo "&lt;strong&gt;Oops, Something went wrong!&lt;/strong&gt;&lt;br /&gt;Error: {$e-&gt;getMessage()}&lt;br /&gt;&lt;br /&gt;e printout:&lt;br /&gt;"; 
     
    #Print the error table 
    print_r ( $e ); 
} 
</pre>

		<div>
			 
		</div>

		<p>
			Once you run the code (refresh the web-page), if everything works correctly, this should happen in your MTA console:
		</p>

		<p>
			<img alt="kZrjxrf.png" style="height:auto;" data-src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
		</p>
	</div>
</div>

<p>
	<span><strong>Getting data from mta server</strong></span>
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			In this section I'll be showing you guys how to return information to the web-server from the MTA server!
		</p>

		<p>
			This could be useful if you, oh say, want to get live player stats or something of the sort.
		</p>

		<p>
			For this tutorial, I'm just going to print the players that are currently online to the web page.
		</p>

		<p>
			The first thing we need to do is create our Lua script that will be responsible for returning the players to the web server.
		</p>

		<p>
			Go head and make a function that just returns a table of the players.
		</p>

		<pre class="prettyprint lang-lua lang-xml ipsCode">function getAllPlayersForWebsite ( ) 
    return getElementsByType ( "player" ); 
end 
</pre>

		<div>
			 
		</div>

		<p>
			Also, don't forget to export the function, and set the http attribute to true.
		</p>

		<pre class="ipsCode">&lt;export function="getAllPlayersForWebsite" type="server" http="true" /&gt; 
</pre>

		<div>
			 
		</div>

		<p>
			That's all the Lua code that we're going to need. Just go head and start or restart the resource that contains this code.
		</p>

		<p>
			Now, we will copy the code from the first php example, but we're going to have to change it up a little!
		</p>

		<p>
			Here's the original code:
		</p>

		<pre class="ipsCode">&lt;?php  
  
include "sdk/mta_sdk.php";   # Include the MTA PHP SDK - Give us the classes and methods that we'll need 
  
  
$MY_SERVER = [ 
    "host" =&gt; "localhost",        #The host/IP of your MTA server 
    "http_port" =&gt; 22005,         #The HTTP port for your MTA server (Default 22005) 
    "http_user" =&gt; "mta_php_sdk", #The username that we created in the previous step 
    "http_pass" =&gt; "httppass"     #The password for the username that we created 
]; 
  
  
#Create a new mta object 
$SERVER = new mta ( $MY_SERVER['host'], $MY_SERVER['http_port'], $MY_SERVER['http_user'], $MY_SERVER['http_pass'] ); 
  
#We'll try to call our function... 
try { 
     
    $RESOURCE = $SERVER-&gt;getResource ( "mta_php" ); # We need to get our resource Object 
     
    $RESOURCE-&gt;call ( "doPrint", "this should be in the server console?" ); # Try to call the "doPrint" function with a string as an argument 
  
#Catch any errors that occurred 
} catch ( Exception $e ){ 
    #Output error message 
    echo "&lt;strong&gt;Oops, Something went wrong!&lt;/strong&gt;&lt;br /&gt;Error: {$e-&gt;getMessage()}&lt;br /&gt;&lt;br /&gt;e printout:&lt;br /&gt;"; 
     
    #Print the error table 
    print_r ( $e ); 
} 
</pre>

		<div>
			 
		</div>

		<p>
			<em>(Don't forget to change your connection information in $MY_SERVER)</em>
		</p>

		<p>
			We're going to modify where <em>$RESOURCE-&gt;call</em> is. We'll need to assign it an array variable. Change this line to the following:
		</p>

		<pre class="ipsCode">$RESULT[] = $RESOURCE-&gt;call (  ); 
</pre>

		<div>
			 
		</div>

		<p>
			Once you get that, we'll need to assign an argument to the function that we want to call. I'm going to be calling the <em>getAllPlayersForWebsite</em> function, which will return an array/table for us to use.
		</p>

		<pre class="ipsCode">$RESULT[] = $RESOURCE-&gt;call ( "getAllPlayersForWebsite" ); 
</pre>

		<div>
			 
		</div>

		<p>
			When you get your code done, go head and add the following, so that we can confirm that everything is working!
		</p>

		<p>
			If you've done everything correctly, and everything is working, your web-page should look something of this sort:
		</p>

		<p>
			<img alt="uvnJqF5.png" style="height:auto;" data-src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
		</p>

		<p>
			It's not a very pretty page, but it's working. Let's go head and add a php foreach loop, loop through the players, and print them out. This will just give it a little bit of a better look &amp; feel.
		</p>

		<p>
			This code is optional, but you could add it if you like.
		</p>

		<pre class="ipsCode">foreach ( $RESULT [ 0 ] [ 0 ] as $index=&gt;$playerName ) { 
    echo $playerName . "&lt;br /&gt;";    
} 
</pre>

		<div>
			 
		</div>

		<p>
			And now we've got a beautiful web page!
		</p>

		<p>
			<img alt="rjJG0bH.png" style="height:auto;" data-src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
		</p>

		<p>
			When you're all done, your php code should look something similar to this:
		</p>

		<pre class="ipsCode">&lt;?php  
  
include "sdk/mta_sdk.php";   # Include the MTA PHP SDK - Give us the classes and methods that we'll need 
  
  
$MY_SERVER = [ 
    "host" =&gt; "localhost",        #The host/IP of your MTA server 
    "http_port" =&gt; 22005,         #The HTTP port for your MTA server (Default 22005) 
    "http_user" =&gt; "mta_php_sdk", #The username that we created in the previous step 
    "http_pass" =&gt; "httppass"     #The password for the username that we created 
]; 
  
  
#Create a new mta object 
$SERVER = new mta ( $MY_SERVER['host'], $MY_SERVER['http_port'], $MY_SERVER['http_user'], $MY_SERVER['http_pass'] ); 
  
#We'll try to call our function... 
try { 
     
    $RESOURCE = $SERVER-&gt;getResource ( "mta_php" ); # We need to get our resource Object 
     
    $RESULT[] = $RESOURCE-&gt;call ( "getAllPlayersForWebsite" ); 
  
    foreach ( $RESULT [ 0 ] [ 0 ] as $index=&gt;$playerName ) { 
        echo $playerName . "&lt;br /&gt;";    
    } 
  
#Catch any errors that occurred 
} catch ( Exception $e ){ 
    #Output error message 
    echo "&lt;strong&gt;Oops, Something went wrong!&lt;/strong&gt;&lt;br /&gt;Error: {$e-&gt;getMessage()}&lt;br /&gt;&lt;br /&gt;e printout:&lt;br /&gt;"; 
     
    #Print the error table 
    print_r ( $e ); 
} 
</pre>

		<div>
			 
		</div>
	</div>
</div>

<p>
	Thanks for viewing this.
</p>

<p>
	I will be updating the topic later to show how to call the SDK from the server, get inputs, and do returns later, when I get a chance.
</p>

<p>
	Please reply with any questions, concerns, or errors.
</p>
]]></description><guid isPermaLink="false">74834</guid><pubDate>Thu, 30 Apr 2015 19:16:26 +0000</pubDate></item><item><title>[TUT] Backsage's Sublime Text 3 and VS Code MTA Lua Syntax Highlighting (Notepad++ Theme)</title><link>https://forum.multitheftauto.com/topic/119429-tut-backsages-sublime-text-3-and-vs-code-mta-lua-syntax-highlighting-notepad-theme/</link><description><![CDATA[<p>
	This is a continuation of the topic originally posted by 50p for his Sublime Text 3 Syntax Highlighting package.<br>
	<br>
	I have edited 50p's Sublime Text 3 and MTA: SA Lua VS Code packages to my liking so it looks more like the original MTA Lua Notepad++ package that was made by JR10.
</p>

<p>
	Here's my edited version: 
</p>

<p>
	<a href="http://www.mediafire.com/file/gitph76wb6n7sbh/Backsages_Sublime_Text_3_and_VS_Code_MTA_Lua_Syntax_Highlighting_Packages_Notepad%252B%252B_Theme.rar/file" rel="external nofollow">http://www.mediafire.com/file/gitph76wb6n7sbh/Backsages_Sublime_Text_3_and_VS_Code_MTA_Lua_Syntax_Highlighting_Packages_Notepad%2B%2B_Theme.rar/file</a>
</p>

<p>
	If you still need a copy of the original packages they're here:<br>
	<a href="http://www.mediafire.com/file/1c11ct1y4z61ddu/50pMTAEditor_%2528original_by_50p%2529.zip/file" rel="external nofollow">http://www.mediafire.com/file/1c11ct1y4z61ddu/50pMTAEditor_%28original_by_50p%29.zip/file</a>
</p>

<p>
	<a href="https://marketplace.visualstudio.com/items?itemName=subtixx.mtasa-lua" rel="external nofollow">https://marketplace.visualstudio.com/items?itemName=subtixx.mtasa-Lua</a><br>
	If you are not a fan of white editor backgrounds, then don't use my edited packages. If however you are okay with white backgrounds, then you may like these packages. For Sublime Text 3, you will need to use a theme that I have provided. It mainly fixes the colors for the autocomplete labels and text in Find/Replace dialog box. For VS Code, it uses the Dark-MTA-Edit color theme, which is found in the "themes" folder of the package (Dark-MTA-Edit.json). You'll also need to use a settings.json file I have provided. It mainly fixes the colors of the UI of VS Code with the "workbench.colorCustomizations" token, although for Code I was not able to fix all the colors of the UI that I wanted to fix without the colors looking bad in other places, so you'll either have to live with it or find the tokens and edit the colors yourself. I have provided two variations of the packages in case one of the packages has colors that don't look right on one computer compared to another computer. If you have tried both packages on a computer and the colors still don't look right, you may need to modify the colors yourself so that they are fixed.<br>
	<br>
	To install for Sublime Text:<br>
	The files that are most important are Lua MTA.tmLanguage, Monokai-MTA-Edit.tmTheme, and the Backsage.sublime-theme.
</p>

<ul>
	<li>
		If you haven't already, download the package that was originally made by 50p here: <a href="http://www.mediafire.com/file/1c11ct1y4z61ddu/50pMTAEditor_%2528original_by_50p%2529.zip/file" rel="external nofollow">http://www.mediafire.com/file/1c11ct1y4z61ddu/50pMTAEditor_%28original_by_50p%29.zip/file</a>
	</li>
	<li>
		Navigate to the directory of the package. (C:\Users\&lt;user&gt;\AppData\Roaming\Sublime Text 3\Packages). You can also get there by going to Preferences &gt; Browse Packages in Sublime Text.
	</li>
	<li>
		Copy and paste the Lua MTA.tmLanguage and Monokai-MTA-Edit.tmTheme from my edited version to the original package. You should also rename the package to clarify that it is now an edited version.
	</li>
	<li>
		Copy and paste the folder containing the Backsage.sublime-theme into the C:\Users\&lt;user&gt;\AppData\Roaming\Sublime Text 3\Packages directory. Make sure the name of the folder is not "Theme - Default" and the name of the file is not "Default.sublime-theme", otherwise you may not be able to get the theme to show up or change when you try to change the theme (Preferences &gt; Theme). Basically, make sure the names are something completely different.
	</li>
	<li>
		(Preferences &gt; Theme) Change to Backsage.sublime-theme.
	</li>
	<li>
		(Preferences &gt; Color Scheme) Change to edited version of Monokai-MTA-Edit.
	</li>
	<li>
		And when opening and editing Lua files, go to View &gt; Syntax &gt; change to "Lua (MTA:SA) Backsage". You should see the changes instantly.
	</li>
</ul>

<p>
	It also helps to have the name of the syntax changed in the Lua MTA.tmLanguage so you know which syntax it is, in case you keep both the original and edited packages, but you can name it whatever you like. For files like .json, .xml, .tmLanguage, or any file that is like xml, you do not need to change the syntax to "Lua (MTA:SA) Backsage" when you open those files because when you open those files, the syntax highlighting colors will be applied automatically and you don't need to do anything else as long as the correct theme and color theme has been set. I had to use the scope inspector to input those scopes and define their colors. In Sublime Text, the scope inspector is Tools &gt; Developer &gt; Show Scope Name or Ctrl+Alt+Shift+P. In VS Code, the scope inspector is View &gt; Command Palette... &gt; Developer: Inspect TM Scopes or Ctrl+Shift+P.
</p>

<p>
	To install for VS Code:<br>
	The files that are most important are Dark-MTA-Edit.json, mtalua.tmLanguage.json, and the settings.json
</p>

<ul>
	<li>
		If you haven't already, download the extension for MTA Lua for VS Code here: <a href="https://marketplace.visualstudio.com/items?itemName=subtixx.mtasa-lua" rel="external nofollow">https://marketplace.visualstudio.com/items?itemName=subtixx.mtasa-Lua</a>
	</li>
	<li>
		On the Welcome page (Help &gt; Welcome) in Code, change the color theme to "Dark MTA Edit (Visual Studio)".
	</li>
	<li>
		Navigate to the directory of the extension (C:\Users\&lt;user&gt;\.vscode\extensions\subtixx.mtasa-Lua-2.3.6).
	</li>
	<li>
		Copy and paste the Dark-MTA-Edit.json and mtalua.tmLanguage.json files from the edited version into their respective folders of the original extension (themes and syntaxes).
	</li>
	<li>
		Copy and paste the settings.json into C:\Users\&lt;user&gt;\AppData\Roaming\Code\User. This is a settings file and inside it, it changes the colors of the UI (the editor background for example) with the "workbench.colorCustomizations" token and has other settings for Code.
	</li>
	<li>
		The changes should happen instantly. If not, you may need to restart Code to see the effects. You will notice the color changes with .Lua, .json and xml like files.
	</li>
</ul>

<p>
	 
</p>

<p>
	For Sublime Text, I also recommend getting the "BracketHighlighter" package for highlighting matching brackets. For VS Code, I recommend the "Subtle Match Brackets" extension. My packages also contain colors for the indentation guides (the little dots in the editor that distinguishes code blocks). In the Preferences.sublime-settings file (C:\Users\&lt;user&gt;\AppData\Roaming\Sublime Text 3\Packages\User) add this to the file to enable colors of indentation guides:
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<p>
			"indent_guide_options":<br>
			    [<br>
			        "draw_normal",<br>
			        "draw_active"<br>
			    ],
		</p>
	</div>
</blockquote>

<p>
	In the Monokai-MTA-Edit.tmTheme, you will see "stackGuide", "activeGuide", and "guide". Those are the colors for indentation guides which you can change. In the settings.json, you will see "editorIndentGuide.background" and "editorIndentGuide.activeBackground". Those are the colors for indentation guides which you can change.<br>
	<br>
	If there are any other scopes that you need to add or change, you can use the scope inspector and add or change them in the Monokai-MTA-Edit.tmTheme or Dark-MTA-Edit.json files.
</p>
]]></description><guid isPermaLink="false">119429</guid><pubDate>Thu, 15 Aug 2019 09:36:23 +0000</pubDate></item><item><title>[TUT] How to create Graphical User Interface [GUI] and upscaling</title><link>https://forum.multitheftauto.com/topic/128261-tut-how-to-create-graphical-user-interface-gui-and-upscaling/</link><description><![CDATA[
<p>
	 
</p>

<p>
	<strong>Hello</strong>, at the beginning, welcome to this tutorial created for<strong> amateurs who are unable to create their GUI </strong>and scale it properly to all resolutions<br />
	 
</p>

<p>
	To create a GUI, we need 4 arguments that will diversify our <strong>GUI</strong><br />
	 
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		<span>Spoiler</span>
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			<a href="https://wiki.multitheftauto.com/wiki/DxDrawImage" rel="external nofollow">https://wiki.multitheftauto.com/wiki/DxDrawImage<br />
			</a><a href="https://wiki.multitheftauto.com/wiki/DxDrawRectangle" rel="external nofollow">https://wiki.multitheftauto.com/wiki/DxDrawRectangle</a><br />
			<a href="https://wiki.multitheftauto.com/wiki/DxDrawText" rel="external nofollow">https://wiki.multitheftauto.com/wiki/DxDrawText</a>
		</p>
	</div>
</div>

<p>
	 
</p>

<p>
	Of course, the above-mentioned functions only work on the client side of the server, it will not work and now I will give you my way to scale the GUI for players, the point is that players can see the same <strong>arrangement of elements as I see</strong><br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> sW</span><span class="pun">,</span><span class="pln">sH </span><span class="pun">=</span><span class="pln"> guiGetScreenSize</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> yW</span><span class="pun">,</span><span class="pln">yH </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sW</span><span class="pun">/</span><span class="lit">1920</span><span class="pun">),(</span><span class="pln">sH</span><span class="pun">/</span><span class="lit">1080</span><span class="pun">)</span><span class="pln">

addEventHandler</span><span class="pun">(</span><span class="str">"onClientRender"</span><span class="pun">,</span><span class="pln">root</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">()</span><span class="pln">
dxDrawImage</span><span class="pun">(</span><span class="pln">yW</span><span class="pun">*</span><span class="lit">230</span><span class="pun">,</span><span class="pln">yH</span><span class="pun">*</span><span class="lit">420</span><span class="pun">,</span><span class="pln">yW</span><span class="pun">*</span><span class="lit">620</span><span class="pun">,</span><span class="pln">yH</span><span class="pun">*</span><span class="lit">340</span><span class="pun">,</span><span class="str">"images.png"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">end</span><span class="pun">)</span><span class="pln">
 </span><span class="com">--The image will be scaled as I see it to be visible to other players in the same way whether it is a hud or a dashboard   </span><span class="pln">
</span><span class="com">-- yW*230 Moves the element right 230 units</span><span class="pln">
</span><span class="com">-- yH*420 Moves the element down 430 units</span><span class="pln">
</span><span class="com">-- yW*620 Sets the element width by 630 units</span><span class="pln">
</span><span class="com">-- yH*340 Sets the element Height by 340 units</span></pre>

<p>
	 
</p>

<p>
	<u><em><strong>This is my first tutorial, so if there is any error, I am sorry, I tried to translate as best I can <img alt=":)" data-emoticon="" height="20" src="https://forum.multitheftauto.com/uploads/emoticons/smile.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/smile@2x.png 2x" title=":)" width="20" /> Greetings</strong></em></u>
</p>
]]></description><guid isPermaLink="false">128261</guid><pubDate>Wed, 25 Nov 2020 20:56:53 +0000</pubDate></item><item><title>Learning to Code With MTA:SA (Video)</title><link>https://forum.multitheftauto.com/topic/103040-learning-to-code-with-mtasa-video/</link><description><![CDATA[<p>
	I've decided to try creating tutorials to teach scripting from the ground up. I get asked this a lot as a developer at Owl Gaming, and I figured it would be something fun to try! I really believe that what you learn as a Multi Theft Auto developer will help you later in life. Personally I've been scripting MTA servers for the past six or seven years, and have turned that into a career in web development, where I now work at Weebly, one of the website builders you see frequently used by people for their MTA server. So give it a try, and if you get good, come join me as a developer at Owl and let's make something fun together.
</p>

<p>
	 
</p>

<p>
	In episode one, I cover the basics of setting up MTA for scripting your own server, and getting started with your first resources.
</p>

<div class="ipsEmbeddedVideo">
	<div>
		<iframe allowfullscreen="true" frameborder="0" height="270" width="480" data-embed-src="https://www.youtube.com/embed/videoseries?list=PLY2OlbN3OoCgTGO7kzQfIKPj4tJbYOgSR"></iframe>
	</div>
</div>

<p>
	 
</p>

<p>
	In episode two I cover at a high level data types, creating your first SQLite database, and improving upon our vehicles resource so we can restart it without deleting all of our created vehicles.
</p>

<div class="ipsEmbeddedVideo">
	<div>
		<iframe allowfullscreen="true" frameborder="0" height="270" width="480" data-embed-src="https://www.youtube.com/embed/XWHHavDS_go?feature=oembed"></iframe>
	</div>
</div>

<p>
	 
</p>
]]></description><guid isPermaLink="false">103040</guid><pubDate>Mon, 19 Feb 2018 15:46:25 +0000</pubDate></item><item><title>[TUT] Load maps using fetchRemote</title><link>https://forum.multitheftauto.com/topic/122023-tut-load-maps-using-fetchremote/</link><description><![CDATA[<p>
	Hi,
</p>

<p>
	I was testing <a href="https://wiki.multitheftauto.com/wiki/FetchRemote" rel="external nofollow">fetchRemote </a>function and decide to create script that's gonna load map from cloud / URL. I added some settings soo you can create the whole system out of this few lines of code.
</p>

<p>
	Also this resource is gonna need access to 'fetchRemote' function, simply add it in ACL and you can use it. There are 2 maps added so you can test it out.
</p>

<p>
	 
</p>

<p>
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">local</span><span class="pln"> customMapsRawData </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="pun">[</span><span class="str">"Trash on Grove Street"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"active"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="com">-- is map enabled or not</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"link"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"http://www.gubi.studio/tut/mta/trash-on-grove-street.txt"</span><span class="pun">,</span><span class="pln"> </span><span class="com">-- link to text file which contain whole data of your .map file</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"visibleTo"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> getRootElement</span><span class="pun">(),</span><span class="pln"> </span><span class="com">-- element which should see the map, can be player/getRootElement()</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"annoucment"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="com">-- if set to true will annouce on chat that map has been loaded</span><span class="pln">
	</span><span class="pun">},</span><span class="pln">

	</span><span class="pun">[</span><span class="str">"Shop on Grove Street"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"active"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"link"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"http://www.gubi.studio/tut/mta/shop-on-grove-street.txt"</span><span class="pun">,</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"visibleTo"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> getRootElement</span><span class="pun">(),</span><span class="pln">
		</span><span class="pun">[</span><span class="str">"annoucment"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> createMapFromRawData</span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> error</span><span class="pun">,</span><span class="pln"> mapName</span><span class="pun">,</span><span class="pln"> annoucment</span><span class="pun">,</span><span class="pln"> visibleTo</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> error </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
		loadMapData</span><span class="pun">(</span><span class="pln">xmlLoadString</span><span class="pun">(</span><span class="pln">data</span><span class="pun">),</span><span class="pln"> visibleTo</span><span class="pun">)</span><span class="pln">
		outputDebugString</span><span class="pun">(</span><span class="str">"Map "</span><span class="pun">..</span><span class="pln">mapName</span><span class="pun">..</span><span class="str">" has been loaded!"</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> annoucment </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
			outputChatBox</span><span class="pun">(</span><span class="str">"Map "</span><span class="pun">..</span><span class="pln">mapName</span><span class="pun">..</span><span class="str">" has been loaded!"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln">
		outputDebugString</span><span class="pun">(</span><span class="str">"Map "</span><span class="pun">..</span><span class="pln">mapName</span><span class="pun">..</span><span class="str">" failed while loading! Check if link is valid!"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> loadCustomMaps</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> hasObjectPermissionTo</span><span class="pun">(</span><span class="pln">getThisResource</span><span class="pun">(),</span><span class="pln"> </span><span class="str">"fetchRemote"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
			outputDebugString</span><span class="pun">(</span><span class="str">"This resource needs access to \"fetchRemote\" in ACL!"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> mapName</span><span class="pun">,</span><span class="pln"> mapData </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln">customMapsRawData</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> mapData</span><span class="pun">[</span><span class="str">"active"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
				fetchRemote</span><span class="pun">(</span><span class="pln">mapData</span><span class="pun">[</span><span class="str">"link"</span><span class="pun">],</span><span class="pln"> createMapFromRawData</span><span class="pun">,</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> mapName</span><span class="pun">,</span><span class="pln"> mapData</span><span class="pun">[</span><span class="str">"annoucment"</span><span class="pun">],</span><span class="pln"> mapData</span><span class="pun">[</span><span class="str">"visibleTo"</span><span class="pun">])</span><span class="pln">
		</span><span class="kwd">end</span><span class="pln">
	</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addEventHandler</span><span class="pun">(</span><span class="str">"onResourceStart"</span><span class="pun">,</span><span class="pln"> getResourceRootElement</span><span class="pun">(</span><span class="pln">getThisResource</span><span class="pun">()),</span><span class="pln"> loadCustomMaps</span><span class="pun">)</span></pre>

<p>
	 
</p>
]]></description><guid isPermaLink="false">122023</guid><pubDate>Sun, 19 Jan 2020 19:31:37 +0000</pubDate></item><item><title>[TUT] How to Create ID System by Database</title><link>https://forum.multitheftauto.com/topic/112941-tut-how-to-create-id-system-by-database/</link><description><![CDATA[<p>
	Yesterday evening, I started my apprenticeship with db, I always wanted to learn, because with it, I can do mods, which I could not do without.
</p>

<p>
	My introduction with Database was done by adapting a System ID to the DB in the login panel. I did this using the server-side of my login panel.
</p>

<p>
	The first thing we do, is to use<a href="https://wiki.multitheftauto.com/wiki/DbConnect" rel="external nofollow"> dbConnect</a> (Wiki), which will make the connection to the db file.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbConnect" rel="external nofollow">dbConnect</a></span></span><span class="pun">(</span><span class="str">"sqlite"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"db/royalusers.db"</span><span class="pun">)</span></pre>

<p>
	It will create the "db" folder, in the resource files, and inside the folder, the "royalusers.db" file.
</p>

<p>
	 
</p>

<p>
	After that, we create a table using the SQL functions.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> newTable </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="pln">db</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CREATE TABLE IF NOT EXISTS RoyalUsers (id INT, name TEXT, login TEXT, pass TEXT, serial TEXT)"</span><span class="pun">)</span></pre>

<p>
	<span style="color:#c0392b;">RoyalUsers - Table-name</span>
</p>

<p>
	<span style="color:#c0392b;">id INT, name TEXT, login TEXT, pass TEXT, serial TEXT - columns of the table.</span>
</p>

<p>
	<span style="color:#c0392b;">INT - INTERNAL NUMBER</span>
</p>

<p>
	 
</p>

<p>
	Now the part of using the table defined in the database.
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> registerPlayer</span><span class="pun">(</span><span class="pln">user</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">,</span><span class="pln"> conf</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> user </span><span class="pun">==</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Preencha todos os campos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln"> 
    </span><span class="kwd">else</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pln"> pass </span><span class="pun">==</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Preencha todos os campos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln"> 
        </span><span class="kwd">else</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> conf </span><span class="pun">==</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Preencha todos os campos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln"> 
            </span><span class="kwd">else</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> conf </span><span class="pun">==</span><span class="pln"> pass </span><span class="kwd">then</span><span class="pln">
                    <span><a href="https://wiki.multitheftauto.com/wiki/addAccount" rel="external nofollow">addAccount</a></span></span><span class="pun">(</span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring" rel="external nofollow">tostring</a></span></span><span class="pun">(</span><span class="pln">user</span><span class="pun">),</span><span class="pln"><span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-tostring" rel="external nofollow">tostring</a></span></span><span class="pun">(</span><span class="pln">pass</span><span class="pun">))</span><span class="pln">
                    <span><a href="https://wiki.multitheftauto.com/wiki/triggerClientEvent" rel="external nofollow">triggerClientEvent</a></span></span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"onRoyalRegister"</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="pln">db</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM RoyalUsers WHERE login=?"</span><span class="pun">,</span><span class="pln"> user</span><span class="pun">),</span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">#</span><span class="pln">query </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                        <span><a href="https://wiki.multitheftauto.com/wiki/dbExec" rel="external nofollow">dbExec</a></span></span><span class="pun">(</span><span class="pln">db</span><span class="pun">,</span><span class="pln"> </span><span class="str">"INSERT INTO RoyalUsers VALUES (?, ?, ?, ?, ?)"</span><span class="pun">,</span><span class="pln"> countIDs</span><span class="pun">(),</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getPlayerName" rel="external nofollow">getPlayerName</a></span></span><span class="pun">(</span><span class="pln">source</span><span class="pun">),</span><span class="pln"> user</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">,</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getPlayerSerial" rel="external nofollow">getPlayerSerial</a></span></span><span class="pun">(</span><span class="pln">source</span><span class="pun">))</span><span class="pln">      
                    </span><span class="kwd">end</span><span class="pln">
                    outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Conta criada com sucesso! Aguarde..."</span><span class="pun">,</span><span class="pln"> </span><span class="str">"success"</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/getAccount" rel="external nofollow">getAccount</a></span></span><span class="pun">(</span><span class="pln">user</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                        outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Esta conta já está sendo utilizada!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">end</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln">
                    outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"As senhas não estão iguais."</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">end</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln"> 
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEvent" rel="external nofollow">addEvent</a></span></span><span class="pun">(</span><span class="str">"onPlayerRequestRegister"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
<span><a href="https://wiki.multitheftauto.com/wiki/addEventHandler" rel="external nofollow">addEventHandler</a></span></span><span class="pun">(</span><span class="str">"onPlayerRequestRegister"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> registerPlayer</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> countIDs</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/table" rel="external nofollow">table</a></span> </span><span class="pun">=</span><span class="pln"> <span><a href="https://wiki.multitheftauto.com/wiki/dbPoll" rel="external nofollow">dbPoll</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/dbQuery" rel="external nofollow">dbQuery</a></span></span><span class="pun">(</span><span class="pln">db</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM RoyalUsers"</span><span class="pun">),</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> result </span><span class="kwd">in</span><span class="pln"> <span><a href="http://www.lua.org/manual/5.1/manual.html#pdf-pairs" rel="external nofollow">pairs</a></span></span><span class="pun">(</span><span class="pln"><span><a href="https://wiki.multitheftauto.com/wiki/table" rel="external nofollow">table</a></span></span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
        count </span><span class="pun">=</span><span class="pln"> count </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> count
</span><span class="kwd">end</span></pre>

<p>
	The login variable returns a table, it selects (<span style="color:#c0392b;">SELECT</span>) all the columns of the table, and checks if the login defined in the function does not exist in it, if it does not exist, it will add those information, the columns of the table RoyalUsers (<span style="color:#c0392b;">INSERT INTO</span>).
</p>

<p>
	<span style="color:#c0392b;">VALUES (?, ?, ?, ?, ?) - "?" It is the amount of arguments that will be used to insert into the column.</span>
</p>

<p>
	<span style="color:#c0392b;">countIDs() - Function that returns the number of IDs in the table, and adds one more.</span>
</p>

<p>
	<span style="color:#c0392b;">getPlayerName(source) - Gets the player's name, and adds the "name" column of the table.</span>
</p>

<p>
	<span style="color:#c0392b;">user - Adds the user defined in the function, the column "login".</span>
</p>

<p>
	<span style="color:#c0392b;">pass - Adds the password set in the function, the "pass" column.</span>
</p>

<p>
	<span style="color:#c0392b;">getPlayerSerial(source) - Gets the player's serial, and adds the "serial" column of the table.</span>
</p>

<p>
	 
</p>

<p>
	<span>Having the part in which the data that the player registers, are saved in the database, this part is ready.<br>
	Now, just set the ID added to the database login, when the player logs in.</span>
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> loginPlayer</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> user</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> user </span><span class="pun">==</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Preencha todos os campos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln"> 
    </span><span class="kwd">else</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pln"> pass </span><span class="pun">==</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Preencha todos os campos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln"> 
        </span><span class="kwd">else</span><span class="pln">
                </span><span class="kwd">local</span><span class="pln"> account </span><span class="pun">=</span><span class="pln"> getAccount</span><span class="pun">(</span><span class="pln">user</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> account </span><span class="kwd">then</span><span class="pln">
                    logIn</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> account</span><span class="pun">,</span><span class="pln"> pass</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">local</span><span class="pln"> queryTable </span><span class="pun">=</span><span class="pln"> dbPoll</span><span class="pun">(</span><span class="pln">dbQuery</span><span class="pun">(</span><span class="pln">db</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SELECT * FROM RoyalUsers WHERE login='"</span><span class="pun">..</span><span class="pln">getAccountName</span><span class="pun">(</span><span class="pln">getPlayerAccount</span><span class="pun">(</span><span class="pln">source</span><span class="pun">))..</span><span class="str">"'"</span><span class="pun">),</span><span class="pln"> </span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> id </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln">queryTable</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
                        setElementData</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ID"</span><span class="pun">,</span><span class="pln"> id</span><span class="pun">[</span><span class="str">"id"</span><span class="pun">])</span><span class="pln">
                    </span><span class="kwd">end</span><span class="pln">
                    setTimer</span><span class="pun">(</span><span class="pln">setCameraTarget</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3000</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">)</span><span class="pln">
                    setTimer</span><span class="pun">(</span><span class="pln">triggerClientEvent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">14000</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"renderRoyalID"</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">)</span><span class="pln">
                    triggerClientEvent</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"onRoyalLogin"</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">)</span><span class="pln">
                    outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Logado com sucesso! Aguarde..."</span><span class="pun">,</span><span class="pln"> </span><span class="str">"success"</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln">
                    outputLoginMsg</span><span class="pun">(</span><span class="pln">source</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Usuário ou senha incorretos!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"error"</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">end</span><span class="pln">   
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addEvent</span><span class="pun">(</span><span class="str">"onPlayerRequestLogin"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span></pre>

<p>
	The queryTable gets all the columns of the table, where the login = login of the player.
</p>

<p>
	After that, we loop the tables returned by the <span style="color:#c0392b;">queryTable</span>, and set the date "ID" to the player, according to the ID returned from the table defined in the loop.
</p>

<p>
	 
</p>

<p>
	<span style="color:#2980b9;">I want to make it clear that the tutorial did not go well explained, I just want to share, what I learned yesterday, and if I did something wrong, please let me know. <img src="https://twemoji.maxcdn.com/2/72x72/2764.png" class="ipsEmoji" alt="❤️"></span>
</p>
]]></description><guid isPermaLink="false">112941</guid><pubDate>Sun, 25 Nov 2018 18:08:33 +0000</pubDate></item><item><title>[TUT] Send messages to Discord from MTA with Webhooks  (This only works with MTA Server version 1.5.6 or higher!)</title><link>https://forum.multitheftauto.com/topic/113660-tut-send-messages-to-discord-from-mta-with-webhooks-this-only-works-with-mta-server-version-156-or-higher/</link><description><![CDATA[
<p style="text-align:center;">
	<span style="font-size:18px;"><strong>Send message to Discord from MTA:SA</strong></span><br />
	<br />
	<em><span style="font-size:16px;">STEP I.</span></em><br />
	Make a new webhook on your Discord server<br />
	<br />
	<img alt="MQkH659.gif" class="ipsImage" data-ratio="61.50" height="419" style="height:auto;" width="1000" data-src="https://i.imgur.com/MQkH659.gif" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" /><br />
	<br />
	<em><span style="font-size:16px;">STEP II.</span></em><br />
	Change the variable to your webhook URL.
</p>

<p style="text-align:center;">
	<img alt="w7Imjns.gif" class="ipsImage" data-ratio="75.08" height="501" style="height:auto;" width="1000" data-src="https://i.imgur.com/w7Imjns.gif" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" />
</p>

<p style="text-align:center;">
	<em><span style="font-size:16px;">STEP III.</span></em><br />
	Start the resource, and test it with the <strong>/dcmessage &lt;string&gt; </strong>command, or use it with another script using the following export:<br />
	 
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">exports</span><span class="pun">.</span><span class="pln">webhook</span><span class="pun">:</span><span class="pln">sendDiscordMessage</span><span class="pun">(</span><span class="str">"string"</span><span class="pun">)</span></pre>

<div>
	<hr />
</div>

<div style="text-align:center;">
	<span style="font-size:20px;"><a href="https://github.com/preilakos/mtasa-dcwebhook" rel="external nofollow">Download the script here.</a></span><span> </span>
</div>
]]></description><guid isPermaLink="false">113660</guid><pubDate>Sun, 30 Dec 2018 01:40:57 +0000</pubDate></item><item><title>useful function i think</title><link>https://forum.multitheftauto.com/topic/125744-useful-function-i-think/</link><description><![CDATA[<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">
</span><span class="kwd">local</span><span class="pln"> texts</span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
</span><span class="kwd">local</span><span class="pln"> counter </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> createBlipText</span><span class="pun">(</span><span class="pln">text</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">size</span><span class="pun">,</span><span class="pln">color</span><span class="pun">,</span><span class="pln">font </span><span class="pun">,</span><span class="pln">rot</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> size </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">1.3</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> font </span><span class="pun">=</span><span class="pln"> font </span><span class="kwd">or</span><span class="pln"> </span><span class="str">"default"</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> color </span><span class="pun">=</span><span class="pln"> color </span><span class="kwd">or</span><span class="pln"> tocolor</span><span class="pun">(</span><span class="lit">255</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">255</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> rot </span><span class="pun">=</span><span class="pln"> rot </span><span class="kwd">or</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    texts</span><span class="pun">[</span><span class="pln">counter</span><span class="pun">]={</span><span class="pln">text</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">size</span><span class="pun">,</span><span class="pln">font </span><span class="pun">,</span><span class="pln">rot</span><span class="pun">,</span><span class="pln">color</span><span class="pun">}</span><span class="pln">
    counter </span><span class="pun">=</span><span class="pln"> counter</span><span class="lit">+1</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> texts</span><span class="pun">[</span><span class="pln">counter</span><span class="lit">-1</span><span class="pun">]</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> blip </span><span class="pun">=</span><span class="pln"> createBlipText</span><span class="pun">(</span><span class="str">"Test"</span><span class="pln"> </span><span class="pun">,</span><span class="lit">591.02747</span><span class="pun">,</span><span class="pln"> </span><span class="lit">871.34741</span><span class="pln"> </span><span class="pun">)</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> screenSize </span><span class="pun">=</span><span class="pln"> Vector2</span><span class="pun">(</span><span class="pln">guiGetScreenSize</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> drawWorldPosMapText</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> isPlayerMapVisible</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">

        </span><span class="kwd">for</span><span class="pln"> k </span><span class="pun">,</span><span class="pln">v </span><span class="kwd">in</span><span class="pln"> pairs</span><span class="pun">(</span><span class="pln"> texts </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">

            </span><span class="kwd">local</span><span class="pln"> worldPos </span><span class="pun">=</span><span class="pln"> Vector2</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">3</span><span class="pun">])</span><span class="pln"> 
            </span><span class="kwd">local</span><span class="pln"> mapMin</span><span class="pun">,</span><span class="pln"> mapMax
            </span><span class="kwd">do</span><span class="pln">
                </span><span class="kwd">local</span><span class="pln"> mx</span><span class="pun">,</span><span class="pln"> my</span><span class="pun">,</span><span class="pln"> Mx</span><span class="pun">,</span><span class="pln"> My </span><span class="pun">=</span><span class="pln"> getPlayerMapBoundingBox</span><span class="pun">()</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> mx </span><span class="kwd">then</span><span class="pln">
                    mapMin </span><span class="pun">=</span><span class="pln"> Vector2</span><span class="pun">(</span><span class="pln">mx</span><span class="pun">,</span><span class="pln"> my</span><span class="pun">)</span><span class="pln">
                    mapMax </span><span class="pun">=</span><span class="pln"> Vector2</span><span class="pun">(</span><span class="pln">Mx</span><span class="pun">,</span><span class="pln"> My</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln">
                    </span><span class="kwd">return</span><span class="pln">
                </span><span class="kwd">end</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">

            </span><span class="kwd">local</span><span class="pln"> fMx</span><span class="pun">,</span><span class="pln"> fMy </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">worldPos</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">6000</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-(</span><span class="pln">worldPos</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">3000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">6000</span><span class="pln">
            </span><span class="kwd">local</span><span class="pln"> fmx</span><span class="pun">,</span><span class="pln"> fmy </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> fMx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> fMy

            </span><span class="kwd">local</span><span class="pln"> screenMapPos </span><span class="pun">=</span><span class="pln"> Vector2</span><span class="pun">((</span><span class="pln">fmx </span><span class="pun">*</span><span class="pln"> mapMin</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fMx </span><span class="pun">*</span><span class="pln"> mapMax</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fmy </span><span class="pun">*</span><span class="pln"> mapMin</span><span class="pun">.</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fMy </span><span class="pun">*</span><span class="pln"> mapMax</span><span class="pun">.</span><span class="pln">y</span><span class="pun">))</span><span class="pln">

            </span><span class="kwd">if</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> screenSize</span><span class="pun">.</span><span class="pln">x </span><span class="kwd">and</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&lt;=</span><span class="pln"> screenSize</span><span class="pun">.</span><span class="pln">y </span><span class="kwd">then</span><span class="pln">
                </span><span class="kwd">local</span><span class="pln"> width </span><span class="pun">=</span><span class="pln"> dxGetTextWidth</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln">v</span><span class="pun">[</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">5</span><span class="pun">])</span><span class="pln">
                dxDrawText</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">width </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">width </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">),</span><span class="pln"> screenMapPos</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">7</span><span class="pun">],</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> v</span><span class="pun">[</span><span class="lit">5</span><span class="pun">],</span><span class="pln"> </span><span class="str">"center"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"center"</span><span class="pln"> </span><span class="pun">,</span><span class="kwd">false</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">v</span><span class="pun">[</span><span class="lit">6</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">

        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addEventHandler</span><span class="pun">(</span><span class="str">"onClientRender"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> drawWorldPosMapText</span><span class="pun">)</span></pre>

<p>
	 
</p>
]]></description><guid isPermaLink="false">125744</guid><pubDate>Fri, 26 Jun 2020 21:48:44 +0000</pubDate></item><item><title>[Useful Function] fade in/out loop for gui windows</title><link>https://forum.multitheftauto.com/topic/124868-useful-function-fade-inout-loop-for-gui-windows/</link><description><![CDATA[<p>
	this function will fade out your window till it disapperas then it will be fade in till it being fully visable
</p>

<p>
	you can edit it to be fade in/out when command triggerd or bindkey pressed
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">fadeStatus </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> fading</span><span class="pun">()</span><span class="pln">
     </span><span class="kwd">local</span><span class="pln"> fadeRatioPerRender </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.005</span><span class="pln">
     </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fadeStatus </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
          </span><span class="kwd">local</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> guiGetAlpha</span><span class="pun">(</span><span class="pln">window_logo</span><span class="pun">)</span><span class="pln">
          guiSetAlpha</span><span class="pun">(</span><span class="pln">window_logo</span><span class="pun">,</span><span class="pln"> alpha</span><span class="pun">-</span><span class="pln">fadeRatioPerRender</span><span class="pun">)</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">alpha </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
               fadeStatus </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
          </span><span class="kwd">end</span><span class="pln">
     </span><span class="kwd">else</span><span class="pln">
          </span><span class="kwd">local</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> guiGetAlpha</span><span class="pun">(</span><span class="pln">window_logo</span><span class="pun">)</span><span class="pln">
          guiSetAlpha</span><span class="pun">(</span><span class="pln">window_logo</span><span class="pun">,</span><span class="pln"> alpha</span><span class="pun">+</span><span class="pln">fadeRatioPerRender</span><span class="pun">)</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">alpha </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
               fadeStatus </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
          </span><span class="kwd">end</span><span class="pln">
     </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
addEventHandler</span><span class="pun">(</span><span class="str">"onClientRender"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> fading</span><span class="pun">)</span></pre>

<p>
	 
</p>
]]></description><guid isPermaLink="false">124868</guid><pubDate>Sun, 17 May 2020 04:51:36 +0000</pubDate></item><item><title>[TUT] Lua Strings</title><link>https://forum.multitheftauto.com/topic/75680-tut-lua-strings/</link><description><![CDATA[<div style="text-align:center;">
	<img alt="Sans_titre_1.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/s1yng8m2v/Sans_titre_1.png"></div>

<div style="text-align:center;">
	<p>
		 
	</p>

	<div style="border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
		<a href="https://forum.multitheftauto.com/viewtopic.php?f=148&amp;t=88427" rel=""><img alt="Sans_titre_7.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/sns7q36ir/Sans_titre_7.png"></a><a href="https://forum.multitheftauto.com/viewtopic.php?f=148&amp;t=87781" rel=""><img alt="Sans_titre_8.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/f9jq7sp8j/Sans_titre_8.png"></a><a href="https://forum.multitheftauto.com/viewtopic.php?f=148&amp;t=88385" rel=""><img alt="Sans_titre_9.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/hpgy7whxf/Sans_titre_9.png"></a>
	</div>
</div>

<p>
	Hello Guys it's me again, As the tittle says today i'm going to explain to you LUA Strings try to follow me till the end.
</p>

<p>
	Let's get started , String is a sequence of characters it can be initialized with three forms which includes:
</p>

<p>
	 
</p>

<div style="background-color:#CC6600;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<span style="color:#FFFFFF;">Characters between single 'quotes' :</span> Example <span style="color:#40FFFF;"><strong>'</strong></span><span style="color:#40FFFF;">This is The First Text</span><span style="color:#40FFFF;"><strong>'</strong></span>
</div>

<div style="background-color:#CC6600;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<span style="color:#FFFFFF;">Characters between double "quotes" :</span> Example <span style="color:#40FFFF;"><strong>"</strong></span><span style="color:#40FFFF;">This is The Second Text</span><span style="color:#40FFFF;"><strong>"</strong></span>
</div>

<div style="background-color:#CC6600;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
	<span style="color:#FFFFFF;">Characters between double [[square brackets]] :</span> Example <span style="color:#40FFFF;"><strong>[[</strong></span><span style="color:#40FFFF;">This is The Third Text</span><span style="color:#40FFFF;"><strong>]]</strong></span>
</div>

<p>
	 
</p>

<p>
	An other example for the above three forms are shown below.
</p>

<pre class="prettyprint ipsCode prettyprinted">
<span>Text</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">   
</span><span>Text</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'MTA SA'</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Single</span><span class="pln"> quotes 
</span><span>Text</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"The Greatest Game"</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Double</span><span class="pln"> quotes 
</span><span>Text</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[</span><span>You</span><span class="pln"> </span><span>Will</span><span class="pln"> </span><span>Ever</span><span class="pln"> </span><span>Play</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Double</span><span class="pln"> square brackets 
  
</span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,#</span><span>Text</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">  
     outputChatBox</span><span class="pun">(</span><span>Text</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> 
</span><span class="kwd">end</span><span class="pln">  
  
</span><span class="pun">--[[</span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> 
MTA SA 
</span><span>The</span><span class="pln"> </span><span>Greatest</span><span class="pln"> </span><span>Game</span><span class="pln"> 
</span><span>You</span><span class="pln"> </span><span>Will</span><span class="pln"> </span><span>Ever</span><span class="pln"> </span><span>Play</span><span class="pun">]]</span><span class="pln"> </span></pre>

<div>
	 
</div>

<p>
	 
</p>

<p>
	<img alt="Sans_titre_2.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/ygxocwssn/Sans_titre_2.png"></p>

<p>
	Escape sequence characters are used in string to change the normal interpretation of character. for more information check the list below:
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<table cellpadding="10" style="margin:1em;table-layout:fixed;width:100%;"><tbody><tr><th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
						Escape Sequence
					</th>
					<th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
						Use
					</th>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\a
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						bell
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\b
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						back space
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\f
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						form feed
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\n
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						newline
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\r
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						carriage return
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\t
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						horizontal tab
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\v
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						vertical tab
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\\
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						backslash
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\"
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						double quote
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\'
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						single quote
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\[
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						left square bracket
					</td>
				</tr><tr><td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						\]
					</td>
					<td align="left" style="padding:.3em;border:1px #ccc solid;background-color:#FFFFcc;">
						right square bracket
					</td>
				</tr></tbody></table><p>
			 
		</p>

		<p>
			Some Examples:
		</p>

		<p>
			1) Newline
		</p>

		<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> Test1 </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello \nCommunity"</span><span class="pln">  
<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="pln">Test1</span><span class="pun">)</span><span class="pln">  
</span><span class="com">--[[ Result : 
Hello 
Community]]</span><span class="pln"> </span></pre>

		<div>
			2) Single quote
		</div>

		<div>
			<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/local" rel="external nofollow">local</a></span></span><span class="pln"> Test2 </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello \'Community\'"</span><span class="pln">  
<span><a href="https://wiki.multitheftauto.com/wiki/outputChatBox" rel="external nofollow">outputChatBox</a></span></span><span class="pun">(</span><span class="pln">Test2</span><span class="pun">)</span><span class="pln">  
</span><span class="com">--[[ Result : 
Hello 'Community']]</span><span class="pln"> </span></pre>

			<p>
				3) Left/right square bracket
			</p>

			<pre class="ipsCode prettyprint lang-lua prettyprinted">

<span class="kwd">local</span><span class="pln"> Test3 </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hello \[Community\]"</span><span class="pln">  
outputChatBox</span><span class="pun">(</span><span class="pln">Test3</span><span class="pun">)</span><span class="pln">  
</span><span class="com">--[[ Result : 
Hello [Community] ]]</span><span class="pln"> </span></pre>

			<p>
				 
			</p>
		</div>
	</div>

	<p>
		<img alt="Sans_titre_3.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/6i3im1r5z/Sans_titre_3.png"></p>

	<ol style="list-style-type:decimal;"><li>
			<span style="text-decoration:underline;">Case Manipulation:</span>

			<div class="ipsSpoiler" data-ipsspoiler="">
				<div class="ipsSpoiler_header">
					 
				</div>

				<div class="ipsSpoiler_contents">
					<div style="text-align:center;">
						<p>
							 
						</p>
						 

						<table cellpadding="10" style="margin:1em;table-layout:fixed;width:100%;"><tbody><tr><th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
										<span style="color:#FF8000;">string.upper(arg)</span>

										<p>
											 
										</p>
										<br>
										Make all the lower case characters upper case
									</th>
									<th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
										<span style="color:#FF8000;">string.lower(arg)</span><br>
										Make uppercase characters lower case.
									</th>
								</tr></tbody></table></div>

					<p>
						<br>
						Example:<br>
						 
					</p>

					<div>
						<a style="padding-left:5px;text-decoration:none;" rel="">?</a>

						<pre class="prettyprint ipsCode prettyprinted">
 </pre>

						<ol><li>
								<span class="pln"> </span>
							</li>
						</ol></div>

					<ol><li>
							local Word = "Mta";
						</li>
						<li>
							outputChatBox(string.upper(Word)) -- Result : MTA
						</li>
						<li>
							outputChatBox(string.lower(Word)) -- Result : mta
						</li>
					</ol><div>
						 
					</div>
				</div>
			</div>
		</li>
		<li>
			<span style="text-decoration:underline;">Replacing a substring:</span>
			<div class="ipsSpoiler" data-ipsspoiler="">
				<div class="ipsSpoiler_header">
					 
				</div>

				<div class="ipsSpoiler_contents">
					<div style="text-align:center;">
						<p>
							[divbox=#404040]<strong><span style="color:#FF8000;">string.gsub(mainString,findString,replaceString)</span></strong>
						</p>
						<br><strong><span style="color:#FFFFFF;">Returns a string by replacing occurrences of findString with replaceString.</span></strong>
					</div>
				</div>

				<p>
					<br>
					 <br>
					Example:<br>
					 
				</p>

				<div>
					<a style="padding-left:5px;text-decoration:none;" rel="">?</a>

					<pre class="prettyprint ipsCode prettyprinted">
 </pre>

					<ol><li>
							<span class="pln"> </span>
						</li>
					</ol></div>

				<ol><li>
						local Text = "I love playing MTA"
					</li>
					<li>
						local NewText = string.gsub(Text,"MTA","FootBall")
					</li>
					<li>
						outputChatBox(NewText) -- Result : I love playing FootBall
					</li>
				</ol><div>
					 
				</div>
			</div>
		</li>
	</ol></div>

<ul><li>
		<span style="text-decoration:underline;">Finding</span>

		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				 
			</div>

			<div class="ipsSpoiler_contents">
				<div style="text-align:center;">
					<p>
						 
					</p>

					<div style="background-color:#404040;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
						<strong><span style="color:#FF8000;">string.find(string, pattern , index , plain)</span></strong><br><strong><span style="color:#FFFFFF;">Returns the start index and end index of the pattern in the main string.</span></strong>
					</div>
				</div>

				<p>
					<br>
					Example:<br>
					 
				</p>

				<pre class="prettyprint ipsCode prettyprinted">

<span class="kwd">local</span><span class="pln"> </span><span>Text</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Nice to meet you"</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span>Text</span><span class="pun">,</span><span class="str">"meet"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pun">:</span><span class="pln"> </span><span class="lit">9</span><span class="pln">   </span><span class="lit">12</span><span class="pln"> </span></pre>

				<div>
					 
				</div>
			</div>
		</div>
	</li>
	<li>
		<span style="text-decoration:underline;">Reversing:</span>
		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				 
			</div>

			<div class="ipsSpoiler_contents">
				<div style="text-align:center;">
					<p>
						 
					</p>

					<div style="background-color:#404040;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
						<strong><span style="color:#FF8000;">string.reverse(argument)</span></strong><br><strong><span style="color:#FFFFFF;">Reverses a string.</span></strong>
					</div>
				</div>

				<p>
					<br>
					Example:
				</p>

				<pre class="prettyprint ipsCode prettyprinted">

<span class="kwd">local</span><span class="pln"> </span><span>String</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"MTA"</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="pln">reverse</span><span class="pun">(</span><span>String</span><span class="pun">))</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> ATM </span></pre>

				<div>
					 
				</div>
			</div>
		</div>
	</li>
	<li>
		<span style="text-decoration:underline;">Formatting strings:</span>
		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				 
			</div>

			<div class="ipsSpoiler_contents">
				<div style="text-align:center;">
					<p>
						 
					</p>

					<div style="background-color:#404040;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
						<strong><span style="color:#FF8000;">string.format(s, ar1, ar2, ...)</span></strong><br><strong><span style="color:#FFFFFF;">Returns a formatted string.</span></strong>
					</div>
				</div>

				<p>
					 
				</p>

				<pre class="prettyprint ipsCode prettyprinted">

<span class="pun">--</span><span class="pln"> </span><span>Date</span><span class="pln"> </span><span>Format</span><span class="pln"> 
</span><span class="kwd">local</span><span class="pln"> date </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> 
</span><span class="kwd">local</span><span class="pln"> month </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> 
</span><span class="kwd">local</span><span class="pln"> year </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2020</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="str">"Date  %02d/%02d/%03d"</span><span class="pun">,</span><span class="pln"> date</span><span class="pun">,</span><span class="pln"> month</span><span class="pun">,</span><span class="pln"> year</span><span class="pun">))</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pun">:</span><span class="pln"> </span><span>Date</span><span class="pln"> </span><span class="lit">03</span><span class="pun">/</span><span class="lit">02</span><span class="pun">/</span><span class="lit">2020</span><span class="pln"> </span></pre>

				<div>
					 
				</div>
			</div>
		</div>
	</li>
	<li>
		<span style="text-decoration:underline;">Character and byte:</span>
		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				 
			</div>

			<div class="ipsSpoiler_contents">
				<div style="text-align:center;">
					<table cellpadding="10" style="line-height:1.6;margin:1em;table-layout:fixed;width:100%;"><tbody><tr><th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
									<span style="color:#FF8000;">string.char(str)</span> | <span style="color:#FF8000;">string.byte(str)</span><br>
									Returns internal numeric and character respresentations
								</th>
							</tr></tbody></table></div>

				<p>
					<br>
					Example:
				</p>

				<pre class="prettyprint ipsCode prettyprinted">

<span class="kwd">local</span><span class="pln"> </span><span>Char</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">.</span><span class="kwd">char</span><span class="pun">(</span><span class="lit">65</span><span class="pun">,</span><span class="lit">66</span><span class="pun">,</span><span class="lit">67</span><span class="pun">)</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span>Char</span><span class="pun">)</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> ABC 
  
</span><span class="kwd">local</span><span class="pln"> </span><span>Byte</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">.</span><span class="kwd">byte</span><span class="pun">(</span><span class="str">"ABCDE"</span><span class="pun">)</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span>Byte</span><span class="pun">)</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">65</span><span class="pln"> </span></pre>

				<div>
					 
				</div>
			</div>
		</div>
	</li>
	<li>
		<span style="text-decoration:underline;">Last function:</span>
		<div class="ipsSpoiler" data-ipsspoiler="">
			<div class="ipsSpoiler_header">
				 
			</div>

			<div class="ipsSpoiler_contents">
				<div style="text-align:center;">
					<table cellpadding="10" style="line-height:1.6;margin:1em;table-layout:fixed;width:100%;"><tbody><tr><th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
									<span style="color:#FF8000;">string.len(string)</span><br>
									Check the length of the passed string.
								</th>
								<th style="color:#FFFFFF;padding:.3em;border:1px;background:#4F4F4F;">
									<span style="color:#FF8000;">string.rep(string, nunber))</span><br>
									Repeating the same string many times.
								</th>
							</tr></tbody></table></div>

				<p>
					<br>
					Example:
				</p>

				<pre class="prettyprint ipsCode prettyprinted">

<span>Local</span><span class="pln"> </span><span>String</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"MTA"</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="pln">len</span><span class="pun">(</span><span>String</span><span class="pun">))</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> 
outputChatBox</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="pln">rep</span><span class="pun">(</span><span>String</span><span class="pun">,</span><span class="lit">4</span><span class="pun">))</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span>Result</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> MTAMTAMTAMTA </span></pre>

				<div>
					 
				</div>
			</div>
		</div>
	</li>
</ul><p>
	<img alt="Sans_titre_4.png" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="http://s5.postimg.org/rt12qb9af/Sans_titre_4.png"></p>

<p>
	A character class is used to represent a set of characters. examples shown below.
</p>

<div class="ipsSpoiler" data-ipsspoiler="">
	<div class="ipsSpoiler_header">
		 
	</div>

	<div class="ipsSpoiler_contents">
		<p>
			 
		</p>

		<div style="background-color:#008000;border:1px solid #000000;margin:10px 10px;padding-left:5px;padding-right:5px;">
			<span style="color:#FFFFFF;">. &gt; Represents all characters.</span>

			<p>
				<span style="color:#FFFFFF;">%a &gt; Represents all letters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%c &gt; Represents all control characters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%d &gt; Represents all digits.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%l &gt; Represents all lowercase letters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%p &gt; Represents all punctuation characters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%s &gt; Represents all space characters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%u &gt; Represents all uppercase letters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%w &gt; Represents all alphanumeric characters.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%x &gt; Represents all hexadecimal digits.</span>
			</p>

			<p>
				<span style="color:#FFFFFF;">%z &gt; Represents the character with representation 0.</span>
			</p>
		</div>

		<p>
			 
		</p>
	</div>
</div>

<div style="text-align:center;">
	<p>
		<em><span style="text-decoration:underline;">If you have any questions, please feel free to ask.</span></em>
	</p>
</div>
]]></description><guid isPermaLink="false">75680</guid><pubDate>Fri, 29 May 2015 23:20:45 +0000</pubDate></item><item><title>Learn Lua, HTML, PHP and other languages for free!</title><link>https://forum.multitheftauto.com/topic/106132-learn-lua-html-php-and-other-languages-for-free/</link><description><![CDATA[<p style="text-align:center;">
	<img alt="oKxg02t.png" class="ipsImage" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.imgur.com/oKxg02t.png"></p>

<p>
	<strong>TPF</strong> is bringing opportunities for those players who don't know scripting but wants to learn. We ( TPF staff ) offers free courses in various languages, as well as designing, for totally free.
</p>

<p>
	<strong>Languages we can teach you? </strong>We can teach you Lua, HTML, CSS ,PHP and MYSQL
</p>

<p>
	<strong>What can we teach you in designing ? </strong>Creating logos, creating banners ,posters , web design and MORE !!!(Using Photoshop cs6)
</p>

<p>
	<strong>Our contact: </strong>Contact DiGiTal#2028 or join our discord server :  <a href="https://discord.gg/BxkW65z" rel="external nofollow">https://discord.gg/BxkW65z</a>
</p>

<p>
	<strong>For more information and tutorials visit our website : </strong><a href="https://tutoplayfun.ml/" rel="external nofollow">https://tutoplayfun.ml/</a>
</p>

<p>
	 
</p>
]]></description><guid isPermaLink="false">106132</guid><pubDate>Thu, 05 Jul 2018 13:18:56 +0000</pubDate></item><item><title>[Release] Countdown function</title><link>https://forum.multitheftauto.com/topic/123567-release-countdown-function/</link><description><![CDATA[<p>
	I have created countdown functions based on this thread: 
</p>
<iframe allowfullscreen="" data-embedauthorid="18837" data-embedcontent="" data-embedid="embed3285795874" scrolling="no" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:185px;max-width:502px;" data-embed-src="https://forum.multitheftauto.com/topic/40684-hours-minutes-seconds/?do=embed"></iframe>

<p>
	and also this thread:
</p>
<iframe allowfullscreen="" data-embedauthorid="41801" data-embedcontent="" data-embedid="embed2665169056" scrolling="no" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" style="height:185px;max-width:502px;" data-embed-src="https://forum.multitheftauto.com/topic/61695-countdown-timer?do=embed"></iframe>

<p>
	my countdown function are useful and you can use it evreywhere
</p>

<p>
	Example 1:
</p>

<p>
	Here i make 'nil' values
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%02s : %02s : %02s"</span><span class="pun">)</span></pre>

<p>
	to create a dx draw text like this:
</p>

<p>
	<img alt="1q.png" class="ipsImage" data-ratio="33.98" height="35" width="103" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.ibb.co/BLHVMv5/1q.png">
</p>

<p>
	the first argument is to till hours, second is minutes, third is seconds, fourth is to create format
</p>

<p>
	and if you set some arguments to 'nil' it will be zeros
</p>

<p>
	Standard:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="pln">hh</span><span class="pun">,</span><span class="pln"> mm</span><span class="pun">,</span><span class="pln"> ss</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">)</span></pre>

<p>
	Lets see more examples:
</p>

<p>
	Example 2:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="lit">24</span><span class="pun">,</span><span class="pln"> </span><span class="lit">50</span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%02s : %02s : %02s"</span><span class="pun">)</span></pre>

<p>
	<img alt="2q.png" class="ipsImage" data-ratio="39.42" height="41" width="104" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.ibb.co/c6kBtgV/2q.png">
</p>

<p>
	Example 3:
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="lit">24</span><span class="pun">,</span><span class="pln"> </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%02s : %02s : %02s"</span><span class="pun">)</span></pre>

<p>
	<img alt="3q.png" class="ipsImage" data-ratio="40.37" height="44" width="109" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.ibb.co/sw9CvWB/3q.png">
</p>

<p>
	Example 4:
</p>

<p>
	Here i have changed to format to [hh : mm]
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="lit">24</span><span class="pun">,</span><span class="pln"> </span><span class="kwd"><span><a href="https://wiki.multitheftauto.com/wiki/nil" rel="external nofollow">nil</a></span></span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%02s : %02s"</span><span class="pun">)</span></pre>

<p>
	<img alt="4q.png" class="ipsImage" data-ratio="47.71" height="52" width="109" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.ibb.co/MBYG1RJ/4q.png">
</p>

<p>
	Example 5:
</p>

<p>
	Here i hve changed the format digits to [1] per item
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="pln">displayCountDown</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">9</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%01s : %01s : %01s"</span><span class="pun">)</span></pre>

<p>
	<img alt="5q.png" class="ipsImage" data-ratio="52.44" height="43" width="82" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" data-src="https://i.ibb.co/RHNL9Td/5q.png">
</p>

<p>
	 
</p>

<p>
	And this is the function code, you can export it or put it in your own code
</p>

<pre class="ipsCode prettyprint lang-lua prettyprinted">
<span class="kwd">function</span><span class="pln"> displayCountDown</span><span class="pun">(</span><span class="pln">hh</span><span class="pun">,</span><span class="pln"> mm</span><span class="pun">,</span><span class="pln"> ss</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> convertSecondsToMinutes</span><span class="pun">(</span><span class="pln">ms</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> hours </span><span class="pun">=</span><span class="pln"> math</span><span class="pun">.</span><span class="pln">floor </span><span class="pun">(</span><span class="pln">ms</span><span class="pun">/</span><span class="lit">3600000</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- convert ms to hours</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> mins </span><span class="pun">=</span><span class="pln"> math</span><span class="pun">.</span><span class="pln">floor </span><span class="pun">(</span><span class="pln">ms</span><span class="pun">/</span><span class="lit">60000</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- convert ms to mins</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> secs </span><span class="pun">=</span><span class="pln"> math</span><span class="pun">.</span><span class="pln">floor </span><span class="pun">((</span><span class="pln">ms</span><span class="pun">/</span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">60</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- convert ms to secs</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> string</span><span class="pun">.</span><span class="pln">format </span><span class="pun">(</span><span class="pln"> format</span><span class="pun">,</span><span class="pln"> hours</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> mins </span><span class="pun">-</span><span class="pln"> hours </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="pun">),</span><span class="pln"> secs </span><span class="pun">)</span><span class="pln">  </span><span class="com">-- print hh:mm:ss format</span><span class="pln">
        </span><span class="com">-- "%02s : %02s : %02s" is the default format</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln"> 
    </span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> countdownFin</span><span class="pun">()</span><span class="pln"> 
        </span><span class="com">-- to do after countdown finished</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln"> 
    direction </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hh </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hh </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">23</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">((</span><span class="pln">hh </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            hh </span><span class="pun">=</span><span class="pln"> hh </span><span class="pun">*</span><span class="pln"> </span><span class="lit">3600000</span><span class="pln">
            direction </span><span class="pun">=</span><span class="pln"> direction </span><span class="pun">+</span><span class="pln"> hh
        </span><span class="kwd">else</span><span class="pln">
            outputChatBox</span><span class="pun">(</span><span class="str">"[ERROR] Hours must be between 0 and 24"</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
            direction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">direction </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mm </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mm </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">59</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">((</span><span class="pln">mm </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                mm </span><span class="pun">=</span><span class="pln"> mm </span><span class="pun">*</span><span class="pln"> </span><span class="lit">60000</span><span class="pln">
                direction </span><span class="pun">=</span><span class="pln"> direction </span><span class="pun">+</span><span class="pln"> mm
            </span><span class="kwd">else</span><span class="pln">
                outputChatBox</span><span class="pun">(</span><span class="str">"[ERROR] Minutes must be between 0 and 60"</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
                direction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">direction </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ss </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ss </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">60</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">((</span><span class="pln">ss </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
                ss </span><span class="pun">=</span><span class="pln"> ss </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1000</span><span class="pln">
                direction </span><span class="pun">=</span><span class="pln"> direction </span><span class="pun">+</span><span class="pln"> ss
            </span><span class="kwd">else</span><span class="pln">
                outputChatBox</span><span class="pun">(</span><span class="str">"[ERROR] Seconds must be between 0 and 60"</span><span class="pun">,</span><span class="lit">255</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
                direction </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">direction </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        countDownTimes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">direction </span><span class="pun">/</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- Convert direction into seconds to prevent debug warnings by setTimer function</span><span class="pln">
        countdown </span><span class="pun">=</span><span class="pln"> setTimer</span><span class="pun">(</span><span class="pln">countdownFin</span><span class="pun">,</span><span class="pln"> direction</span><span class="lit">+1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> drawText</span><span class="pun">(</span><span class="pln">text</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">local</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> drawTextZG</span><span class="pun">()</span><span class="pln">
            dxDrawText</span><span class="pun">(</span><span class="pln">text</span><span class="pun">,</span><span class="pln"> </span><span class="lit">500</span><span class="pun">,</span><span class="pln"> </span><span class="lit">500</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- dx draw on screen</span><span class="pln">
        </span><span class="kwd">end</span><span class="pln">
        addEventHandler </span><span class="pun">(</span><span class="pln"> </span><span class="str">"onClientPreRender"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> drawTextZG</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- draw evrey screen render</span><span class="pln">
        setTimer</span><span class="pun">(</span><span class="pln">
            </span><span class="kwd">function</span><span class="pun">()</span><span class="pln">
                removeEventHandler </span><span class="pun">(</span><span class="pln"> </span><span class="str">"onClientPreRender"</span><span class="pun">,</span><span class="pln"> root</span><span class="pun">,</span><span class="pln"> drawTextZG</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- remove text after each second</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="com">-- do this function evrey second once</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">direction </span><span class="pun">~=</span><span class="pln"> </span><span class="kwd">nil</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
        setTimer</span><span class="pun">(</span><span class="pln"> 
            </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> 
                drawText</span><span class="pun">(</span><span class="pln">convertSecondsToMinutes</span><span class="pun">(</span><span class="pln">getTimerDetails</span><span class="pun">(</span><span class="pln">countdown</span><span class="pun">)))</span><span class="pln"> </span><span class="com">-- sends hh:mm:ss foramt to dx draw function</span><span class="pln">
            </span><span class="kwd">end</span><span class="pln">
        </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">,</span><span class="pln"> countDownTimes</span><span class="lit">-1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
displayCountDown</span><span class="pun">(</span><span class="lit">23</span><span class="pun">,</span><span class="pln"> </span><span class="lit">59</span><span class="pun">,</span><span class="pln"> </span><span class="lit">60</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%02s : %02s : %02s"</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	You can be creative with it
</p>

<p>
	you can use very diffrent formats like hh : mm : ss, hh, hh:mm, anything
</p>

<p>
	you can make it countdown any number you want
</p>

<p>
	you can upgrade it to be getting value from gui window
</p>

<p>
	you can change the draw text color, font,... to match your needs
</p>

<p>
	 
</p>

<p>
	i hope this function helpful for evreyone
</p>

<p>
	i  want to see your works done with this function <img alt="^_^" data-emoticon="" height="20" src="https://forum.multitheftauto.com/applications/core/interface/js/spacer.png" srcset="https://forum.multitheftauto.com/uploads/emoticons/happy@2x.png 2x" title="^_^" width="20" data-src="https://forum.multitheftauto.com/uploads/emoticons/happy.png">
</p>

<p>
	 
</p>

<p>
	Thank you for your time reading my thread.
</p>

<p>
	 
</p>
]]></description><guid isPermaLink="false">123567</guid><pubDate>Thu, 09 Apr 2020 12:09:30 +0000</pubDate></item></channel></rss>
